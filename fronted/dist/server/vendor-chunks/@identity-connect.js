"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@identity-connect";
exports.ids = ["vendor-chunks/@identity-connect"];
exports.modules = {

/***/ "(ssr)/./node_modules/@identity-connect/api/dist/index.mjs":
/*!***********************************************************!*\
  !*** ./node_modules/@identity-connect/api/dist/index.mjs ***!
  \***********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_BACKEND_URL: () => (/* binding */ DEFAULT_BACKEND_URL),\n/* harmony export */   NetworkName: () => (/* binding */ NetworkName),\n/* harmony export */   PairingStatus: () => (/* binding */ PairingStatus),\n/* harmony export */   SigningRequestStatus: () => (/* binding */ SigningRequestStatus),\n/* harmony export */   SigningRequestTypes: () => (/* binding */ SigningRequestTypes),\n/* harmony export */   WalletOSEnum: () => (/* binding */ WalletOSEnum),\n/* harmony export */   WalletPlatformEnum: () => (/* binding */ WalletPlatformEnum)\n/* harmony export */ });\n// src/constants.ts\nvar DEFAULT_BACKEND_URL = \"https://identityconnect.com\";\n\n// src/network.ts\nvar NetworkName = /* @__PURE__ */ ((NetworkName2) => {\n  NetworkName2[\"DEVNET\"] = \"devnet\";\n  NetworkName2[\"MAINNET\"] = \"mainnet\";\n  NetworkName2[\"TESTNET\"] = \"testnet\";\n  return NetworkName2;\n})(NetworkName || {});\n\n// src/types/pairing.ts\nvar PairingStatus = /* @__PURE__ */ ((PairingStatus2) => {\n  PairingStatus2[\"Finalized\"] = \"FINALIZED\";\n  PairingStatus2[\"Pending\"] = \"PENDING\";\n  return PairingStatus2;\n})(PairingStatus || {});\n\n// src/types/signingRequest.ts\nvar SigningRequestTypes = /* @__PURE__ */ ((SigningRequestTypes2) => {\n  SigningRequestTypes2[\"SIGN_AND_SUBMIT_TRANSACTION\"] = \"SIGN_AND_SUBMIT_TRANSACTION\";\n  SigningRequestTypes2[\"SIGN_MESSAGE\"] = \"SIGN_MESSAGE\";\n  SigningRequestTypes2[\"SIGN_TRANSACTION\"] = \"SIGN_TRANSACTION\";\n  return SigningRequestTypes2;\n})(SigningRequestTypes || {});\nvar SigningRequestStatus = /* @__PURE__ */ ((SigningRequestStatus2) => {\n  SigningRequestStatus2[\"APPROVED\"] = \"APPROVED\";\n  SigningRequestStatus2[\"CANCELLED\"] = \"CANCELLED\";\n  SigningRequestStatus2[\"INVALID\"] = \"INVALID\";\n  SigningRequestStatus2[\"PENDING\"] = \"PENDING\";\n  SigningRequestStatus2[\"REJECTED\"] = \"REJECTED\";\n  return SigningRequestStatus2;\n})(SigningRequestStatus || {});\n\n// src/types/wallet.ts\nvar WalletOSEnum = /* @__PURE__ */ ((WalletOSEnum2) => {\n  WalletOSEnum2[\"Android\"] = \"android\";\n  WalletOSEnum2[\"IdentityConnect\"] = \"ic\";\n  WalletOSEnum2[\"Linux\"] = \"linux\";\n  WalletOSEnum2[\"Macos\"] = \"osx\";\n  WalletOSEnum2[\"Windows\"] = \"win\";\n  WalletOSEnum2[\"iOS\"] = \"ios\";\n  return WalletOSEnum2;\n})(WalletOSEnum || {});\nvar WalletPlatformEnum = /* @__PURE__ */ ((WalletPlatformEnum2) => {\n  WalletPlatformEnum2[\"BraveExtension\"] = \"brave-extension\";\n  WalletPlatformEnum2[\"ChromeExtension\"] = \"chrome-extension\";\n  WalletPlatformEnum2[\"FirefoxExtension\"] = \"firefox-extension\";\n  WalletPlatformEnum2[\"IcDappWallet\"] = \"ic-dapp-wallet\";\n  WalletPlatformEnum2[\"KiwiExtension\"] = \"kiwi-extension\";\n  WalletPlatformEnum2[\"NativeApp\"] = \"native-app\";\n  WalletPlatformEnum2[\"OperaExtension\"] = \"opera-extension\";\n  WalletPlatformEnum2[\"SafariExtension\"] = \"safari-extension\";\n  return WalletPlatformEnum2;\n})(WalletPlatformEnum || {});\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvYXBpL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsbUJBQW1COztBQUVwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxxQkFBcUI7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMkJBQTJCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0QkFBNEI7O0FBRTdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsb0JBQW9CO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywwQkFBMEI7QUFTekI7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaHJhdlxcYWkuYXB0LW1ldGFtb3ZlLWhhY2thdGhvblxcZnJvbnRlZFxcbm9kZV9tb2R1bGVzXFxAaWRlbnRpdHktY29ubmVjdFxcYXBpXFxkaXN0XFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2NvbnN0YW50cy50c1xudmFyIERFRkFVTFRfQkFDS0VORF9VUkwgPSBcImh0dHBzOi8vaWRlbnRpdHljb25uZWN0LmNvbVwiO1xuXG4vLyBzcmMvbmV0d29yay50c1xudmFyIE5ldHdvcmtOYW1lID0gLyogQF9fUFVSRV9fICovICgoTmV0d29ya05hbWUyKSA9PiB7XG4gIE5ldHdvcmtOYW1lMltcIkRFVk5FVFwiXSA9IFwiZGV2bmV0XCI7XG4gIE5ldHdvcmtOYW1lMltcIk1BSU5ORVRcIl0gPSBcIm1haW5uZXRcIjtcbiAgTmV0d29ya05hbWUyW1wiVEVTVE5FVFwiXSA9IFwidGVzdG5ldFwiO1xuICByZXR1cm4gTmV0d29ya05hbWUyO1xufSkoTmV0d29ya05hbWUgfHwge30pO1xuXG4vLyBzcmMvdHlwZXMvcGFpcmluZy50c1xudmFyIFBhaXJpbmdTdGF0dXMgPSAvKiBAX19QVVJFX18gKi8gKChQYWlyaW5nU3RhdHVzMikgPT4ge1xuICBQYWlyaW5nU3RhdHVzMltcIkZpbmFsaXplZFwiXSA9IFwiRklOQUxJWkVEXCI7XG4gIFBhaXJpbmdTdGF0dXMyW1wiUGVuZGluZ1wiXSA9IFwiUEVORElOR1wiO1xuICByZXR1cm4gUGFpcmluZ1N0YXR1czI7XG59KShQYWlyaW5nU3RhdHVzIHx8IHt9KTtcblxuLy8gc3JjL3R5cGVzL3NpZ25pbmdSZXF1ZXN0LnRzXG52YXIgU2lnbmluZ1JlcXVlc3RUeXBlcyA9IC8qIEBfX1BVUkVfXyAqLyAoKFNpZ25pbmdSZXF1ZXN0VHlwZXMyKSA9PiB7XG4gIFNpZ25pbmdSZXF1ZXN0VHlwZXMyW1wiU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OXCJdID0gXCJTSUdOX0FORF9TVUJNSVRfVFJBTlNBQ1RJT05cIjtcbiAgU2lnbmluZ1JlcXVlc3RUeXBlczJbXCJTSUdOX01FU1NBR0VcIl0gPSBcIlNJR05fTUVTU0FHRVwiO1xuICBTaWduaW5nUmVxdWVzdFR5cGVzMltcIlNJR05fVFJBTlNBQ1RJT05cIl0gPSBcIlNJR05fVFJBTlNBQ1RJT05cIjtcbiAgcmV0dXJuIFNpZ25pbmdSZXF1ZXN0VHlwZXMyO1xufSkoU2lnbmluZ1JlcXVlc3RUeXBlcyB8fCB7fSk7XG52YXIgU2lnbmluZ1JlcXVlc3RTdGF0dXMgPSAvKiBAX19QVVJFX18gKi8gKChTaWduaW5nUmVxdWVzdFN0YXR1czIpID0+IHtcbiAgU2lnbmluZ1JlcXVlc3RTdGF0dXMyW1wiQVBQUk9WRURcIl0gPSBcIkFQUFJPVkVEXCI7XG4gIFNpZ25pbmdSZXF1ZXN0U3RhdHVzMltcIkNBTkNFTExFRFwiXSA9IFwiQ0FOQ0VMTEVEXCI7XG4gIFNpZ25pbmdSZXF1ZXN0U3RhdHVzMltcIklOVkFMSURcIl0gPSBcIklOVkFMSURcIjtcbiAgU2lnbmluZ1JlcXVlc3RTdGF0dXMyW1wiUEVORElOR1wiXSA9IFwiUEVORElOR1wiO1xuICBTaWduaW5nUmVxdWVzdFN0YXR1czJbXCJSRUpFQ1RFRFwiXSA9IFwiUkVKRUNURURcIjtcbiAgcmV0dXJuIFNpZ25pbmdSZXF1ZXN0U3RhdHVzMjtcbn0pKFNpZ25pbmdSZXF1ZXN0U3RhdHVzIHx8IHt9KTtcblxuLy8gc3JjL3R5cGVzL3dhbGxldC50c1xudmFyIFdhbGxldE9TRW51bSA9IC8qIEBfX1BVUkVfXyAqLyAoKFdhbGxldE9TRW51bTIpID0+IHtcbiAgV2FsbGV0T1NFbnVtMltcIkFuZHJvaWRcIl0gPSBcImFuZHJvaWRcIjtcbiAgV2FsbGV0T1NFbnVtMltcIklkZW50aXR5Q29ubmVjdFwiXSA9IFwiaWNcIjtcbiAgV2FsbGV0T1NFbnVtMltcIkxpbnV4XCJdID0gXCJsaW51eFwiO1xuICBXYWxsZXRPU0VudW0yW1wiTWFjb3NcIl0gPSBcIm9zeFwiO1xuICBXYWxsZXRPU0VudW0yW1wiV2luZG93c1wiXSA9IFwid2luXCI7XG4gIFdhbGxldE9TRW51bTJbXCJpT1NcIl0gPSBcImlvc1wiO1xuICByZXR1cm4gV2FsbGV0T1NFbnVtMjtcbn0pKFdhbGxldE9TRW51bSB8fCB7fSk7XG52YXIgV2FsbGV0UGxhdGZvcm1FbnVtID0gLyogQF9fUFVSRV9fICovICgoV2FsbGV0UGxhdGZvcm1FbnVtMikgPT4ge1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiQnJhdmVFeHRlbnNpb25cIl0gPSBcImJyYXZlLWV4dGVuc2lvblwiO1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiQ2hyb21lRXh0ZW5zaW9uXCJdID0gXCJjaHJvbWUtZXh0ZW5zaW9uXCI7XG4gIFdhbGxldFBsYXRmb3JtRW51bTJbXCJGaXJlZm94RXh0ZW5zaW9uXCJdID0gXCJmaXJlZm94LWV4dGVuc2lvblwiO1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiSWNEYXBwV2FsbGV0XCJdID0gXCJpYy1kYXBwLXdhbGxldFwiO1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiS2l3aUV4dGVuc2lvblwiXSA9IFwia2l3aS1leHRlbnNpb25cIjtcbiAgV2FsbGV0UGxhdGZvcm1FbnVtMltcIk5hdGl2ZUFwcFwiXSA9IFwibmF0aXZlLWFwcFwiO1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiT3BlcmFFeHRlbnNpb25cIl0gPSBcIm9wZXJhLWV4dGVuc2lvblwiO1xuICBXYWxsZXRQbGF0Zm9ybUVudW0yW1wiU2FmYXJpRXh0ZW5zaW9uXCJdID0gXCJzYWZhcmktZXh0ZW5zaW9uXCI7XG4gIHJldHVybiBXYWxsZXRQbGF0Zm9ybUVudW0yO1xufSkoV2FsbGV0UGxhdGZvcm1FbnVtIHx8IHt9KTtcbmV4cG9ydCB7XG4gIERFRkFVTFRfQkFDS0VORF9VUkwsXG4gIE5ldHdvcmtOYW1lLFxuICBQYWlyaW5nU3RhdHVzLFxuICBTaWduaW5nUmVxdWVzdFN0YXR1cyxcbiAgU2lnbmluZ1JlcXVlc3RUeXBlcyxcbiAgV2FsbGV0T1NFbnVtLFxuICBXYWxsZXRQbGF0Zm9ybUVudW1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/api/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@identity-connect/crypto/dist/index.mjs":
/*!**************************************************************!*\
  !*** ./node_modules/@identity-connect/crypto/dist/index.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccountConnectionAction: () => (/* binding */ AccountConnectionAction),\n/* harmony export */   DecryptionError: () => (/* binding */ DecryptionError),\n/* harmony export */   EncryptionEnvelopeError: () => (/* binding */ EncryptionEnvelopeError),\n/* harmony export */   EnvelopeMessageMismatchError: () => (/* binding */ EnvelopeMessageMismatchError),\n/* harmony export */   KeyTypes: () => (/* binding */ KeyTypes),\n/* harmony export */   REQUIRED_FIELDS: () => (/* binding */ REQUIRED_FIELDS),\n/* harmony export */   SIGNATURE_PREFIX: () => (/* binding */ SIGNATURE_PREFIX),\n/* harmony export */   aptosAccountToEd25519Keypair: () => (/* binding */ aptosAccountToEd25519Keypair),\n/* harmony export */   aptosAccountToSerializedInfo: () => (/* binding */ aptosAccountToSerializedInfo),\n/* harmony export */   concatUint8array: () => (/* binding */ concatUint8array),\n/* harmony export */   constructMetadata: () => (/* binding */ constructMetadata),\n/* harmony export */   convertEd25519PublicKeyToX25519PublicKey: () => (/* binding */ convertEd25519PublicKeyToX25519PublicKey),\n/* harmony export */   convertEd25519SecretKeyToX25519SecretKey: () => (/* binding */ convertEd25519SecretKeyToX25519SecretKey),\n/* harmony export */   createEd25519KeyPair: () => (/* binding */ createEd25519KeyPair),\n/* harmony export */   createSerializedAccountInfo: () => (/* binding */ createSerializedAccountInfo),\n/* harmony export */   createX25519KeyPair: () => (/* binding */ createX25519KeyPair),\n/* harmony export */   dangerouslyEncryptAndSignEnvelopeUnvalidated: () => (/* binding */ dangerouslyEncryptAndSignEnvelopeUnvalidated),\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   decryptEnvelope: () => (/* binding */ decryptEnvelope),\n/* harmony export */   decryptMessage: () => (/* binding */ decryptMessage),\n/* harmony export */   decryptMessageDirect: () => (/* binding */ decryptMessageDirect),\n/* harmony export */   decryptObject: () => (/* binding */ decryptObject),\n/* harmony export */   decryptObjectDirect: () => (/* binding */ decryptObjectDirect),\n/* harmony export */   decryptSerializedEncryptionResult: () => (/* binding */ decryptSerializedEncryptionResult),\n/* harmony export */   decryptSerializedEncryptionResultDirect: () => (/* binding */ decryptSerializedEncryptionResultDirect),\n/* harmony export */   deriveAccountTransportEd25519Keypair: () => (/* binding */ deriveAccountTransportEd25519Keypair),\n/* harmony export */   deserializeEd25519PublicKeyB64: () => (/* binding */ deserializeEd25519PublicKeyB64),\n/* harmony export */   deserializeEd25519SignatureB64: () => (/* binding */ deserializeEd25519SignatureB64),\n/* harmony export */   deserializeEncryptionResult: () => (/* binding */ deserializeEncryptionResult),\n/* harmony export */   deserializePublicKeyB64: () => (/* binding */ deserializePublicKeyB64),\n/* harmony export */   deserializeSignatureB64: () => (/* binding */ deserializeSignatureB64),\n/* harmony export */   deserializeTransportEnvelope: () => (/* binding */ deserializeTransportEnvelope),\n/* harmony export */   ed25519KeypairFromSecret: () => (/* binding */ ed25519KeypairFromSecret),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64),\n/* harmony export */   encryptAndSignEnvelope: () => (/* binding */ encryptAndSignEnvelope),\n/* harmony export */   encryptMessage: () => (/* binding */ encryptMessage),\n/* harmony export */   encryptMessageDirect: () => (/* binding */ encryptMessageDirect),\n/* harmony export */   encryptObject: () => (/* binding */ encryptObject),\n/* harmony export */   encryptObjectDirect: () => (/* binding */ encryptObjectDirect),\n/* harmony export */   ensureMetadataFields: () => (/* binding */ ensureMetadataFields),\n/* harmony export */   ensurePrivatePublicFieldsDisjoint: () => (/* binding */ ensurePrivatePublicFieldsDisjoint),\n/* harmony export */   hashAndVerifySignature: () => (/* binding */ hashAndVerifySignature),\n/* harmony export */   keypairToEd25519: () => (/* binding */ keypairToEd25519),\n/* harmony export */   keypairToX25519: () => (/* binding */ keypairToX25519),\n/* harmony export */   makeEd25519SecretKeySignCallbackNoDomainSeparation: () => (/* binding */ makeEd25519SecretKeySignCallbackNoDomainSeparation),\n/* harmony export */   messageHash: () => (/* binding */ messageHash),\n/* harmony export */   publicKeyB64FromEd25519PublicKeyB64: () => (/* binding */ publicKeyB64FromEd25519PublicKeyB64),\n/* harmony export */   serializeEncryptionResult: () => (/* binding */ serializeEncryptionResult),\n/* harmony export */   serializePublicKeyB64: () => (/* binding */ serializePublicKeyB64),\n/* harmony export */   serializeSignatureB64: () => (/* binding */ serializeSignatureB64),\n/* harmony export */   signWithEd25519SecretKey: () => (/* binding */ signWithEd25519SecretKey),\n/* harmony export */   toKey: () => (/* binding */ toKey),\n/* harmony export */   verifyEnvelopeSignature: () => (/* binding */ verifyEnvelopeSignature),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @noble/hashes/sha3 */ \"(ssr)/./node_modules/@noble/hashes/esm/sha3.js\");\n/* harmony import */ var tweetnacl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tweetnacl */ \"(ssr)/./node_modules/tweetnacl/nacl-fast.js\");\n/* harmony import */ var ed2curve__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ed2curve */ \"(ssr)/./node_modules/ed2curve/ed2curve.js\");\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n// src/encrDecr.ts\n\n\n\n\n\n// src/errors.ts\nvar EncryptionEnvelopeError = class extends Error {\n};\nvar EnvelopeMessageMismatchError = class _EnvelopeMessageMismatchError extends EncryptionEnvelopeError {\n  constructor(message, field) {\n    super(message);\n    this.field = field;\n    this.name = \"EnvelopeMessageMismatchError\";\n    Object.setPrototypeOf(this, _EnvelopeMessageMismatchError.prototype);\n  }\n};\nvar DecryptionError = class _DecryptionError extends EncryptionEnvelopeError {\n  constructor(message) {\n    super(message);\n    this.name = \"DecryptionError\";\n    Object.setPrototypeOf(this, _DecryptionError.prototype);\n  }\n};\n\n// src/utils.ts\n\nvar KeyTypes = /* @__PURE__ */ ((KeyTypes2) => {\n  KeyTypes2[\"Ed25519PublicKey\"] = \"Ed25519PublicKey\";\n  KeyTypes2[\"Ed25519SecretKey\"] = \"Ed25519SecretKey\";\n  KeyTypes2[\"X25519PublicKey\"] = \"X25519PublicKey\";\n  KeyTypes2[\"X25519SecretKey\"] = \"X25519SecretKey\";\n  return KeyTypes2;\n})(KeyTypes || {});\nfunction createX25519KeyPair() {\n  return keypairToX25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.keyPair());\n}\nfunction createEd25519KeyPair() {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair());\n}\nfunction toKey(rawKey, type) {\n  return {\n    key: rawKey,\n    type\n  };\n}\nfunction keypairToEd25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"Ed25519PublicKey\" /* Ed25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"Ed25519SecretKey\" /* Ed25519SecretKey */)\n  };\n}\nfunction keypairToX25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"X25519PublicKey\" /* X25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"X25519SecretKey\" /* X25519SecretKey */)\n  };\n}\nfunction aptosAccountToEd25519Keypair(account) {\n  return ed25519KeypairFromSecret(account.signingKey.secretKey);\n}\nfunction ed25519KeypairFromSecret(ed25519SecretKeyBytes) {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair.fromSeed(ed25519SecretKeyBytes.slice(0, 32)));\n}\nfunction decodeBase64(base64Str) {\n  if (globalThis.Buffer) {\n    return new Uint8Array(Buffer.from(base64Str, \"base64\"));\n  }\n  return Uint8Array.from(atob(base64Str), (m) => m.codePointAt(0));\n}\nfunction encodeBase64(bytes) {\n  if (globalThis.Buffer) {\n    return Buffer.from(bytes).toString(\"base64\");\n  }\n  return btoa(Array.from(bytes, (x) => String.fromCodePoint(x)).join(\"\"));\n}\nfunction concatUint8array(arrayOne, arrayTwo) {\n  const mergedArray = new Uint8Array(arrayOne.length + arrayTwo.length);\n  mergedArray.set(arrayOne);\n  mergedArray.set(arrayTwo, arrayOne.length);\n  return mergedArray;\n}\n\n// src/encrDecr.ts\nvar SIGNATURE_PREFIX = \"APTOS::IDENTITY_CONNECT\";\nfunction convertEd25519PublicKeyToX25519PublicKey(ed25519PublicKey, errorKeyName) {\n  const x25519PublicKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertPublicKey(ed25519PublicKey.key.slice(0, 32));\n  if (!x25519PublicKey)\n    throw new Error(`${errorKeyName} is not a valid Ed25519 public key`);\n  return toKey(x25519PublicKey, \"X25519PublicKey\" /* X25519PublicKey */);\n}\nfunction convertEd25519SecretKeyToX25519SecretKey(ed25519SecretKey) {\n  const x25519SecretKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertSecretKey(ed25519SecretKey.key.slice(0, 32));\n  return toKey(x25519SecretKey, \"X25519SecretKey\" /* X25519SecretKey */);\n}\nfunction serializeEncryptionResult(enc) {\n  return {\n    nonceB64: encodeBase64(enc.nonce),\n    securedB64: encodeBase64(enc.secured)\n  };\n}\nfunction deserializeEncryptionResult(enc) {\n  return {\n    nonce: decodeBase64(enc.nonceB64),\n    secured: decodeBase64(enc.securedB64)\n  };\n}\nfunction decryptSerializedEncryptionResult(senderX25519PublicKey, receiverEd25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, des.secured, des.nonce);\n}\nfunction decryptSerializedEncryptionResultDirect(senderX25519PublicKey, receiverX25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, des.secured, des.nonce);\n}\nfunction encryptMessage(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  const nonce = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.randomBytes(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.nonceLength);\n  const messageUint8 = new TextEncoder().encode(message);\n  const secured = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box(messageUint8, nonce, receiverX25519PublicKey.key, senderX25519SecretKey.key.slice(0, 32));\n  return { nonce, secured };\n}\nfunction encryptObject(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, JSON.stringify(message));\n}\nfunction decryptMessage(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  let decryptedUint8;\n  try {\n    decryptedUint8 = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.open(\n      securedMessage,\n      nonce,\n      senderX25519PublicKey.key.slice(0, 32),\n      receiverX25519SecretKey.key.slice(0, 32)\n    );\n  } catch (e) {\n    throw new DecryptionError(`Could not decrypt message: ${e.message}`);\n  }\n  if (!decryptedUint8)\n    throw new DecryptionError(\"Could not decrypt message\");\n  return new TextDecoder().decode(decryptedUint8);\n}\nfunction decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  const decryptedStr = decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n  return JSON.parse(decryptedStr);\n}\nfunction messageHash(message, purpose) {\n  const signaturePrefixHash = new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(`${SIGNATURE_PREFIX}::${purpose}::`));\n  return new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(concatUint8array(signaturePrefixHash, message)));\n}\nfunction signWithEd25519SecretKey(message, signingEd25519SecretKey, purpose) {\n  return tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(messageHash(message, purpose), signingEd25519SecretKey.key);\n}\nfunction makeEd25519SecretKeySignCallbackNoDomainSeparation(signingEd25519SecretKey) {\n  return async (message) => new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(message, signingEd25519SecretKey.key));\n}\nfunction verifySignature(message, signature, signingPublicKey, purpose) {\n  return signingPublicKey.verifySignature({ message: messageHash(message, purpose), signature });\n}\nfunction hashAndVerifySignature(message, signature, signingPublicKey, purpose) {\n  const messageUint8 = message instanceof Uint8Array ? message : new TextEncoder().encode(message);\n  const messageUint8Hash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(messageUint8);\n  return verifySignature(messageUint8Hash, signature, signingPublicKey, purpose);\n}\n\n// src/securedEnvelope.ts\n\n\nvar REQUIRED_FIELDS = [\n  \"receiverEd25519PublicKeyB64\",\n  \"senderEd25519PublicKeyB64\",\n  \"senderX25519PublicKeyB64\",\n  \"sequence\",\n  \"timestampMillis\"\n].sort();\nfunction ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage) {\n  const intersection = Object.keys(privateMessage).filter((x) => Object.keys(publicMessage).includes(x));\n  if (intersection.length > 0) {\n    const field = intersection[0];\n    throw new EnvelopeMessageMismatchError(`Field ${field} appears in both private and public message fields`, field);\n  }\n}\nfunction ensureMetadataFields(message) {\n  const messageKeys = Object.keys(message).sort();\n  const extraFields = messageKeys.filter((key) => !REQUIRED_FIELDS.includes(key));\n  const missingFields = REQUIRED_FIELDS.filter((key) => !messageKeys.includes(key));\n  if (extraFields.length > 0 || missingFields.length > 0) {\n    let extraFieldsStr = extraFields.length > 0 ? `extra(${extraFields.join(\", \")})` : \"\";\n    const missingFieldsStr = missingFields.length > 0 ? `missing(${missingFields.join(\", \")})` : \"\";\n    extraFieldsStr = extraFieldsStr.length > 0 && missingFieldsStr.length > 0 ? `${extraFieldsStr}, ` : extraFieldsStr;\n    throw new EnvelopeMessageMismatchError(\n      `PublicMessage metadata fields do not conform to spec: ${extraFieldsStr}${missingFieldsStr}`,\n      \"_metadata\"\n    );\n  }\n}\nfunction deserializeTransportEnvelope(transportEnvelope) {\n  const publicMessage = JSON.parse(transportEnvelope.serializedPublicMessage);\n  return {\n    ...transportEnvelope,\n    publicMessage\n  };\n}\nfunction encryptAndSignEnvelope(senderEd25519SecretKey, senderEd25519PublicKey, receiverEd25519PublicKey, sequence, publicMessage, privateMessage) {\n  const senderEphemeralX25519KeyPair = createX25519KeyPair();\n  const metadata = constructMetadata(\n    senderEd25519PublicKey,\n    receiverEd25519PublicKey,\n    sequence,\n    senderEphemeralX25519KeyPair.publicKey\n  );\n  ensureMetadataFields(metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return dangerouslyEncryptAndSignEnvelopeUnvalidated(\n    senderEd25519SecretKey,\n    receiverEd25519PublicKey,\n    metadata,\n    privateMessage,\n    publicMessage,\n    senderEphemeralX25519KeyPair\n  );\n}\nfunction constructMetadata(senderEd25519PublicKey, receiverEd25519PublicKey, sequence, senderEphemeralX25519PublicKey) {\n  return {\n    receiverEd25519PublicKeyB64: encodeBase64(receiverEd25519PublicKey.key),\n    senderEd25519PublicKeyB64: encodeBase64(senderEd25519PublicKey.key),\n    senderX25519PublicKeyB64: encodeBase64(senderEphemeralX25519PublicKey.key),\n    sequence,\n    timestampMillis: Date.now()\n  };\n}\nfunction dangerouslyEncryptAndSignEnvelopeUnvalidated(senderEd25519SecretKey, receiverEd25519PublicKey, metadata, privateMessage, publicMessage, senderEphemeralX25519KeyPair) {\n  const encryptionResult = encryptObject(\n    senderEphemeralX25519KeyPair.secretKey,\n    receiverEd25519PublicKey,\n    privateMessage\n  );\n  const encryptedPrivateMessage = serializeEncryptionResult(encryptionResult);\n  const encryptedPrivateMessageBytes = decodeBase64(encryptedPrivateMessage.securedB64);\n  const serializedPublicMessage = JSON.stringify({ ...publicMessage, _metadata: metadata });\n  const publicMessageBytes = new TextEncoder().encode(serializedPublicMessage);\n  const messageSignature = signEnvelope(publicMessageBytes, encryptedPrivateMessageBytes, senderEd25519SecretKey);\n  return {\n    encryptedPrivateMessage,\n    messageSignature,\n    serializedPublicMessage\n  };\n}\nfunction combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes) {\n  const publicMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(publicMessageBytes);\n  const privateMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(privateMessageBytes);\n  const combinedHash = new Uint8Array(publicMessageBytesHash.length + privateMessageBytesHash.length);\n  combinedHash.set(publicMessageBytesHash);\n  combinedHash.set(privateMessageBytesHash, publicMessageBytesHash.length);\n  return (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(combinedHash);\n}\nfunction signEnvelope(publicMessageBytes, privateMessageBytes, senderEd25519SecretKey) {\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const signatureBytes = signWithEd25519SecretKey(messageHashBytes, senderEd25519SecretKey, \"SECURED_ENVELOPE\");\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(signatureBytes).toString();\n}\nfunction verifyEnvelopeSignature(publicMessageBytes, privateMessageBytes, messageSignatureInput, senderEd25519PublicKey) {\n  const messageSignature = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(messageSignatureInput).toUint8Array());\n  const senderPublicKey = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(senderEd25519PublicKey.key);\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const messageVerified = verifySignature(messageHashBytes, messageSignature, senderPublicKey, \"SECURED_ENVELOPE\");\n  if (!messageVerified) {\n    throw new EnvelopeMessageMismatchError(\"Could not verify SecuredEnvelope signature\", \"messageSignature\");\n  }\n}\nfunction decryptEnvelope(senderEd25519PublicKey, receiverEd25519SecretKey, message) {\n  const { encryptedPrivateMessage, messageSignature, serializedPublicMessage } = message;\n  const publicMessage = JSON.parse(serializedPublicMessage);\n  const rawPrivateMessage = decodeBase64(encryptedPrivateMessage.securedB64);\n  const rawPublicMessage = new TextEncoder().encode(serializedPublicMessage);\n  verifyEnvelopeSignature(rawPublicMessage, rawPrivateMessage, messageSignature, senderEd25519PublicKey);\n  const senderEd25519PublicKeyB64 = encodeBase64(senderEd25519PublicKey.key);\n  const expectedPublicKeyB64 = publicMessage._metadata.senderEd25519PublicKeyB64;\n  if (senderEd25519PublicKeyB64 !== expectedPublicKeyB64) {\n    throw new EnvelopeMessageMismatchError(\n      \"senderEd25519PublicKey in envelope does not match provided receiverEd25519SecretKey\",\n      \"senderPublicKey\"\n    );\n  }\n  const senderX25519PublicKeyBytes = decodeBase64(publicMessage._metadata.senderX25519PublicKeyB64);\n  const senderX25519PublicKey = toKey(senderX25519PublicKeyBytes, \"X25519PublicKey\" /* X25519PublicKey */);\n  const encryptionResult = deserializeEncryptionResult(encryptedPrivateMessage);\n  const privateMessage = decryptObject(\n    senderX25519PublicKey,\n    receiverEd25519SecretKey,\n    encryptionResult.secured,\n    encryptionResult.nonce\n  );\n  ensureMetadataFields(publicMessage._metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return {\n    messageSignature,\n    privateMessage,\n    publicMessage\n  };\n}\n\n// src/serialization.ts\n\n\nfunction serializePublicKeyB64(publicKey) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializePublicKey)(serializer, publicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializePublicKeyB64(publicKeyB64) {\n  const serializedPublicKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(publicKeyB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedPublicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKey)(deserializer);\n}\nfunction deserializeEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(decodeBase64(ed25519PublicKeyB64));\n}\nfunction serializeSignatureB64(signature) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializeSignature)(serializer, signature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializeSignatureB64(signatureB64) {\n  const serializedSignature = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(signatureB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedSignature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializeSignature)(deserializer);\n}\nfunction deserializeEd25519SignatureB64(ed25519SignatureB64) {\n  const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(ed25519SignatureB64).toUint8Array();\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(signatureBytes);\n}\nfunction publicKeyB64FromEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  const publicKey = deserializeEd25519PublicKeyB64(ed25519PublicKeyB64);\n  return serializePublicKeyB64(publicKey);\n}\n\n// src/walletAccounts.ts\n\n\nvar AccountConnectionAction = /* @__PURE__ */ ((AccountConnectionAction2) => {\n  AccountConnectionAction2[\"ADD\"] = \"add\";\n  AccountConnectionAction2[\"REMOVE\"] = \"remove\";\n  return AccountConnectionAction2;\n})(AccountConnectionAction || {});\nfunction deriveAccountTransportEd25519Keypair(ed25519SecretKeyOrSignCallback, publicKey) {\n  const publicKeyBytes = publicKey instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.PublicKey ? publicKey.toUint8Array() : publicKey.key;\n  if (ed25519SecretKeyOrSignCallback instanceof Function) {\n    const seedGeneratorBytes = messageHash(publicKeyBytes, \"TRANSPORT_KEYPAIR\");\n    const signature = ed25519SecretKeyOrSignCallback(seedGeneratorBytes);\n    if (signature instanceof Promise) {\n      return signature.then((value) => ed25519KeypairFromSecret(value.toUint8Array()));\n    }\n    return ed25519KeypairFromSecret(signature.toUint8Array());\n  }\n  const seedBytes = signWithEd25519SecretKey(publicKeyBytes, ed25519SecretKeyOrSignCallback, \"TRANSPORT_KEYPAIR\");\n  return ed25519KeypairFromSecret(seedBytes);\n}\nfunction createSerializedAccountInfo(...[\n  signCallback,\n  publicKey,\n  transportEd25519PublicKey,\n  action,\n  intentId,\n  accountAddress\n]) {\n  const authKey = publicKey.authKey();\n  const finalAccountAddress = accountAddress || authKey.derivedAddress().toString();\n  const publicKeyB64 = serializePublicKeyB64(publicKey);\n  const accountInfo = {\n    accountAddress: finalAccountAddress,\n    action,\n    intentId,\n    publicKeyB64,\n    timestampMillis: Date.now(),\n    transportEd25519PublicKeyB64: encodeBase64(transportEd25519PublicKey.key)\n  };\n  const accountInfoSerialized = JSON.stringify(accountInfo);\n  const accountInfoBytes = new TextEncoder().encode(accountInfoSerialized);\n  const accountInfoHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(accountInfoBytes);\n  const signature = signCallback(messageHash(accountInfoHash, \"ACCOUNT_INFO\"));\n  if (signature instanceof Promise) {\n    return signature.then((value) => ({\n      accountInfoSerialized,\n      signatureB64: serializeSignatureB64(value)\n    }));\n  }\n  return {\n    accountInfoSerialized,\n    signatureB64: serializeSignatureB64(signature)\n  };\n}\nasync function aptosAccountToSerializedInfo(account, intentId) {\n  const signCallback = async (data) => account.sign(data);\n  const transportKey = await deriveAccountTransportEd25519Keypair(signCallback, account.publicKey);\n  return createSerializedAccountInfo(\n    signCallback,\n    account.publicKey,\n    transportKey.publicKey,\n    \"add\" /* ADD */,\n    intentId\n  );\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDc0Q7QUFDUjtBQUNoQjtBQUNFOztBQUVoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnQkFBZ0I7QUFDakI7QUFDQSx5QkFBeUIsMENBQVE7QUFDakM7QUFDQTtBQUNBLDBCQUEwQiwyQ0FBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDJDQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBeUI7QUFDbkQ7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQXlCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrREFBaUIsQ0FBQywwQ0FBUztBQUMzQztB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QUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDREQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXdERTtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNocmF2XFxhaS5hcHQtbWV0YW1vdmUtaGFja2F0aG9uXFxmcm9udGVkXFxub2RlX21vZHVsZXNcXEBpZGVudGl0eS1jb25uZWN0XFxjcnlwdG9cXGRpc3RcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZW5jckRlY3IudHNcbmltcG9ydCB7IEVkMjU1MTlTaWduYXR1cmUgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBzaGEzXzI1NiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbmltcG9ydCBuYWNsMiBmcm9tIFwidHdlZXRuYWNsXCI7XG5pbXBvcnQgZWQyY3VydmUgZnJvbSBcImVkMmN1cnZlXCI7XG5cbi8vIHNyYy9lcnJvcnMudHNcbnZhciBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xufTtcbnZhciBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yID0gY2xhc3MgX0VudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGZpZWxkKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgIHRoaXMubmFtZSA9IFwiRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIERlY3J5cHRpb25FcnJvciA9IGNsYXNzIF9EZWNyeXB0aW9uRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkRlY3J5cHRpb25FcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRGVjcnlwdGlvbkVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IG5hY2wgZnJvbSBcInR3ZWV0bmFjbFwiO1xudmFyIEtleVR5cGVzID0gLyogQF9fUFVSRV9fICovICgoS2V5VHlwZXMyKSA9PiB7XG4gIEtleVR5cGVzMltcIkVkMjU1MTlQdWJsaWNLZXlcIl0gPSBcIkVkMjU1MTlQdWJsaWNLZXlcIjtcbiAgS2V5VHlwZXMyW1wiRWQyNTUxOVNlY3JldEtleVwiXSA9IFwiRWQyNTUxOVNlY3JldEtleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlQdWJsaWNLZXlcIl0gPSBcIlgyNTUxOVB1YmxpY0tleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlTZWNyZXRLZXlcIl0gPSBcIlgyNTUxOVNlY3JldEtleVwiO1xuICByZXR1cm4gS2V5VHlwZXMyO1xufSkoS2V5VHlwZXMgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlWDI1NTE5S2V5UGFpcigpIHtcbiAgcmV0dXJuIGtleXBhaXJUb1gyNTUxOShuYWNsLmJveC5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gY3JlYXRlRWQyNTUxOUtleVBhaXIoKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gdG9LZXkocmF3S2V5LCB0eXBlKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiByYXdLZXksXG4gICAgdHlwZVxuICB9O1xufVxuZnVuY3Rpb24ga2V5cGFpclRvRWQyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJFZDI1NTE5UHVibGljS2V5XCIgLyogRWQyNTUxOVB1YmxpY0tleSAqLyksXG4gICAgc2VjcmV0S2V5OiB0b0tleShrZXlQYWlyLnNlY3JldEtleSwgXCJFZDI1NTE5U2VjcmV0S2V5XCIgLyogRWQyNTUxOVNlY3JldEtleSAqLylcbiAgfTtcbn1cbmZ1bmN0aW9uIGtleXBhaXJUb1gyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJYMjU1MTlQdWJsaWNLZXlcIiAvKiBYMjU1MTlQdWJsaWNLZXkgKi8pLFxuICAgIHNlY3JldEtleTogdG9LZXkoa2V5UGFpci5zZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKVxuICB9O1xufVxuZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9FZDI1NTE5S2V5cGFpcihhY2NvdW50KSB7XG4gIHJldHVybiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoYWNjb3VudC5zaWduaW5nS2V5LnNlY3JldEtleSk7XG59XG5mdW5jdGlvbiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoZWQyNTUxOVNlY3JldEtleUJ5dGVzKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyLmZyb21TZWVkKGVkMjU1MTlTZWNyZXRLZXlCeXRlcy5zbGljZSgwLCAzMikpKTtcbn1cbmZ1bmN0aW9uIGRlY29kZUJhc2U2NChiYXNlNjRTdHIpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGJhc2U2NFN0ciwgXCJiYXNlNjRcIikpO1xuICB9XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20oYXRvYihiYXNlNjRTdHIpLCAobSkgPT4gbS5jb2RlUG9pbnRBdCgwKSk7XG59XG5mdW5jdGlvbiBlbmNvZGVCYXNlNjQoYnl0ZXMpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGJ5dGVzKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbiAgfVxuICByZXR1cm4gYnRvYShBcnJheS5mcm9tKGJ5dGVzLCAoeCkgPT4gU3RyaW5nLmZyb21Db2RlUG9pbnQoeCkpLmpvaW4oXCJcIikpO1xufVxuZnVuY3Rpb24gY29uY2F0VWludDhhcnJheShhcnJheU9uZSwgYXJyYXlUd28pIHtcbiAgY29uc3QgbWVyZ2VkQXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheU9uZS5sZW5ndGggKyBhcnJheVR3by5sZW5ndGgpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlPbmUpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlUd28sIGFycmF5T25lLmxlbmd0aCk7XG4gIHJldHVybiBtZXJnZWRBcnJheTtcbn1cblxuLy8gc3JjL2VuY3JEZWNyLnRzXG52YXIgU0lHTkFUVVJFX1BSRUZJWCA9IFwiQVBUT1M6OklERU5USVRZX0NPTk5FQ1RcIjtcbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleSwgZXJyb3JLZXlOYW1lKSB7XG4gIGNvbnN0IHgyNTUxOVB1YmxpY0tleSA9IGVkMmN1cnZlLmNvbnZlcnRQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleS5rZXkuc2xpY2UoMCwgMzIpKTtcbiAgaWYgKCF4MjU1MTlQdWJsaWNLZXkpXG4gICAgdGhyb3cgbmV3IEVycm9yKGAke2Vycm9yS2V5TmFtZX0gaXMgbm90IGEgdmFsaWQgRWQyNTUxOSBwdWJsaWMga2V5YCk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlQdWJsaWNLZXksIFwiWDI1NTE5UHVibGljS2V5XCIgLyogWDI1NTE5UHVibGljS2V5ICovKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5U2VjcmV0S2V5VG9YMjU1MTlTZWNyZXRLZXkoZWQyNTUxOVNlY3JldEtleSkge1xuICBjb25zdCB4MjU1MTlTZWNyZXRLZXkgPSBlZDJjdXJ2ZS5jb252ZXJ0U2VjcmV0S2V5KGVkMjU1MTlTZWNyZXRLZXkua2V5LnNsaWNlKDAsIDMyKSk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlTZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jKSB7XG4gIHJldHVybiB7XG4gICAgbm9uY2VCNjQ6IGVuY29kZUJhc2U2NChlbmMubm9uY2UpLFxuICAgIHNlY3VyZWRCNjQ6IGVuY29kZUJhc2U2NChlbmMuc2VjdXJlZClcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW5jcnlwdGlvblJlc3VsdChlbmMpIHtcbiAgcmV0dXJuIHtcbiAgICBub25jZTogZGVjb2RlQmFzZTY0KGVuYy5ub25jZUI2NCksXG4gICAgc2VjdXJlZDogZGVjb2RlQmFzZTY0KGVuYy5zZWN1cmVkQjY0KVxuICB9O1xufVxuZnVuY3Rpb24gZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBkZXMuc2VjdXJlZCwgZGVzLm5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdERpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIGRlcy5zZWN1cmVkLCBkZXMubm9uY2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE1lc3NhZ2Uoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXkgPSBjb252ZXJ0RWQyNTUxOVB1YmxpY0tleVRvWDI1NTE5UHVibGljS2V5KFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBcInJlY2VpdmVyIHB1YmxpYyBrZXlcIlxuICApO1xuICByZXR1cm4gZW5jcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSk7XG59XG5mdW5jdGlvbiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IG5vbmNlID0gbmFjbDIucmFuZG9tQnl0ZXMobmFjbDIuYm94Lm5vbmNlTGVuZ3RoKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKG1lc3NhZ2UpO1xuICBjb25zdCBzZWN1cmVkID0gbmFjbDIuYm94KG1lc3NhZ2VVaW50OCwgbm9uY2UsIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LmtleSwgc2VuZGVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMikpO1xuICByZXR1cm4geyBub25jZSwgc2VjdXJlZCB9O1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSkge1xuICBjb25zdCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSA9IGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoXG4gICAgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIFwicmVjZWl2ZXIgcHVibGljIGtleVwiXG4gICk7XG4gIHJldHVybiBlbmNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVNlY3JldEtleSwgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdERpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIHJldHVybiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0TWVzc2FnZShzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKSB7XG4gIGNvbnN0IHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5ID0gY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleShyZWNlaXZlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4gZGVjcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5UHVibGljS2V5LCByZWNlaXZlclgyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRNZXNzYWdlRGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBsZXQgZGVjcnlwdGVkVWludDg7XG4gIHRyeSB7XG4gICAgZGVjcnlwdGVkVWludDggPSBuYWNsMi5ib3gub3BlbihcbiAgICAgIHNlY3VyZWRNZXNzYWdlLFxuICAgICAgbm9uY2UsXG4gICAgICBzZW5kZXJYMjU1MTlQdWJsaWNLZXkua2V5LnNsaWNlKDAsIDMyKSxcbiAgICAgIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMilcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IERlY3J5cHRpb25FcnJvcihgQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZTogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbiAgaWYgKCFkZWNyeXB0ZWRVaW50OClcbiAgICB0aHJvdyBuZXcgRGVjcnlwdGlvbkVycm9yKFwiQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZVwiKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkZWNyeXB0ZWRVaW50OCk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXkgPSBjb252ZXJ0RWQyNTUxOVNlY3JldEtleVRvWDI1NTE5U2VjcmV0S2V5KHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBjb25zdCBkZWNyeXB0ZWRTdHIgPSBkZWNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWRTdHIpO1xufVxuZnVuY3Rpb24gbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSkge1xuICBjb25zdCBzaWduYXR1cmVQcmVmaXhIYXNoID0gbmV3IFVpbnQ4QXJyYXkoc2hhM18yNTYoYCR7U0lHTkFUVVJFX1BSRUZJWH06OiR7cHVycG9zZX06OmApKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHNoYTNfMjU2KGNvbmNhdFVpbnQ4YXJyYXkoc2lnbmF0dXJlUHJlZml4SGFzaCwgbWVzc2FnZSkpKTtcbn1cbmZ1bmN0aW9uIHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleSwgcHVycG9zZSkge1xuICByZXR1cm4gbmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlSGFzaChtZXNzYWdlLCBwdXJwb3NlKSwgc2lnbmluZ0VkMjU1MTlTZWNyZXRLZXkua2V5KTtcbn1cbmZ1bmN0aW9uIG1ha2VFZDI1NTE5U2VjcmV0S2V5U2lnbkNhbGxiYWNrTm9Eb21haW5TZXBhcmF0aW9uKHNpZ25pbmdFZDI1NTE5U2VjcmV0S2V5KSB7XG4gIHJldHVybiBhc3luYyAobWVzc2FnZSkgPT4gbmV3IEVkMjU1MTlTaWduYXR1cmUobmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleS5rZXkpKTtcbn1cbmZ1bmN0aW9uIHZlcmlmeVNpZ25hdHVyZShtZXNzYWdlLCBzaWduYXR1cmUsIHNpZ25pbmdQdWJsaWNLZXksIHB1cnBvc2UpIHtcbiAgcmV0dXJuIHNpZ25pbmdQdWJsaWNLZXkudmVyaWZ5U2lnbmF0dXJlKHsgbWVzc2FnZTogbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSksIHNpZ25hdHVyZSB9KTtcbn1cbmZ1bmN0aW9uIGhhc2hBbmRWZXJpZnlTaWduYXR1cmUobWVzc2FnZSwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKSB7XG4gIGNvbnN0IG1lc3NhZ2VVaW50OCA9IG1lc3NhZ2UgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gbWVzc2FnZSA6IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShtZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4SGFzaCA9IHNoYTNfMjU2KG1lc3NhZ2VVaW50OCk7XG4gIHJldHVybiB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZVVpbnQ4SGFzaCwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKTtcbn1cblxuLy8gc3JjL3NlY3VyZWRFbnZlbG9wZS50c1xuaW1wb3J0IHsgRWQyNTUxOVB1YmxpY0tleSBhcyBBcHRvc0VkMjU1MTlQdWJsaWNLZXksIEVkMjU1MTlTaWduYXR1cmUgYXMgRWQyNTUxOVNpZ25hdHVyZTIsIEhleCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IHNoYTNfMjU2IGFzIHNoYTNfMjU2MiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbnZhciBSRVFVSVJFRF9GSUVMRFMgPSBbXG4gIFwicmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5QjY0XCIsXG4gIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlbmRlclgyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlcXVlbmNlXCIsXG4gIFwidGltZXN0YW1wTWlsbGlzXCJcbl0uc29ydCgpO1xuZnVuY3Rpb24gZW5zdXJlUHJpdmF0ZVB1YmxpY0ZpZWxkc0Rpc2pvaW50KHByaXZhdGVNZXNzYWdlLCBwdWJsaWNNZXNzYWdlKSB7XG4gIGNvbnN0IGludGVyc2VjdGlvbiA9IE9iamVjdC5rZXlzKHByaXZhdGVNZXNzYWdlKS5maWx0ZXIoKHgpID0+IE9iamVjdC5rZXlzKHB1YmxpY01lc3NhZ2UpLmluY2x1ZGVzKHgpKTtcbiAgaWYgKGludGVyc2VjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmllbGQgPSBpbnRlcnNlY3Rpb25bMF07XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoYEZpZWxkICR7ZmllbGR9IGFwcGVhcnMgaW4gYm90aCBwcml2YXRlIGFuZCBwdWJsaWMgbWVzc2FnZSBmaWVsZHNgLCBmaWVsZCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGVuc3VyZU1ldGFkYXRhRmllbGRzKG1lc3NhZ2UpIHtcbiAgY29uc3QgbWVzc2FnZUtleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlKS5zb3J0KCk7XG4gIGNvbnN0IGV4dHJhRmllbGRzID0gbWVzc2FnZUtleXMuZmlsdGVyKChrZXkpID0+ICFSRVFVSVJFRF9GSUVMRFMuaW5jbHVkZXMoa2V5KSk7XG4gIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBSRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChrZXkpID0+ICFtZXNzYWdlS2V5cy5pbmNsdWRlcyhrZXkpKTtcbiAgaWYgKGV4dHJhRmllbGRzLmxlbmd0aCA+IDAgfHwgbWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgbGV0IGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHMubGVuZ3RoID4gMCA/IGBleHRyYSgke2V4dHJhRmllbGRzLmpvaW4oXCIsIFwiKX0pYCA6IFwiXCI7XG4gICAgY29uc3QgbWlzc2luZ0ZpZWxkc1N0ciA9IG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCA/IGBtaXNzaW5nKCR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9KWAgOiBcIlwiO1xuICAgIGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHNTdHIubGVuZ3RoID4gMCAmJiBtaXNzaW5nRmllbGRzU3RyLmxlbmd0aCA+IDAgPyBgJHtleHRyYUZpZWxkc1N0cn0sIGAgOiBleHRyYUZpZWxkc1N0cjtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIGBQdWJsaWNNZXNzYWdlIG1ldGFkYXRhIGZpZWxkcyBkbyBub3QgY29uZm9ybSB0byBzcGVjOiAke2V4dHJhRmllbGRzU3RyfSR7bWlzc2luZ0ZpZWxkc1N0cn1gLFxuICAgICAgXCJfbWV0YWRhdGFcIlxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplVHJhbnNwb3J0RW52ZWxvcGUodHJhbnNwb3J0RW52ZWxvcGUpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZSA9IEpTT04ucGFyc2UodHJhbnNwb3J0RW52ZWxvcGUuc2VyaWFsaXplZFB1YmxpY01lc3NhZ2UpO1xuICByZXR1cm4ge1xuICAgIC4uLnRyYW5zcG9ydEVudmVsb3BlLFxuICAgIHB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUoc2VuZGVyRWQyNTUxOVNlY3JldEtleSwgc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LCBzZXF1ZW5jZSwgcHVibGljTWVzc2FnZSwgcHJpdmF0ZU1lc3NhZ2UpIHtcbiAgY29uc3Qgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpciA9IGNyZWF0ZVgyNTUxOUtleVBhaXIoKTtcbiAgY29uc3QgbWV0YWRhdGEgPSBjb25zdHJ1Y3RNZXRhZGF0YShcbiAgICBzZW5kZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBzZXF1ZW5jZSxcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnB1YmxpY0tleVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhtZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChcbiAgICBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBtZXRhZGF0YSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlLFxuICAgIHNlbmRlckVwaGVtZXJhbFgyNTUxOUtleVBhaXJcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbnN0cnVjdE1ldGFkYXRhKHNlbmRlckVkMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgc2VxdWVuY2UsIHNlbmRlckVwaGVtZXJhbFgyNTUxOVB1YmxpY0tleSkge1xuICByZXR1cm4ge1xuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleS5rZXkpLFxuICAgIHNlbmRlckVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NChzZW5kZXJFZDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQoc2VuZGVyRXBoZW1lcmFsWDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VxdWVuY2UsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpXG4gIH07XG59XG5mdW5jdGlvbiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1ldGFkYXRhLCBwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSwgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpcikge1xuICBjb25zdCBlbmNyeXB0aW9uUmVzdWx0ID0gZW5jcnlwdE9iamVjdChcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnNlY3JldEtleSxcbiAgICByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksXG4gICAgcHJpdmF0ZU1lc3NhZ2VcbiAgKTtcbiAgY29uc3QgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UgPSBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuY3J5cHRpb25SZXN1bHQpO1xuICBjb25zdCBlbmNyeXB0ZWRQcml2YXRlTWVzc2FnZUJ5dGVzID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCBzZXJpYWxpemVkUHVibGljTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgLi4ucHVibGljTWVzc2FnZSwgX21ldGFkYXRhOiBtZXRhZGF0YSB9KTtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4ge1xuICAgIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLFxuICAgIG1lc3NhZ2VTaWduYXR1cmUsXG4gICAgc2VyaWFsaXplZFB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2MihwdWJsaWNNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2Mihwcml2YXRlTWVzc2FnZUJ5dGVzKTtcbiAgY29uc3QgY29tYmluZWRIYXNoID0gbmV3IFVpbnQ4QXJyYXkocHVibGljTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGggKyBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGgpO1xuICBjb21iaW5lZEhhc2guc2V0KHB1YmxpY01lc3NhZ2VCeXRlc0hhc2gpO1xuICBjb21iaW5lZEhhc2guc2V0KHByaXZhdGVNZXNzYWdlQnl0ZXNIYXNoLCBwdWJsaWNNZXNzYWdlQnl0ZXNIYXNoLmxlbmd0aCk7XG4gIHJldHVybiBzaGEzXzI1NjIoY29tYmluZWRIYXNoKTtcbn1cbmZ1bmN0aW9uIHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpIHtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlSGFzaEJ5dGVzLCBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIHJldHVybiBIZXguZnJvbUhleElucHV0KHNpZ25hdHVyZUJ5dGVzKS50b1N0cmluZygpO1xufVxuZnVuY3Rpb24gdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocHVibGljTWVzc2FnZUJ5dGVzLCBwcml2YXRlTWVzc2FnZUJ5dGVzLCBtZXNzYWdlU2lnbmF0dXJlSW5wdXQsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IG5ldyBFZDI1NTE5U2lnbmF0dXJlMihIZXguZnJvbUhleElucHV0KG1lc3NhZ2VTaWduYXR1cmVJbnB1dCkudG9VaW50OEFycmF5KCkpO1xuICBjb25zdCBzZW5kZXJQdWJsaWNLZXkgPSBuZXcgQXB0b3NFZDI1NTE5UHVibGljS2V5KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBtZXNzYWdlVmVyaWZpZWQgPSB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZUhhc2hCeXRlcywgbWVzc2FnZVNpZ25hdHVyZSwgc2VuZGVyUHVibGljS2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIGlmICghbWVzc2FnZVZlcmlmaWVkKSB7XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoXCJDb3VsZCBub3QgdmVyaWZ5IFNlY3VyZWRFbnZlbG9wZSBzaWduYXR1cmVcIiwgXCJtZXNzYWdlU2lnbmF0dXJlXCIpO1xuICB9XG59XG5mdW5jdGlvbiBkZWNyeXB0RW52ZWxvcGUoc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IHsgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlIH0gPSBtZXNzYWdlO1xuICBjb25zdCBwdWJsaWNNZXNzYWdlID0gSlNPTi5wYXJzZShzZXJpYWxpemVkUHVibGljTWVzc2FnZSk7XG4gIGNvbnN0IHJhd1ByaXZhdGVNZXNzYWdlID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCByYXdQdWJsaWNNZXNzYWdlID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocmF3UHVibGljTWVzc2FnZSwgcmF3UHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpO1xuICBjb25zdCBzZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0ID0gZW5jb2RlQmFzZTY0KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgZXhwZWN0ZWRQdWJsaWNLZXlCNjQgPSBwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YS5zZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0O1xuICBpZiAoc2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NCAhPT0gZXhwZWN0ZWRQdWJsaWNLZXlCNjQpIHtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleSBpbiBlbnZlbG9wZSBkb2VzIG5vdCBtYXRjaCBwcm92aWRlZCByZWNlaXZlckVkMjU1MTlTZWNyZXRLZXlcIixcbiAgICAgIFwic2VuZGVyUHVibGljS2V5XCJcbiAgICApO1xuICB9XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzID0gZGVjb2RlQmFzZTY0KHB1YmxpY01lc3NhZ2UuX21ldGFkYXRhLnNlbmRlclgyNTUxOVB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleSA9IHRvS2V5KHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzLCBcIlgyNTUxOVB1YmxpY0tleVwiIC8qIFgyNTUxOVB1YmxpY0tleSAqLyk7XG4gIGNvbnN0IGVuY3J5cHRpb25SZXN1bHQgPSBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZSA9IGRlY3J5cHRPYmplY3QoXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSxcbiAgICBlbmNyeXB0aW9uUmVzdWx0LnNlY3VyZWQsXG4gICAgZW5jcnlwdGlvblJlc3VsdC5ub25jZVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiB7XG4gICAgbWVzc2FnZVNpZ25hdHVyZSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlXG4gIH07XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uLnRzXG5pbXBvcnQge1xuICBiYXNlNjRUb0J5dGVzLFxuICBieXRlc1RvQmFzZTY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgZGVzZXJpYWxpemVTaWduYXR1cmUsXG4gIHNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgc2VyaWFsaXplU2lnbmF0dXJlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQge1xuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlQdWJsaWNLZXkgYXMgQXB0b3NFZDI1NTE5UHVibGljS2V5MixcbiAgRWQyNTUxOVNpZ25hdHVyZSBhcyBFZDI1NTE5U2lnbmF0dXJlMyxcbiAgSGV4IGFzIEhleDIsXG4gIFNlcmlhbGl6ZXJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoKTtcbiAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHB1YmxpY0tleSk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0KHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCkpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQocHVibGljS2V5QjY0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRQdWJsaWNLZXkgPSBiYXNlNjRUb0J5dGVzKHB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFB1YmxpY0tleSk7XG4gIHJldHVybiBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgcmV0dXJuIG5ldyBBcHRvc0VkMjU1MTlQdWJsaWNLZXkyKGRlY29kZUJhc2U2NChlZDI1NTE5UHVibGljS2V5QjY0KSk7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcigpO1xuICBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgc2lnbmF0dXJlKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NChzaWduYXR1cmVCNjQpIHtcbiAgY29uc3Qgc2VyaWFsaXplZFNpZ25hdHVyZSA9IGJhc2U2NFRvQnl0ZXMoc2lnbmF0dXJlQjY0KTtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkU2lnbmF0dXJlKTtcbiAgcmV0dXJuIGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVkMjU1MTlTaWduYXR1cmVCNjQoZWQyNTUxOVNpZ25hdHVyZUI2NCkge1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IEhleDIuZnJvbUhleElucHV0KGVkMjU1MTlTaWduYXR1cmVCNjQpLnRvVWludDhBcnJheSgpO1xuICByZXR1cm4gbmV3IEVkMjU1MTlTaWduYXR1cmUzKHNpZ25hdHVyZUJ5dGVzKTtcbn1cbmZ1bmN0aW9uIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgY29uc3QgcHVibGljS2V5ID0gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICByZXR1cm4gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG59XG5cbi8vIHNyYy93YWxsZXRBY2NvdW50cy50c1xuaW1wb3J0IHsgUHVibGljS2V5IGFzIEFwdG9zUHVibGljS2V5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuaW1wb3J0IHsgc2hhM18yNTYgYXMgc2hhM18yNTYzIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvc2hhM1wiO1xudmFyIEFjY291bnRDb25uZWN0aW9uQWN0aW9uID0gLyogQF9fUFVSRV9fICovICgoQWNjb3VudENvbm5lY3Rpb25BY3Rpb24yKSA9PiB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIkFERFwiXSA9IFwiYWRkXCI7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIlJFTU9WRVwiXSA9IFwicmVtb3ZlXCI7XG4gIHJldHVybiBBY2NvdW50Q29ubmVjdGlvbkFjdGlvbjI7XG59KShBY2NvdW50Q29ubmVjdGlvbkFjdGlvbiB8fCB7fSk7XG5mdW5jdGlvbiBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBwdWJsaWNLZXkpIHtcbiAgY29uc3QgcHVibGljS2V5Qnl0ZXMgPSBwdWJsaWNLZXkgaW5zdGFuY2VvZiBBcHRvc1B1YmxpY0tleSA/IHB1YmxpY0tleS50b1VpbnQ4QXJyYXkoKSA6IHB1YmxpY0tleS5rZXk7XG4gIGlmIChlZDI1NTE5U2VjcmV0S2V5T3JTaWduQ2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHNlZWRHZW5lcmF0b3JCeXRlcyA9IG1lc3NhZ2VIYXNoKHB1YmxpY0tleUJ5dGVzLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGVkMjU1MTlTZWNyZXRLZXlPclNpZ25DYWxsYmFjayhzZWVkR2VuZXJhdG9yQnl0ZXMpO1xuICAgIGlmIChzaWduYXR1cmUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZXR1cm4gc2lnbmF0dXJlLnRoZW4oKHZhbHVlKSA9PiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQodmFsdWUudG9VaW50OEFycmF5KCkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGVkMjU1MTlLZXlwYWlyRnJvbVNlY3JldChzaWduYXR1cmUudG9VaW50OEFycmF5KCkpO1xuICB9XG4gIGNvbnN0IHNlZWRCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShwdWJsaWNLZXlCeXRlcywgZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICByZXR1cm4gZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0KHNlZWRCeXRlcyk7XG59XG5mdW5jdGlvbiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oLi4uW1xuICBzaWduQ2FsbGJhY2ssXG4gIHB1YmxpY0tleSxcbiAgdHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSxcbiAgYWN0aW9uLFxuICBpbnRlbnRJZCxcbiAgYWNjb3VudEFkZHJlc3Ncbl0pIHtcbiAgY29uc3QgYXV0aEtleSA9IHB1YmxpY0tleS5hdXRoS2V5KCk7XG4gIGNvbnN0IGZpbmFsQWNjb3VudEFkZHJlc3MgPSBhY2NvdW50QWRkcmVzcyB8fCBhdXRoS2V5LmRlcml2ZWRBZGRyZXNzKCkudG9TdHJpbmcoKTtcbiAgY29uc3QgcHVibGljS2V5QjY0ID0gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG4gIGNvbnN0IGFjY291bnRJbmZvID0ge1xuICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbEFjY291bnRBZGRyZXNzLFxuICAgIGFjdGlvbixcbiAgICBpbnRlbnRJZCxcbiAgICBwdWJsaWNLZXlCNjQsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpLFxuICAgIHRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NCh0cmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LmtleSlcbiAgfTtcbiAgY29uc3QgYWNjb3VudEluZm9TZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkoYWNjb3VudEluZm8pO1xuICBjb25zdCBhY2NvdW50SW5mb0J5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGFjY291bnRJbmZvU2VyaWFsaXplZCk7XG4gIGNvbnN0IGFjY291bnRJbmZvSGFzaCA9IHNoYTNfMjU2MyhhY2NvdW50SW5mb0J5dGVzKTtcbiAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbkNhbGxiYWNrKG1lc3NhZ2VIYXNoKGFjY291bnRJbmZvSGFzaCwgXCJBQ0NPVU5UX0lORk9cIikpO1xuICBpZiAoc2lnbmF0dXJlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgIHJldHVybiBzaWduYXR1cmUudGhlbigodmFsdWUpID0+ICh7XG4gICAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgICBzaWduYXR1cmVCNjQ6IHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCh2YWx1ZSlcbiAgICB9KSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgc2lnbmF0dXJlQjY0OiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9TZXJpYWxpemVkSW5mbyhhY2NvdW50LCBpbnRlbnRJZCkge1xuICBjb25zdCBzaWduQ2FsbGJhY2sgPSBhc3luYyAoZGF0YSkgPT4gYWNjb3VudC5zaWduKGRhdGEpO1xuICBjb25zdCB0cmFuc3BvcnRLZXkgPSBhd2FpdCBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoc2lnbkNhbGxiYWNrLCBhY2NvdW50LnB1YmxpY0tleSk7XG4gIHJldHVybiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oXG4gICAgc2lnbkNhbGxiYWNrLFxuICAgIGFjY291bnQucHVibGljS2V5LFxuICAgIHRyYW5zcG9ydEtleS5wdWJsaWNLZXksXG4gICAgXCJhZGRcIiAvKiBBREQgKi8sXG4gICAgaW50ZW50SWRcbiAgKTtcbn1cbmV4cG9ydCB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uLFxuICBEZWNyeXB0aW9uRXJyb3IsXG4gIEVuY3J5cHRpb25FbnZlbG9wZUVycm9yLFxuICBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yLFxuICBLZXlUeXBlcyxcbiAgUkVRVUlSRURfRklFTERTLFxuICBTSUdOQVRVUkVfUFJFRklYLFxuICBhcHRvc0FjY291bnRUb0VkMjU1MTlLZXlwYWlyLFxuICBhcHRvc0FjY291bnRUb1NlcmlhbGl6ZWRJbmZvLFxuICBjb25jYXRVaW50OGFycmF5LFxuICBjb25zdHJ1Y3RNZXRhZGF0YSxcbiAgY29udmVydEVkMjU1MTlQdWJsaWNLZXlUb1gyNTUxOVB1YmxpY0tleSxcbiAgY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleSxcbiAgY3JlYXRlRWQyNTUxOUtleVBhaXIsXG4gIGNyZWF0ZVNlcmlhbGl6ZWRBY2NvdW50SW5mbyxcbiAgY3JlYXRlWDI1NTE5S2V5UGFpcixcbiAgZGFuZ2Vyb3VzbHlFbmNyeXB0QW5kU2lnbkVudmVsb3BlVW52YWxpZGF0ZWQsXG4gIGRlY29kZUJhc2U2NCxcbiAgZGVjcnlwdEVudmVsb3BlLFxuICBkZWNyeXB0TWVzc2FnZSxcbiAgZGVjcnlwdE1lc3NhZ2VEaXJlY3QsXG4gIGRlY3J5cHRPYmplY3QsXG4gIGRlY3J5cHRPYmplY3REaXJlY3QsXG4gIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdCxcbiAgZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0RGlyZWN0LFxuICBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIsXG4gIGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgZGVzZXJpYWxpemVFZDI1NTE5U2lnbmF0dXJlQjY0LFxuICBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQsXG4gIGRlc2VyaWFsaXplUHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgZGVzZXJpYWxpemVUcmFuc3BvcnRFbnZlbG9wZSxcbiAgZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0LFxuICBlbmNvZGVCYXNlNjQsXG4gIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUsXG4gIGVuY3J5cHRNZXNzYWdlLFxuICBlbmNyeXB0TWVzc2FnZURpcmVjdCxcbiAgZW5jcnlwdE9iamVjdCxcbiAgZW5jcnlwdE9iamVjdERpcmVjdCxcbiAgZW5zdXJlTWV0YWRhdGFGaWVsZHMsXG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludCxcbiAgaGFzaEFuZFZlcmlmeVNpZ25hdHVyZSxcbiAga2V5cGFpclRvRWQyNTUxOSxcbiAga2V5cGFpclRvWDI1NTE5LFxuICBtYWtlRWQyNTUxOVNlY3JldEtleVNpZ25DYWxsYmFja05vRG9tYWluU2VwYXJhdGlvbixcbiAgbWVzc2FnZUhhc2gsXG4gIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0LFxuICBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0LFxuICBzZXJpYWxpemVQdWJsaWNLZXlCNjQsXG4gIHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgc2lnbldpdGhFZDI1NTE5U2VjcmV0S2V5LFxuICB0b0tleSxcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUsXG4gIHZlcmlmeVNpZ25hdHVyZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/crypto/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@identity-connect/dapp-sdk/dist/index.mjs":
/*!****************************************************************!*\
  !*** ./node_modules/@identity-connect/dapp-sdk/dist/index.mjs ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACDappClient: () => (/* binding */ ACDappClient),\n/* harmony export */   ACKeylessClient: () => (/* binding */ ACKeylessClient),\n/* harmony export */   DAPP_PAIRINGS_WINDOW_STORAGE_KEY: () => (/* binding */ DAPP_PAIRINGS_WINDOW_STORAGE_KEY),\n/* harmony export */   ICDappClient: () => (/* binding */ ICDappClient),\n/* harmony export */   windowStateAccessors: () => (/* binding */ windowStateAccessors)\n/* harmony export */ });\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-connect/web-transport */ \"(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @identity-connect/api */ \"(ssr)/./node_modules/@identity-connect/api/dist/index.mjs\");\n/* harmony import */ var _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @identity-connect/crypto */ \"(ssr)/./node_modules/@identity-connect/crypto/dist/index.mjs\");\n/* harmony import */ var _identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @identity-connect/wallet-api */ \"(ssr)/./node_modules/@identity-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! axios */ \"(ssr)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! axios */ \"(ssr)/./node_modules/axios/index.js\");\n// src/ACDappClient.ts\n\n\n\n\n\n\n// src/constants.ts\nvar DEFAULT_FRONTEND_URL = \"https://aptosconnect.app\";\n\n// src/conversion.ts\n\nfunction convertToSerializableArgument(argument) {\n  if (argument === void 0 || argument === null) {\n    return argument;\n  }\n  if (Array.isArray(argument)) {\n    return argument.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n  if (typeof argument === \"string\" || typeof argument === \"number\" || typeof argument === \"boolean\" || argument instanceof Uint8Array) {\n    return argument;\n  }\n  if (typeof argument === \"bigint\") {\n    return argument.toString();\n  }\n  if (argument instanceof ArrayBuffer) {\n    return new Uint8Array(argument);\n  }\n  if (\"values\" in argument) {\n    return argument.values.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n  if (\"data\" in argument) {\n    return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(argument.data).toString();\n  }\n  if (argument.value === void 0) {\n    return void 0;\n  }\n  if (typeof argument.value === \"string\" || typeof argument.value === \"number\" || typeof argument.value === \"boolean\" || argument.value instanceof Uint8Array) {\n    return argument.value;\n  }\n  if (typeof argument.value === \"bigint\") {\n    return argument.value.toString();\n  }\n  throw new Error(\"Unexpected argument\");\n}\nfunction normalizePayloadForIC(payload, aptosConfig) {\n  if (\"bcsToBytes\" in payload) {\n    return payload;\n  }\n  if (\"bytecode\" in payload) {\n    return (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)(payload);\n  }\n  if (aptosConfig) {\n    return payload.abi !== void 0 ? (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayloadWithABI)({ ...payload, abi: payload.abi }) : (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)({ aptosConfig, ...payload });\n  }\n  const entryFunctionPayload = {\n    arguments: payload.functionArguments.map(convertToSerializableArgument),\n    function: payload.function,\n    type: \"entry_function_payload\",\n    type_arguments: (payload.typeArguments ?? []).map((ta) => ta.toString())\n  };\n  return \"multisigAddress\" in payload ? {\n    multisig_address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(payload.multisigAddress).toString(),\n    transaction_payload: entryFunctionPayload,\n    type: \"multisig_payload\"\n  } : entryFunctionPayload;\n}\n\n// src/PairingClient.ts\n\n\n\n\n\n\n// src/errors.ts\nvar SignatureRequestError = class _SignatureRequestError extends Error {\n  constructor(status) {\n    super(status);\n    this.name = \"SignatureRequestError\";\n    Object.setPrototypeOf(this, _SignatureRequestError.prototype);\n  }\n};\nvar UnexpectedSignatureResponseError = class _UnexpectedSignatureResponseError extends Error {\n  constructor(missingFields) {\n    const message = `Missing the following fields: ${missingFields.join(\", \")}`;\n    super(message);\n    this.name = \"UnexpectedSignatureResponseError\";\n    Object.setPrototypeOf(this, _UnexpectedSignatureResponseError.prototype);\n  }\n};\nvar PairingExpiredError = class _PairingExpiredError extends Error {\n  constructor() {\n    super();\n    this.name = \"PairingExpiredError\";\n    Object.setPrototypeOf(this, _PairingExpiredError.prototype);\n  }\n};\nvar UnregisteredDappError = class _UnregisteredDappError extends Error {\n  constructor() {\n    super(\"Dapp ID is invalid or not associated with a registered Dapp.\");\n    this.name = \"UnregisteredDappError\";\n    Object.setPrototypeOf(this, _UnregisteredDappError.prototype);\n  }\n};\n\n// src/state.ts\nvar DAPP_PAIRINGS_WINDOW_STORAGE_KEY = \"icDappPairings\";\nvar windowStateAccessors = {\n  async get(address) {\n    const pairings = await this.getAll();\n    return pairings[address];\n  },\n  async getAll() {\n    const serialized = window.localStorage.getItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY);\n    return serialized ? JSON.parse(serialized) : {};\n  },\n  async update(address, pairing) {\n    const pairings = await this.getAll();\n    if (pairing === void 0) {\n      delete pairings[address];\n    } else {\n      pairings[address] = pairing;\n    }\n    const newSerialized = JSON.stringify(pairings);\n    window.localStorage.setItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY, newSerialized);\n  }\n};\n\n// src/utils.ts\nvar SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS = [\n  \"address\",\n  \"application\",\n  \"chainId\",\n  \"fullMessage\",\n  \"message\",\n  \"nonce\",\n  \"prefix\",\n  \"signature\"\n];\nfunction validateSignMessageResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS.filter((field) => !providedFields.has(field));\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\nvar SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS = [\"hash\"];\nfunction validateSignAndSubmitTransactionResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS.filter(\n    (field) => !providedFields.has(field)\n  );\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\n\n// src/PairingClient.ts\nvar API_VERSION = \"0.2.0\";\nvar SIGNING_REQUEST_POLLING_INTERVAL = 2500;\nvar SEQUENCE_NUMBER_MISMATCH_PATTERN = /^Sequence number mismatch, expected (?:\\S+ to be )?(\\d+)/;\nasync function waitFor(milliseconds) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n}\nasync function withRetries(requestFn, onError, retries = 1) {\n  for (let i = 0; i < retries; i += 1) {\n    try {\n      return await requestFn();\n    } catch (err) {\n      onError(err);\n    }\n  }\n  return requestFn();\n}\nvar ACPairingClient = class {\n  constructor({\n    accessors = windowStateAccessors,\n    axiosConfig,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET\n  } = {}) {\n    // endregion\n    this.onDisconnectListeners = /* @__PURE__ */ new Set();\n    this.accessors = accessors;\n    this.defaultNetworkName = defaultNetworkName;\n    this.axiosInstance = axios__WEBPACK_IMPORTED_MODULE_6__[\"default\"].create({\n      baseURL: DEFAULT_FRONTEND_URL,\n      ...axiosConfig\n    });\n    const isClientSideRendering = typeof window !== \"undefined\";\n    this.initPromise = isClientSideRendering ? this.syncFirstPairing() : void 0;\n  }\n  async getPairing(id) {\n    const response = await this.axiosInstance.get(`v1/pairing/${id}/`);\n    return response.data.data.pairing;\n  }\n  async syncFirstPairing() {\n    const pairings = await this.accessors.getAll();\n    const firstPairing = Object.values(pairings)[0];\n    if (firstPairing === void 0) {\n      return;\n    }\n    try {\n      const { dappSpecificWallet, maxDappSequenceNumber } = await this.getPairing(firstPairing.pairingId);\n      await this.accessors.update(firstPairing.accountAddress, {\n        ...firstPairing,\n        currSequenceNumber: maxDappSequenceNumber,\n        dappWalletId: dappSpecificWallet?.id\n      });\n    } catch (err) {\n      await this.accessors.update(firstPairing.accountAddress, void 0);\n    }\n  }\n  async createSigningRequest(pairing, type, networkName, requestBody) {\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    let sequenceNumber = pairing.currSequenceNumber + 1;\n    return withRetries(\n      async () => {\n        const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          sequenceNumber,\n          { apiVersion: API_VERSION, networkName, requestType: type },\n          requestBody\n        );\n        const response = await this.axiosInstance.post(\n          `v1/pairing/${pairing.pairingId}/signing-request/`,\n          requestEnvelope\n        );\n        await this.accessors.update(pairing.accountAddress, {\n          ...pairing,\n          currSequenceNumber: sequenceNumber\n        });\n        return response.data.data.signingRequest;\n      },\n      (err) => {\n        if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err)) {\n          const errorMessage = err.response?.data?.message;\n          const expectedSequenceNumber = errorMessage?.match(SEQUENCE_NUMBER_MISMATCH_PATTERN)?.[1];\n          if (expectedSequenceNumber !== void 0) {\n            sequenceNumber = Number(expectedSequenceNumber);\n            return;\n          }\n        }\n        throw err;\n      }\n    );\n  }\n  async getSigningRequest(id) {\n    const response = await this.axiosInstance.get(\n      `v1/signing-request/${id}/`,\n      {\n        validateStatus: (status) => status === 200 || status === 404\n      }\n    );\n    return response.data?.data?.signingRequest;\n  }\n  async deletePairing(pairingId, secretKey, publicKey) {\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      secretKey,\n      publicKey,\n      publicKey,\n      0,\n      // ignored\n      {},\n      {}\n    );\n    await this.axiosInstance.post(\n      `v1/pairing/${pairingId}/delete/`,\n      requestEnvelope,\n      { validateStatus: (status) => status === 204 || status === 404 }\n    );\n  }\n  async cancelSigningRequest(pairing, id) {\n    const sequenceNumber = pairing.currSequenceNumber;\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      sequenceNumber + 1,\n      {},\n      {}\n    );\n    const response = await this.axiosInstance.patch(\n      `v1/signing-request/${id}/cancel/`,\n      requestEnvelope\n    );\n    await this.accessors.update(pairing.accountAddress, {\n      ...pairing,\n      currSequenceNumber: sequenceNumber + 1\n    });\n    return response.data.data.signingRequest;\n  }\n  async signRequest(address, type, requestBody, { cancelToken, networkName } = {}) {\n    await this.initPromise;\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The requested account is not paired\");\n    }\n    let signingRequest;\n    try {\n      signingRequest = await this.createSigningRequest(\n        pairing,\n        type,\n        networkName || this.defaultNetworkName,\n        requestBody\n      );\n      while (signingRequest.status === \"PENDING\") {\n        await waitFor(SIGNING_REQUEST_POLLING_INTERVAL);\n        if (cancelToken?.cancelled) {\n          signingRequest.status = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestStatus.CANCELLED;\n          break;\n        }\n        signingRequest = await this.getSigningRequest(signingRequest.id) ?? signingRequest;\n      }\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.code === \"404\") {\n        await this.accessors.update(address, void 0);\n        for (const listener of this.onDisconnectListeners) {\n          listener(address);\n        }\n        throw new PairingExpiredError();\n      }\n      throw err;\n    }\n    if (signingRequest.status !== \"APPROVED\") {\n      throw new SignatureRequestError(signingRequest.status);\n    }\n    const decrypted = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decryptEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      signingRequest.responseEnvelope\n    );\n    return decrypted.privateMessage;\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async addPairing({ publicKey, secretKey }, finalizedPairing) {\n    await this.accessors.update(finalizedPairing.account.accountAddress, {\n      accountAddress: finalizedPairing.account.accountAddress,\n      accountAlias: finalizedPairing.account.userSubmittedAlias ?? void 0,\n      accountPublicKeyB64: finalizedPairing.account.publicKeyB64,\n      accountTransportEd25519PublicKeyB64: finalizedPairing.account.transportEd25519PublicKeyB64,\n      currSequenceNumber: finalizedPairing.maxDappSequenceNumber,\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key),\n      dappEd25519SecretKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(secretKey.key),\n      dappWalletId: finalizedPairing.dappSpecificWalletId,\n      pairingId: finalizedPairing.id\n    });\n  }\n  async disconnect(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The specified account is not paired\");\n    }\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    await this.deletePairing(\n      pairing.pairingId,\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey)\n    );\n    await this.accessors.update(address, void 0);\n    for (const listener of this.onDisconnectListeners) {\n      listener(address);\n    }\n  }\n  async signMessage(address, args, options) {\n    const response = await this.signRequest(\n      address,\n      _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_MESSAGE,\n      args,\n      options\n    );\n    validateSignMessageResponse(response);\n    return response;\n  }\n  async signTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignTransactionRequestArgs)(args);\n    const serializedResponseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_TRANSACTION, serializedRequestArgs, options);\n    return (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.deserializeSignTransactionResponseArgs)(serializedResponseArgs);\n  }\n  // endregion\n  async signAndSubmitTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignAndSubmitTransactionRequestArgs)(args);\n    try {\n      const responseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_AND_SUBMIT_TRANSACTION, serializedRequestArgs, options);\n      validateSignAndSubmitTransactionResponse(responseArgs);\n      return responseArgs;\n    } catch (e) {\n      if (e instanceof axios__WEBPACK_IMPORTED_MODULE_7__.AxiosError && e.response?.data?.message) {\n        throw new Error(e.response?.data?.message);\n      }\n      throw e;\n    }\n  }\n  async getConnectedAccounts() {\n    await this.initPromise;\n    const pairings = await this.accessors.getAll();\n    return Object.values(pairings).map(\n      ({ accountAddress, accountEd25519PublicKeyB64, accountPublicKeyB64 }) => ({\n        address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(accountAddress),\n        publicKey: accountPublicKeyB64 !== void 0 ? (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKeyB64)(accountPublicKeyB64) : (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializeEd25519PublicKeyB64)(accountEd25519PublicKeyB64)\n      })\n    );\n  }\n  onDisconnect(listener) {\n    this.onDisconnectListeners.add(listener);\n    return () => this.onDisconnectListeners.delete(listener);\n  }\n};\n\n// src/ACDappClient.ts\nvar ACDappClient = class {\n  constructor({\n    backendBaseURL,\n    dappId,\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL,\n    provider = \"google\",\n    tgWebAppURL\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL, provider, tgWebAppURL);\n    this.dappId = dappId;\n    this.pairingClient = new ACPairingClient({\n      axiosConfig: {\n        baseURL: backendBaseURL ?? frontendBaseURL\n      },\n      defaultNetworkName\n    });\n  }\n  // region Public API\n  async getKeylessAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getIcAccounts() {\n    return this.pairingClient.getConnectedAccounts() ?? [];\n  }\n  async isIcAccount(address) {\n    const icAccounts = await this.getIcAccounts();\n    return icAccounts.find((account) => account.address.equals(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address))) !== void 0;\n  }\n  async getConnectedAccounts() {\n    const keylessAccounts = await this.getKeylessAccounts();\n    const icAccounts = await this.getIcAccounts();\n    return [...keylessAccounts, ...icAccounts];\n  }\n  async disconnect(address) {\n    if (await this.isIcAccount(address)) {\n      const stringAddress = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address).toString();\n      await this.pairingClient.disconnect(stringAddress);\n    } else {\n      const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n      await this.transport.sendRequest(serializedRequest);\n    }\n  }\n  async connect({\n    claimOptions,\n    preferredWalletName\n  } = {}) {\n    const dappKeypair = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const injectedPreferredWalletName = typeof window !== \"undefined\" ? window.AC_PREFERRED_WALLET_NAME : void 0;\n    const requestArgs = {\n      claimOptions,\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(dappKeypair.publicKey.key),\n      dappId: this.dappId,\n      preferredWalletName: preferredWalletName ?? injectedPreferredWalletName\n    };\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo, requestArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    if (response.args.status === \"approved\") {\n      const { account, pairing } = response.args.args;\n      if (pairing) {\n        await this.pairingClient.addPairing(dappKeypair, pairing);\n      }\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ account });\n    }\n    return response.args;\n  }\n  async signIn(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignInRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignInResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signMessage(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { chainId } = args;\n      const network = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.chainIdToNetwork)(chainId);\n      let message;\n      let nonce;\n      try {\n        message = new TextDecoder().decode(args.message);\n        nonce = new TextDecoder().decode(args.nonce);\n      } catch (err) {\n        throw new Error(\"Only UTF-8 encoded text is supported when using IC\");\n      }\n      const { fullMessage, signature: hexSignature } = await this.pairingClient.signMessage(\n        signerAddress.toString(),\n        {\n          address: true,\n          application: true,\n          chainId: true,\n          message,\n          nonce\n        },\n        { networkName: network }\n      );\n      const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Hex.fromHexInput(hexSignature).toUint8Array();\n      const signature = signatureBytes.length === _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature.LENGTH ? new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature(signatureBytes) : _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AnySignature.deserialize(new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Deserializer(signatureBytes));\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        fullMessage,\n        signature\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const {\n        expirationSecondsFromNow,\n        expirationTimestamp,\n        feePayer,\n        gasUnitPrice,\n        maxGasAmount,\n        network,\n        payload,\n        secondarySigners,\n        sender,\n        sequenceNumber\n      } = normalizedArgs;\n      if (feePayer !== void 0) {\n        throw new Error(\"Sponsored transaction not currently supported\");\n      }\n      if (secondarySigners && secondarySigners.length > 0) {\n        throw new Error(\"Multi-agent transactions not currently supported\");\n      }\n      if (!(\"bcsToBytes\" in payload)) {\n        throw new Error(\"Payload input format is only supported with Keyless accounts.\");\n      }\n      const responseArgs = await this.pairingClient.signTransaction(\n        signerAddress.toString(),\n        {\n          options: {\n            expirationSecondsFromNow,\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount,\n            sender: sender?.address.toString(),\n            sequenceNumber: sequenceNumber !== void 0 ? Number(sequenceNumber) : void 0\n          },\n          payload\n        },\n        {\n          networkName: network\n        }\n      );\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        authenticator: responseArgs.accountAuthenticator,\n        rawTransaction: responseArgs.rawTxn\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { expirationTimestamp, feePayer, gasUnitPrice, maxGasAmount, network } = args;\n      const aptosConfig = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AptosConfig({ network });\n      let convertedArgs;\n      if (feePayer !== void 0) {\n        const payload = await normalizePayloadForIC(args.payload, aptosConfig);\n        const rawTxn = await (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateRawTransaction)({\n          aptosConfig,\n          feePayerAddress: feePayer.address,\n          options: {\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload,\n          sender: signerAddress\n        });\n        convertedArgs = {\n          feePayerAuthenticator: feePayer.authenticator,\n          rawTxn: new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.FeePayerRawTransaction(rawTxn, [], feePayer.address)\n        };\n      } else {\n        const payload = normalizePayloadForIC(args.payload);\n        convertedArgs = {\n          options: {\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload\n        };\n      }\n      const { hash } = await this.pairingClient.signAndSubmitTransaction(signerAddress.toString(), convertedArgs, {\n        networkName: network\n      });\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ txnHash: hash });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n// src/ICDappClient.ts\n\n\n\n// src/prompt.ts\nvar DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nvar PROMPT_POLLER_INTERVAL = 500;\nfunction openPrompt(url, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width\n  };\n  const strOptions = Object.entries(options).map(([key, value]) => `${key}=${JSON.stringify(value)}`).reduce((acc, entry) => `${acc}, ${entry}`);\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, void 0, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n  return promptWindow;\n}\nasync function waitForPromptResponse(promptWindow) {\n  return new Promise((resolve) => {\n    const listeners = {\n      onMessage: (message) => {\n        if (message.source !== promptWindow) {\n          return;\n        }\n        window.removeEventListener(\"message\", listeners.onMessage);\n        clearTimeout(listeners.promptPollerId);\n        resolve({\n          args: message.data,\n          status: \"approved\"\n        });\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve({\n            status: \"dismissed\"\n          });\n        }\n      }, PROMPT_POLLER_INTERVAL)\n    };\n    window.addEventListener(\"message\", listeners.onMessage);\n  });\n}\n\n// src/ICDappClient.ts\nvar ICDappClient = class extends ACPairingClient {\n  constructor(dappId, { frontendBaseURL = DEFAULT_FRONTEND_URL, ...pairingClientConfig } = {}) {\n    super(pairingClientConfig);\n    this.dappId = dappId;\n    this.frontendBaseURL = frontendBaseURL;\n  }\n  async createPairingRequest(dappEd25519PublicKeyB64) {\n    try {\n      const response = await this.axiosInstance.post(\"v1/pairing/\", {\n        dappEd25519PublicKeyB64,\n        dappId: this.dappId\n      });\n      return response.data.data.pairing;\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.response?.data?.message === \"Dapp not found\") {\n        throw new UnregisteredDappError();\n      }\n      throw err;\n    }\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async connect() {\n    const { publicKey, secretKey } = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const dappEd25519PublicKeyB64 = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key);\n    const url = new URL(`${this.frontendBaseURL}/pairing`);\n    const promptWindow = await openPrompt(url.href);\n    let pairingId;\n    try {\n      const pendingPairing = await this.createPairingRequest(dappEd25519PublicKeyB64);\n      pairingId = pendingPairing.id;\n    } catch (err) {\n      promptWindow.close();\n      throw err;\n    }\n    url.searchParams.set(\"pairingId\", pairingId);\n    promptWindow.location.href = url.href;\n    const promptResponse = await waitForPromptResponse(promptWindow);\n    if (promptResponse.status === \"dismissed\") {\n      void this.deletePairing(pairingId, secretKey, publicKey);\n      return void 0;\n    }\n    const finalizedPairing = promptResponse.args;\n    await this.addPairing({ publicKey, secretKey }, finalizedPairing);\n    return finalizedPairing.account.accountAddress;\n  }\n  async offboard(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"This account is not paired\");\n    }\n    const walletId = pairing.dappWalletId;\n    if (walletId === void 0) {\n      throw new Error(\"This account cannot be offboarded\");\n    }\n    const url = new URL(`${this.frontendBaseURL}/offboarding?walletId=${walletId}`);\n    const promptWindow = openPrompt(url);\n    const response = await waitForPromptResponse(promptWindow);\n    if (response.status === \"approved\" && response.args.offboarded) {\n      this.disconnect(address);\n      return true;\n    }\n    return false;\n  }\n  // endregion\n};\n\n// src/KeylessClient.ts\n\n\n\nvar ACKeylessClient = class {\n  constructor({\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL,\n    provider = \"google\"\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL, provider);\n  }\n  // region Public API\n  async isConnected() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getConnectedAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async disconnect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n    await this.transport.sendRequest(serializedRequest);\n  }\n  async connect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signMessage(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvZGFwcC1zZGsvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBaUJtQztBQUMrQjtBQVV0QztBQUN3QztBQUMyQjs7QUFFL0Y7QUFDQTs7QUFFQTtBQUs0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw4REFBYztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw4RUFBMEI7QUFDckM7QUFDQTtBQUNBLG9DQUFvQyxxRkFBaUMsR0FBRyw4QkFBOEIsSUFBSSw4RUFBMEIsR0FBRyx5QkFBeUI7QUFDaEs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw4REFBYztBQUNwQztBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ3VFO0FBS3hDO0FBVUc7QUFLSTtBQUNrQjs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQseUJBQXlCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxrQkFBa0IsYUFBYTtBQUMvQjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qiw4REFBVztBQUNwQyxJQUFJLElBQUk7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qiw2Q0FBSztBQUM5QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLEdBQUc7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw0Q0FBNEM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHNFQUFZO0FBQzdDLGlDQUFpQyxzRUFBWTtBQUM3Qyw2Q0FBNkMsc0VBQVk7QUFDekQ7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGdGQUFzQjtBQUM1RCxVQUFVLCtEQUFLLHVCQUF1Qiw4REFBUTtBQUM5QyxVQUFVLCtEQUFLLHVCQUF1Qiw4REFBUTtBQUM5QyxVQUFVLCtEQUFLLG1DQUFtQyw4REFBUTtBQUMxRDtBQUNBLFlBQVkseURBQXlEO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrQkFBa0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBLFlBQVksbURBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsR0FBRztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxnRkFBc0I7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxzRUFBWTtBQUM3QyxpQ0FBaUMsc0VBQVk7QUFDN0MsNkNBQTZDLHNFQUFZO0FBQ3pELGtDQUFrQyxnRkFBc0I7QUFDeEQsTUFBTSwrREFBSyx1QkFBdUIsOERBQVE7QUFDMUMsTUFBTSwrREFBSyx1QkFBdUIsOERBQVE7QUFDMUMsTUFBTSwrREFBSyxtQ0FBbUMsOERBQVE7QUFDdEQ7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLEdBQUc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esa0RBQWtELDJCQUEyQixJQUFJO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHVFQUFvQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixVQUFVLG1EQUFZO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseUVBQWU7QUFDckMsTUFBTSwrREFBSyxDQUFDLHNFQUFZLCtDQUErQyw4REFBUTtBQUMvRSxNQUFNLCtEQUFLLENBQUMsc0VBQVksbUNBQW1DLDhEQUFRO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHNCQUFzQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0VBQVk7QUFDM0MsK0JBQStCLHNFQUFZO0FBQzNDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHNFQUFZO0FBQzdDLGlDQUFpQyxzRUFBWTtBQUM3QztBQUNBO0FBQ0EsTUFBTSwrREFBSyx1QkFBdUIsOERBQVE7QUFDMUMsTUFBTSwrREFBSyx1QkFBdUIsOERBQVE7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxzRUFBbUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsaUdBQW1DO0FBQ3JFLG1FQUFtRSxzRUFBbUI7QUFDdEYsV0FBVyxvR0FBc0M7QUFDakQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDBHQUE0QztBQUM5RTtBQUNBLDJEQUEyRCxzRUFBbUI7QUFDOUU7QUFDQTtBQUNBLE1BQU07QUFDTix1QkFBdUIsNkNBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpRUFBaUU7QUFDMUUsaUJBQWlCLDhEQUFlO0FBQ2hDLG9EQUFvRCxpRkFBdUIsd0JBQXdCLHdGQUE4QjtBQUNqSSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOERBQVk7QUFDckM7QUFDQTtBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDRFQUFrQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsa0ZBQTJCO0FBQ3pEO0FBQ0EscUJBQXFCLG1GQUE0QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCw4REFBZTtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFlO0FBQzNDO0FBQ0EsTUFBTTtBQUNOLGdDQUFnQyx3RUFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1Isd0JBQXdCLDhFQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0VBQWE7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHFFQUFjO0FBQzVDO0FBQ0EscUJBQXFCLHNFQUFlO0FBQ3BDO0FBQ0EsY0FBYyxtQkFBbUI7QUFDakM7QUFDQTtBQUNBO0FBQ0EsYUFBYSwyRUFBZ0IsR0FBRyxTQUFTO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9FQUFhO0FBQzNDO0FBQ0EscUJBQXFCLHFFQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLFlBQVksZ0JBQWdCO0FBQzVCO0FBQ0EsY0FBYyxVQUFVO0FBQ3hCLHNCQUFzQiwyRUFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsY0FBYyx1Q0FBdUM7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsVUFBVTtBQUNWO0FBQ0EsNkJBQTZCLG1EQUFHO0FBQ2hDLGtEQUFrRCxnRUFBZ0IsY0FBYyxnRUFBZ0IsbUJBQW1CLDREQUFZLGlCQUFpQiw0REFBWTtBQUM1SixhQUFhLDJFQUFnQjtBQUM3QjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsOEJBQThCLHlFQUFrQjtBQUNoRDtBQUNBLHFCQUFxQiwwRUFBbUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELDZFQUFzQjtBQUN6RSxZQUFZLGdCQUFnQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDJFQUFnQjtBQUM3QjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsOEJBQThCLDZFQUFzQjtBQUNwRDtBQUNBLHFCQUFxQiw4RUFBdUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsWUFBWSxnQkFBZ0I7QUFDNUI7QUFDQSxjQUFjLHFFQUFxRTtBQUNuRiw4QkFBOEIsMkRBQVksR0FBRyxTQUFTO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwwRUFBc0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxzQkFBc0Isc0VBQXNCO0FBQzVDO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckI7QUFDQSxPQUFPO0FBQ1AsYUFBYSwyRUFBZ0IsR0FBRyxlQUFlO0FBQy9DO0FBQ0EsOEJBQThCLHNGQUErQjtBQUM3RDtBQUNBLHFCQUFxQix1RkFBZ0M7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDd0g7QUFDbEU7O0FBRXREO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQSxVQUFVLGdCQUFnQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxJQUFJLEdBQUcsc0JBQXNCLDZCQUE2QixJQUFJLElBQUksTUFBTTtBQUM5STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBLHdCQUF3QixpRUFBaUUsSUFBSTtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxNQUFNO0FBQ04sVUFBVSxtREFBYTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHVCQUF1QixFQUFFLDhFQUFxQjtBQUMxRCxvQ0FBb0Msc0VBQWE7QUFDakQsMkJBQTJCLHFCQUFxQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIscUJBQXFCLHdCQUF3QixTQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBZW1DO0FBQ3NEO0FBQ3JCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDhEQUFZO0FBQ3JDO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNEVBQW1CO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix5RUFBa0I7QUFDaEQ7QUFDQSxxQkFBcUIsMEVBQW1CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixrRkFBNEI7QUFDMUQ7QUFDQSxxQkFBcUIsbUZBQTZCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix3RUFBa0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHFFQUFlO0FBQzdDO0FBQ0EscUJBQXFCLHNFQUFnQjtBQUNyQztBQUNBO0FBQ0E7QUFDQSw4QkFBOEIseUVBQW1CO0FBQ2pEO0FBQ0EscUJBQXFCLDBFQUFvQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxtREFBbUQsNkVBQXVCO0FBQzFFLDhCQUE4Qiw2RUFBdUI7QUFDckQ7QUFDQSxxQkFBcUIsOEVBQXdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixzRkFBZ0M7QUFDOUQ7QUFDQSxxQkFBcUIsdUZBQWlDO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBT0U7QUFDRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzaHJhdlxcYWkuYXB0LW1ldGFtb3ZlLWhhY2thdGhvblxcZnJvbnRlZFxcbm9kZV9tb2R1bGVzXFxAaWRlbnRpdHktY29ubmVjdFxcZGFwcC1zZGtcXGRpc3RcXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvQUNEYXBwQ2xpZW50LnRzXG5pbXBvcnQge1xuICBjaGFpbklkVG9OZXR3b3JrLFxuICBDb25uZWN0UmVxdWVzdCxcbiAgQ29ubmVjdFJlc3BvbnNlLFxuICBEaXNjb25uZWN0UmVxdWVzdCxcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0LFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlLFxuICBtYWtlVXNlckFwcHJvdmFsLFxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0LFxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZSxcbiAgU2lnbkluUmVxdWVzdCxcbiAgU2lnbkluUmVzcG9uc2UsXG4gIFNpZ25NZXNzYWdlUmVxdWVzdCxcbiAgU2lnbk1lc3NhZ2VSZXNwb25zZSxcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2Vcbn0gZnJvbSBcIkBhcHRvcy1jb25uZWN0L3dhbGxldC1hcGlcIjtcbmltcG9ydCB7IFdlYldhbGxldFRyYW5zcG9ydCB9IGZyb20gXCJAYXB0b3MtY29ubmVjdC93ZWItdHJhbnNwb3J0XCI7XG5pbXBvcnQge1xuICBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczMsXG4gIEFueVNpZ25hdHVyZSxcbiAgQXB0b3NDb25maWcgYXMgQXB0b3NDb25maWcyLFxuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlTaWduYXR1cmUsXG4gIEZlZVBheWVyUmF3VHJhbnNhY3Rpb24sXG4gIGdlbmVyYXRlUmF3VHJhbnNhY3Rpb24sXG4gIEhleFxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBOZXR3b3JrTmFtZSBhcyBOZXR3b3JrTmFtZTIgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG5pbXBvcnQgeyBjcmVhdGVFZDI1NTE5S2V5UGFpciwgZW5jb2RlQmFzZTY0IGFzIGVuY29kZUJhc2U2NDIgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvXCI7XG5cbi8vIHNyYy9jb25zdGFudHMudHNcbnZhciBERUZBVUxUX0ZST05URU5EX1VSTCA9IFwiaHR0cHM6Ly9hcHRvc2Nvbm5lY3QuYXBwXCI7XG5cbi8vIHNyYy9jb252ZXJzaW9uLnRzXG5pbXBvcnQge1xuICBBY2NvdW50QWRkcmVzcyxcbiAgZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWQsXG4gIGdlbmVyYXRlVHJhbnNhY3Rpb25QYXlsb2FkV2l0aEFCSVxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBjb252ZXJ0VG9TZXJpYWxpemFibGVBcmd1bWVudChhcmd1bWVudCkge1xuICBpZiAoYXJndW1lbnQgPT09IHZvaWQgMCB8fCBhcmd1bWVudCA9PT0gbnVsbCkge1xuICAgIHJldHVybiBhcmd1bWVudDtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudCkpIHtcbiAgICByZXR1cm4gYXJndW1lbnQubWFwKChzdWJBcmd1bWVudCkgPT4gY29udmVydFRvU2VyaWFsaXphYmxlQXJndW1lbnQoc3ViQXJndW1lbnQpKTtcbiAgfVxuICBpZiAodHlwZW9mIGFyZ3VtZW50ID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBhcmd1bWVudCA9PT0gXCJudW1iZXJcIiB8fCB0eXBlb2YgYXJndW1lbnQgPT09IFwiYm9vbGVhblwiIHx8IGFyZ3VtZW50IGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgIHJldHVybiBhcmd1bWVudDtcbiAgfVxuICBpZiAodHlwZW9mIGFyZ3VtZW50ID09PSBcImJpZ2ludFwiKSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50LnRvU3RyaW5nKCk7XG4gIH1cbiAgaWYgKGFyZ3VtZW50IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYXJndW1lbnQpO1xuICB9XG4gIGlmIChcInZhbHVlc1wiIGluIGFyZ3VtZW50KSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50LnZhbHVlcy5tYXAoKHN1YkFyZ3VtZW50KSA9PiBjb252ZXJ0VG9TZXJpYWxpemFibGVBcmd1bWVudChzdWJBcmd1bWVudCkpO1xuICB9XG4gIGlmIChcImRhdGFcIiBpbiBhcmd1bWVudCkge1xuICAgIHJldHVybiBBY2NvdW50QWRkcmVzcy5mcm9tKGFyZ3VtZW50LmRhdGEpLnRvU3RyaW5nKCk7XG4gIH1cbiAgaWYgKGFyZ3VtZW50LnZhbHVlID09PSB2b2lkIDApIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG4gIGlmICh0eXBlb2YgYXJndW1lbnQudmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGFyZ3VtZW50LnZhbHVlID09PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhcmd1bWVudC52YWx1ZSA9PT0gXCJib29sZWFuXCIgfHwgYXJndW1lbnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50LnZhbHVlO1xuICB9XG4gIGlmICh0eXBlb2YgYXJndW1lbnQudmFsdWUgPT09IFwiYmlnaW50XCIpIHtcbiAgICByZXR1cm4gYXJndW1lbnQudmFsdWUudG9TdHJpbmcoKTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIGFyZ3VtZW50XCIpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplUGF5bG9hZEZvcklDKHBheWxvYWQsIGFwdG9zQ29uZmlnKSB7XG4gIGlmIChcImJjc1RvQnl0ZXNcIiBpbiBwYXlsb2FkKSB7XG4gICAgcmV0dXJuIHBheWxvYWQ7XG4gIH1cbiAgaWYgKFwiYnl0ZWNvZGVcIiBpbiBwYXlsb2FkKSB7XG4gICAgcmV0dXJuIGdlbmVyYXRlVHJhbnNhY3Rpb25QYXlsb2FkKHBheWxvYWQpO1xuICB9XG4gIGlmIChhcHRvc0NvbmZpZykge1xuICAgIHJldHVybiBwYXlsb2FkLmFiaSAhPT0gdm9pZCAwID8gZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWRXaXRoQUJJKHsgLi4ucGF5bG9hZCwgYWJpOiBwYXlsb2FkLmFiaSB9KSA6IGdlbmVyYXRlVHJhbnNhY3Rpb25QYXlsb2FkKHsgYXB0b3NDb25maWcsIC4uLnBheWxvYWQgfSk7XG4gIH1cbiAgY29uc3QgZW50cnlGdW5jdGlvblBheWxvYWQgPSB7XG4gICAgYXJndW1lbnRzOiBwYXlsb2FkLmZ1bmN0aW9uQXJndW1lbnRzLm1hcChjb252ZXJ0VG9TZXJpYWxpemFibGVBcmd1bWVudCksXG4gICAgZnVuY3Rpb246IHBheWxvYWQuZnVuY3Rpb24sXG4gICAgdHlwZTogXCJlbnRyeV9mdW5jdGlvbl9wYXlsb2FkXCIsXG4gICAgdHlwZV9hcmd1bWVudHM6IChwYXlsb2FkLnR5cGVBcmd1bWVudHMgPz8gW10pLm1hcCgodGEpID0+IHRhLnRvU3RyaW5nKCkpXG4gIH07XG4gIHJldHVybiBcIm11bHRpc2lnQWRkcmVzc1wiIGluIHBheWxvYWQgPyB7XG4gICAgbXVsdGlzaWdfYWRkcmVzczogQWNjb3VudEFkZHJlc3MuZnJvbShwYXlsb2FkLm11bHRpc2lnQWRkcmVzcykudG9TdHJpbmcoKSxcbiAgICB0cmFuc2FjdGlvbl9wYXlsb2FkOiBlbnRyeUZ1bmN0aW9uUGF5bG9hZCxcbiAgICB0eXBlOiBcIm11bHRpc2lnX3BheWxvYWRcIlxuICB9IDogZW50cnlGdW5jdGlvblBheWxvYWQ7XG59XG5cbi8vIHNyYy9QYWlyaW5nQ2xpZW50LnRzXG5pbXBvcnQgeyBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQge1xuICBOZXR3b3JrTmFtZSxcbiAgU2lnbmluZ1JlcXVlc3RTdGF0dXMsXG4gIFNpZ25pbmdSZXF1ZXN0VHlwZXNcbn0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L2FwaVwiO1xuaW1wb3J0IHtcbiAgZGVjb2RlQmFzZTY0LFxuICBkZWNyeXB0RW52ZWxvcGUsXG4gIGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQsXG4gIGVuY29kZUJhc2U2NCxcbiAgZW5jcnlwdEFuZFNpZ25FbnZlbG9wZSxcbiAgS2V5VHlwZXMsXG4gIHRvS2V5XG59IGZyb20gXCJAaWRlbnRpdHktY29ubmVjdC9jcnlwdG9cIjtcbmltcG9ydCB7XG4gIGRlc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVzcG9uc2VBcmdzLFxuICBzZXJpYWxpemVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3Ncbn0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L3dhbGxldC1hcGlcIjtcbmltcG9ydCBheGlvcywgeyBBeGlvc0Vycm9yLCBpc0F4aW9zRXJyb3IgfSBmcm9tIFwiYXhpb3NcIjtcblxuLy8gc3JjL2Vycm9ycy50c1xudmFyIFNpZ25hdHVyZVJlcXVlc3RFcnJvciA9IGNsYXNzIF9TaWduYXR1cmVSZXF1ZXN0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHN0YXR1cykge1xuICAgIHN1cGVyKHN0YXR1cyk7XG4gICAgdGhpcy5uYW1lID0gXCJTaWduYXR1cmVSZXF1ZXN0RXJyb3JcIjtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgX1NpZ25hdHVyZVJlcXVlc3RFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIFVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yID0gY2xhc3MgX1VuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtaXNzaW5nRmllbGRzKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGBNaXNzaW5nIHRoZSBmb2xsb3dpbmcgZmllbGRzOiAke21pc3NpbmdGaWVsZHMuam9pbihcIiwgXCIpfWA7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJVbmV4cGVjdGVkU2lnbmF0dXJlUmVzcG9uc2VFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfVW5leHBlY3RlZFNpZ25hdHVyZVJlc3BvbnNlRXJyb3IucHJvdG90eXBlKTtcbiAgfVxufTtcbnZhciBQYWlyaW5nRXhwaXJlZEVycm9yID0gY2xhc3MgX1BhaXJpbmdFeHBpcmVkRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5uYW1lID0gXCJQYWlyaW5nRXhwaXJlZEVycm9yXCI7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIF9QYWlyaW5nRXhwaXJlZEVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG52YXIgVW5yZWdpc3RlcmVkRGFwcEVycm9yID0gY2xhc3MgX1VucmVnaXN0ZXJlZERhcHBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoXCJEYXBwIElEIGlzIGludmFsaWQgb3Igbm90IGFzc29jaWF0ZWQgd2l0aCBhIHJlZ2lzdGVyZWQgRGFwcC5cIik7XG4gICAgdGhpcy5uYW1lID0gXCJVbnJlZ2lzdGVyZWREYXBwRXJyb3JcIjtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgX1VucmVnaXN0ZXJlZERhcHBFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xuXG4vLyBzcmMvc3RhdGUudHNcbnZhciBEQVBQX1BBSVJJTkdTX1dJTkRPV19TVE9SQUdFX0tFWSA9IFwiaWNEYXBwUGFpcmluZ3NcIjtcbnZhciB3aW5kb3dTdGF0ZUFjY2Vzc29ycyA9IHtcbiAgYXN5bmMgZ2V0KGFkZHJlc3MpIHtcbiAgICBjb25zdCBwYWlyaW5ncyA9IGF3YWl0IHRoaXMuZ2V0QWxsKCk7XG4gICAgcmV0dXJuIHBhaXJpbmdzW2FkZHJlc3NdO1xuICB9LFxuICBhc3luYyBnZXRBbGwoKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShEQVBQX1BBSVJJTkdTX1dJTkRPV19TVE9SQUdFX0tFWSk7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZWQgPyBKU09OLnBhcnNlKHNlcmlhbGl6ZWQpIDoge307XG4gIH0sXG4gIGFzeW5jIHVwZGF0ZShhZGRyZXNzLCBwYWlyaW5nKSB7XG4gICAgY29uc3QgcGFpcmluZ3MgPSBhd2FpdCB0aGlzLmdldEFsbCgpO1xuICAgIGlmIChwYWlyaW5nID09PSB2b2lkIDApIHtcbiAgICAgIGRlbGV0ZSBwYWlyaW5nc1thZGRyZXNzXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFpcmluZ3NbYWRkcmVzc10gPSBwYWlyaW5nO1xuICAgIH1cbiAgICBjb25zdCBuZXdTZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkocGFpcmluZ3MpO1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShEQVBQX1BBSVJJTkdTX1dJTkRPV19TVE9SQUdFX0tFWSwgbmV3U2VyaWFsaXplZCk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xudmFyIFNJR05fTUVTU0FHRV9SRVNQT05TRV9SRVFVSVJFRF9GSUVMRFMgPSBbXG4gIFwiYWRkcmVzc1wiLFxuICBcImFwcGxpY2F0aW9uXCIsXG4gIFwiY2hhaW5JZFwiLFxuICBcImZ1bGxNZXNzYWdlXCIsXG4gIFwibWVzc2FnZVwiLFxuICBcIm5vbmNlXCIsXG4gIFwicHJlZml4XCIsXG4gIFwic2lnbmF0dXJlXCJcbl07XG5mdW5jdGlvbiB2YWxpZGF0ZVNpZ25NZXNzYWdlUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgY29uc3QgcHJvdmlkZWRGaWVsZHMgPSBuZXcgU2V0KE9iamVjdC5rZXlzKHJlc3BvbnNlKSk7XG4gIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBTSUdOX01FU1NBR0VfUkVTUE9OU0VfUkVRVUlSRURfRklFTERTLmZpbHRlcigoZmllbGQpID0+ICFwcm92aWRlZEZpZWxkcy5oYXMoZmllbGQpKTtcbiAgaWYgKG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBVbmV4cGVjdGVkU2lnbmF0dXJlUmVzcG9uc2VFcnJvcihtaXNzaW5nRmllbGRzKTtcbiAgfVxufVxudmFyIFNJR05fQU5EX1NVQk1JVF9UUkFOU0FDVElPTl9SRVNQT05TRV9SRVFVSVJFRF9GSUVMRFMgPSBbXCJoYXNoXCJdO1xuZnVuY3Rpb24gdmFsaWRhdGVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZShyZXNwb25zZSkge1xuICBjb25zdCBwcm92aWRlZEZpZWxkcyA9IG5ldyBTZXQoT2JqZWN0LmtleXMocmVzcG9uc2UpKTtcbiAgY29uc3QgbWlzc2luZ0ZpZWxkcyA9IFNJR05fQU5EX1NVQk1JVF9UUkFOU0FDVElPTl9SRVNQT05TRV9SRVFVSVJFRF9GSUVMRFMuZmlsdGVyKFxuICAgIChmaWVsZCkgPT4gIXByb3ZpZGVkRmllbGRzLmhhcyhmaWVsZClcbiAgKTtcbiAgaWYgKG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IG5ldyBVbmV4cGVjdGVkU2lnbmF0dXJlUmVzcG9uc2VFcnJvcihtaXNzaW5nRmllbGRzKTtcbiAgfVxufVxuXG4vLyBzcmMvUGFpcmluZ0NsaWVudC50c1xudmFyIEFQSV9WRVJTSU9OID0gXCIwLjIuMFwiO1xudmFyIFNJR05JTkdfUkVRVUVTVF9QT0xMSU5HX0lOVEVSVkFMID0gMjUwMDtcbnZhciBTRVFVRU5DRV9OVU1CRVJfTUlTTUFUQ0hfUEFUVEVSTiA9IC9eU2VxdWVuY2UgbnVtYmVyIG1pc21hdGNoLCBleHBlY3RlZCAoPzpcXFMrIHRvIGJlICk/KFxcZCspLztcbmFzeW5jIGZ1bmN0aW9uIHdhaXRGb3IobWlsbGlzZWNvbmRzKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcbiAgfSk7XG59XG5hc3luYyBmdW5jdGlvbiB3aXRoUmV0cmllcyhyZXF1ZXN0Rm4sIG9uRXJyb3IsIHJldHJpZXMgPSAxKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcmV0cmllczsgaSArPSAxKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCByZXF1ZXN0Rm4oKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG9uRXJyb3IoZXJyKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlcXVlc3RGbigpO1xufVxudmFyIEFDUGFpcmluZ0NsaWVudCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGFjY2Vzc29ycyA9IHdpbmRvd1N0YXRlQWNjZXNzb3JzLFxuICAgIGF4aW9zQ29uZmlnLFxuICAgIGRlZmF1bHROZXR3b3JrTmFtZSA9IE5ldHdvcmtOYW1lLk1BSU5ORVRcbiAgfSA9IHt9KSB7XG4gICAgLy8gZW5kcmVnaW9uXG4gICAgdGhpcy5vbkRpc2Nvbm5lY3RMaXN0ZW5lcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICAgIHRoaXMuYWNjZXNzb3JzID0gYWNjZXNzb3JzO1xuICAgIHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lID0gZGVmYXVsdE5ldHdvcmtOYW1lO1xuICAgIHRoaXMuYXhpb3NJbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSh7XG4gICAgICBiYXNlVVJMOiBERUZBVUxUX0ZST05URU5EX1VSTCxcbiAgICAgIC4uLmF4aW9zQ29uZmlnXG4gICAgfSk7XG4gICAgY29uc3QgaXNDbGllbnRTaWRlUmVuZGVyaW5nID0gdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICB0aGlzLmluaXRQcm9taXNlID0gaXNDbGllbnRTaWRlUmVuZGVyaW5nID8gdGhpcy5zeW5jRmlyc3RQYWlyaW5nKCkgOiB2b2lkIDA7XG4gIH1cbiAgYXN5bmMgZ2V0UGFpcmluZyhpZCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLmdldChgdjEvcGFpcmluZy8ke2lkfS9gKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhLnBhaXJpbmc7XG4gIH1cbiAgYXN5bmMgc3luY0ZpcnN0UGFpcmluZygpIHtcbiAgICBjb25zdCBwYWlyaW5ncyA9IGF3YWl0IHRoaXMuYWNjZXNzb3JzLmdldEFsbCgpO1xuICAgIGNvbnN0IGZpcnN0UGFpcmluZyA9IE9iamVjdC52YWx1ZXMocGFpcmluZ3MpWzBdO1xuICAgIGlmIChmaXJzdFBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXBwU3BlY2lmaWNXYWxsZXQsIG1heERhcHBTZXF1ZW5jZU51bWJlciB9ID0gYXdhaXQgdGhpcy5nZXRQYWlyaW5nKGZpcnN0UGFpcmluZy5wYWlyaW5nSWQpO1xuICAgICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKGZpcnN0UGFpcmluZy5hY2NvdW50QWRkcmVzcywge1xuICAgICAgICAuLi5maXJzdFBhaXJpbmcsXG4gICAgICAgIGN1cnJTZXF1ZW5jZU51bWJlcjogbWF4RGFwcFNlcXVlbmNlTnVtYmVyLFxuICAgICAgICBkYXBwV2FsbGV0SWQ6IGRhcHBTcGVjaWZpY1dhbGxldD8uaWRcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKGZpcnN0UGFpcmluZy5hY2NvdW50QWRkcmVzcywgdm9pZCAwKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgY3JlYXRlU2lnbmluZ1JlcXVlc3QocGFpcmluZywgdHlwZSwgbmV0d29ya05hbWUsIHJlcXVlc3RCb2R5KSB7XG4gICAgY29uc3QgZGFwcEVkMjU1MTlTZWNyZXRLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5kYXBwRWQyNTUxOVNlY3JldEtleUI2NCk7XG4gICAgY29uc3QgZGFwcEVkMjU1MTlQdWJsaWNLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5kYXBwRWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgY29uc3QgYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5hY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgbGV0IHNlcXVlbmNlTnVtYmVyID0gcGFpcmluZy5jdXJyU2VxdWVuY2VOdW1iZXIgKyAxO1xuICAgIHJldHVybiB3aXRoUmV0cmllcyhcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdEVudmVsb3BlID0gYXdhaXQgZW5jcnlwdEFuZFNpZ25FbnZlbG9wZShcbiAgICAgICAgICB0b0tleShkYXBwRWQyNTUxOVNlY3JldEtleSwgS2V5VHlwZXMuRWQyNTUxOVNlY3JldEtleSksXG4gICAgICAgICAgdG9LZXkoZGFwcEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgICAgIHRvS2V5KGFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KSxcbiAgICAgICAgICBzZXF1ZW5jZU51bWJlcixcbiAgICAgICAgICB7IGFwaVZlcnNpb246IEFQSV9WRVJTSU9OLCBuZXR3b3JrTmFtZSwgcmVxdWVzdFR5cGU6IHR5cGUgfSxcbiAgICAgICAgICByZXF1ZXN0Qm9keVxuICAgICAgICApO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXhpb3NJbnN0YW5jZS5wb3N0KFxuICAgICAgICAgIGB2MS9wYWlyaW5nLyR7cGFpcmluZy5wYWlyaW5nSWR9L3NpZ25pbmctcmVxdWVzdC9gLFxuICAgICAgICAgIHJlcXVlc3RFbnZlbG9wZVxuICAgICAgICApO1xuICAgICAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUocGFpcmluZy5hY2NvdW50QWRkcmVzcywge1xuICAgICAgICAgIC4uLnBhaXJpbmcsXG4gICAgICAgICAgY3VyclNlcXVlbmNlTnVtYmVyOiBzZXF1ZW5jZU51bWJlclxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuZGF0YS5zaWduaW5nUmVxdWVzdDtcbiAgICAgIH0sXG4gICAgICAoZXJyKSA9PiB7XG4gICAgICAgIGlmIChpc0F4aW9zRXJyb3IoZXJyKSkge1xuICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyci5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZTtcbiAgICAgICAgICBjb25zdCBleHBlY3RlZFNlcXVlbmNlTnVtYmVyID0gZXJyb3JNZXNzYWdlPy5tYXRjaChTRVFVRU5DRV9OVU1CRVJfTUlTTUFUQ0hfUEFUVEVSTik/LlsxXTtcbiAgICAgICAgICBpZiAoZXhwZWN0ZWRTZXF1ZW5jZU51bWJlciAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlciA9IE51bWJlcihleHBlY3RlZFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgICk7XG4gIH1cbiAgYXN5bmMgZ2V0U2lnbmluZ1JlcXVlc3QoaWQpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXhpb3NJbnN0YW5jZS5nZXQoXG4gICAgICBgdjEvc2lnbmluZy1yZXF1ZXN0LyR7aWR9L2AsXG4gICAgICB7XG4gICAgICAgIHZhbGlkYXRlU3RhdHVzOiAoc3RhdHVzKSA9PiBzdGF0dXMgPT09IDIwMCB8fCBzdGF0dXMgPT09IDQwNFxuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE/LmRhdGE/LnNpZ25pbmdSZXF1ZXN0O1xuICB9XG4gIGFzeW5jIGRlbGV0ZVBhaXJpbmcocGFpcmluZ0lkLCBzZWNyZXRLZXksIHB1YmxpY0tleSkge1xuICAgIGNvbnN0IHJlcXVlc3RFbnZlbG9wZSA9IGF3YWl0IGVuY3J5cHRBbmRTaWduRW52ZWxvcGUoXG4gICAgICBzZWNyZXRLZXksXG4gICAgICBwdWJsaWNLZXksXG4gICAgICBwdWJsaWNLZXksXG4gICAgICAwLFxuICAgICAgLy8gaWdub3JlZFxuICAgICAge30sXG4gICAgICB7fVxuICAgICk7XG4gICAgYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBvc3QoXG4gICAgICBgdjEvcGFpcmluZy8ke3BhaXJpbmdJZH0vZGVsZXRlL2AsXG4gICAgICByZXF1ZXN0RW52ZWxvcGUsXG4gICAgICB7IHZhbGlkYXRlU3RhdHVzOiAoc3RhdHVzKSA9PiBzdGF0dXMgPT09IDIwNCB8fCBzdGF0dXMgPT09IDQwNCB9XG4gICAgKTtcbiAgfVxuICBhc3luYyBjYW5jZWxTaWduaW5nUmVxdWVzdChwYWlyaW5nLCBpZCkge1xuICAgIGNvbnN0IHNlcXVlbmNlTnVtYmVyID0gcGFpcmluZy5jdXJyU2VxdWVuY2VOdW1iZXI7XG4gICAgY29uc3QgZGFwcEVkMjU1MTlTZWNyZXRLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5kYXBwRWQyNTUxOVNlY3JldEtleUI2NCk7XG4gICAgY29uc3QgZGFwcEVkMjU1MTlQdWJsaWNLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5kYXBwRWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgY29uc3QgYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXkgPSBkZWNvZGVCYXNlNjQocGFpcmluZy5hY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgY29uc3QgcmVxdWVzdEVudmVsb3BlID0gYXdhaXQgZW5jcnlwdEFuZFNpZ25FbnZlbG9wZShcbiAgICAgIHRvS2V5KGRhcHBFZDI1NTE5U2VjcmV0S2V5LCBLZXlUeXBlcy5FZDI1NTE5U2VjcmV0S2V5KSxcbiAgICAgIHRvS2V5KGRhcHBFZDI1NTE5UHVibGljS2V5LCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KSxcbiAgICAgIHRvS2V5KGFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KSxcbiAgICAgIHNlcXVlbmNlTnVtYmVyICsgMSxcbiAgICAgIHt9LFxuICAgICAge31cbiAgICApO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBhdGNoKFxuICAgICAgYHYxL3NpZ25pbmctcmVxdWVzdC8ke2lkfS9jYW5jZWwvYCxcbiAgICAgIHJlcXVlc3RFbnZlbG9wZVxuICAgICk7XG4gICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKHBhaXJpbmcuYWNjb3VudEFkZHJlc3MsIHtcbiAgICAgIC4uLnBhaXJpbmcsXG4gICAgICBjdXJyU2VxdWVuY2VOdW1iZXI6IHNlcXVlbmNlTnVtYmVyICsgMVxuICAgIH0pO1xuICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGEuc2lnbmluZ1JlcXVlc3Q7XG4gIH1cbiAgYXN5bmMgc2lnblJlcXVlc3QoYWRkcmVzcywgdHlwZSwgcmVxdWVzdEJvZHksIHsgY2FuY2VsVG9rZW4sIG5ldHdvcmtOYW1lIH0gPSB7fSkge1xuICAgIGF3YWl0IHRoaXMuaW5pdFByb21pc2U7XG4gICAgY29uc3QgcGFpcmluZyA9IGF3YWl0IHRoaXMuYWNjZXNzb3JzLmdldChhZGRyZXNzKTtcbiAgICBpZiAocGFpcmluZyA9PT0gdm9pZCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgcmVxdWVzdGVkIGFjY291bnQgaXMgbm90IHBhaXJlZFwiKTtcbiAgICB9XG4gICAgbGV0IHNpZ25pbmdSZXF1ZXN0O1xuICAgIHRyeSB7XG4gICAgICBzaWduaW5nUmVxdWVzdCA9IGF3YWl0IHRoaXMuY3JlYXRlU2lnbmluZ1JlcXVlc3QoXG4gICAgICAgIHBhaXJpbmcsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIG5ldHdvcmtOYW1lIHx8IHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lLFxuICAgICAgICByZXF1ZXN0Qm9keVxuICAgICAgKTtcbiAgICAgIHdoaWxlIChzaWduaW5nUmVxdWVzdC5zdGF0dXMgPT09IFwiUEVORElOR1wiKSB7XG4gICAgICAgIGF3YWl0IHdhaXRGb3IoU0lHTklOR19SRVFVRVNUX1BPTExJTkdfSU5URVJWQUwpO1xuICAgICAgICBpZiAoY2FuY2VsVG9rZW4/LmNhbmNlbGxlZCkge1xuICAgICAgICAgIHNpZ25pbmdSZXF1ZXN0LnN0YXR1cyA9IFNpZ25pbmdSZXF1ZXN0U3RhdHVzLkNBTkNFTExFRDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBzaWduaW5nUmVxdWVzdCA9IGF3YWl0IHRoaXMuZ2V0U2lnbmluZ1JlcXVlc3Qoc2lnbmluZ1JlcXVlc3QuaWQpID8/IHNpZ25pbmdSZXF1ZXN0O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGlzQXhpb3NFcnJvcihlcnIpICYmIGVyci5jb2RlID09PSBcIjQwNFwiKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuYWNjZXNzb3JzLnVwZGF0ZShhZGRyZXNzLCB2b2lkIDApO1xuICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIHRoaXMub25EaXNjb25uZWN0TGlzdGVuZXJzKSB7XG4gICAgICAgICAgbGlzdGVuZXIoYWRkcmVzcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IFBhaXJpbmdFeHBpcmVkRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gICAgaWYgKHNpZ25pbmdSZXF1ZXN0LnN0YXR1cyAhPT0gXCJBUFBST1ZFRFwiKSB7XG4gICAgICB0aHJvdyBuZXcgU2lnbmF0dXJlUmVxdWVzdEVycm9yKHNpZ25pbmdSZXF1ZXN0LnN0YXR1cyk7XG4gICAgfVxuICAgIGNvbnN0IGRlY3J5cHRlZCA9IGRlY3J5cHRFbnZlbG9wZShcbiAgICAgIHRvS2V5KGRlY29kZUJhc2U2NChwYWlyaW5nLmFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0KSwgS2V5VHlwZXMuRWQyNTUxOVB1YmxpY0tleSksXG4gICAgICB0b0tleShkZWNvZGVCYXNlNjQocGFpcmluZy5kYXBwRWQyNTUxOVNlY3JldEtleUI2NCksIEtleVR5cGVzLkVkMjU1MTlTZWNyZXRLZXkpLFxuICAgICAgc2lnbmluZ1JlcXVlc3QucmVzcG9uc2VFbnZlbG9wZVxuICAgICk7XG4gICAgcmV0dXJuIGRlY3J5cHRlZC5wcml2YXRlTWVzc2FnZTtcbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICAvKipcbiAgICogUmVxdWVzdHMgYSBjb25uZWN0aW9uIHRvIGFuIGFjY291bnQgKGludGVybmFsbHkga25vd24gYXMgcGFpcmluZykuXG4gICAqIEByZXR1cm5zIGVpdGhlciB0aGUgYWRkcmVzcyBvZiB0aGUgY29ubmVjdGVkIGFjY291bnQsIG9yIHVuZGVmaW5lZCBpZiB0aGVcbiAgICogY29ubmVjdGlvbiB3YXMgY2FuY2VsbGVkLlxuICAgKi9cbiAgYXN5bmMgYWRkUGFpcmluZyh7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH0sIGZpbmFsaXplZFBhaXJpbmcpIHtcbiAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoZmluYWxpemVkUGFpcmluZy5hY2NvdW50LmFjY291bnRBZGRyZXNzLCB7XG4gICAgICBhY2NvdW50QWRkcmVzczogZmluYWxpemVkUGFpcmluZy5hY2NvdW50LmFjY291bnRBZGRyZXNzLFxuICAgICAgYWNjb3VudEFsaWFzOiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQudXNlclN1Ym1pdHRlZEFsaWFzID8/IHZvaWQgMCxcbiAgICAgIGFjY291bnRQdWJsaWNLZXlCNjQ6IGZpbmFsaXplZFBhaXJpbmcuYWNjb3VudC5wdWJsaWNLZXlCNjQsXG4gICAgICBhY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleUI2NDogZmluYWxpemVkUGFpcmluZy5hY2NvdW50LnRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQsXG4gICAgICBjdXJyU2VxdWVuY2VOdW1iZXI6IGZpbmFsaXplZFBhaXJpbmcubWF4RGFwcFNlcXVlbmNlTnVtYmVyLFxuICAgICAgZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NChwdWJsaWNLZXkua2V5KSxcbiAgICAgIGRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0OiBlbmNvZGVCYXNlNjQoc2VjcmV0S2V5LmtleSksXG4gICAgICBkYXBwV2FsbGV0SWQ6IGZpbmFsaXplZFBhaXJpbmcuZGFwcFNwZWNpZmljV2FsbGV0SWQsXG4gICAgICBwYWlyaW5nSWQ6IGZpbmFsaXplZFBhaXJpbmcuaWRcbiAgICB9KTtcbiAgfVxuICBhc3luYyBkaXNjb25uZWN0KGFkZHJlc3MpIHtcbiAgICBjb25zdCBwYWlyaW5nID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0KGFkZHJlc3MpO1xuICAgIGlmIChwYWlyaW5nID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBzcGVjaWZpZWQgYWNjb3VudCBpcyBub3QgcGFpcmVkXCIpO1xuICAgIH1cbiAgICBjb25zdCBkYXBwRWQyNTUxOVNlY3JldEtleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBhd2FpdCB0aGlzLmRlbGV0ZVBhaXJpbmcoXG4gICAgICBwYWlyaW5nLnBhaXJpbmdJZCxcbiAgICAgIHRvS2V5KGRhcHBFZDI1NTE5U2VjcmV0S2V5LCBLZXlUeXBlcy5FZDI1NTE5U2VjcmV0S2V5KSxcbiAgICAgIHRvS2V5KGRhcHBFZDI1NTE5UHVibGljS2V5LCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KVxuICAgICk7XG4gICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKGFkZHJlc3MsIHZvaWQgMCk7XG4gICAgZm9yIChjb25zdCBsaXN0ZW5lciBvZiB0aGlzLm9uRGlzY29ubmVjdExpc3RlbmVycykge1xuICAgICAgbGlzdGVuZXIoYWRkcmVzcyk7XG4gICAgfVxuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKGFkZHJlc3MsIGFyZ3MsIG9wdGlvbnMpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc2lnblJlcXVlc3QoXG4gICAgICBhZGRyZXNzLFxuICAgICAgU2lnbmluZ1JlcXVlc3RUeXBlcy5TSUdOX01FU1NBR0UsXG4gICAgICBhcmdzLFxuICAgICAgb3B0aW9uc1xuICAgICk7XG4gICAgdmFsaWRhdGVTaWduTWVzc2FnZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKGFkZHJlc3MsIGFyZ3MsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdEFyZ3MgPSBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyhhcmdzKTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2VBcmdzID0gYXdhaXQgdGhpcy5zaWduUmVxdWVzdChhZGRyZXNzLCBTaWduaW5nUmVxdWVzdFR5cGVzLlNJR05fVFJBTlNBQ1RJT04sIHNlcmlhbGl6ZWRSZXF1ZXN0QXJncywgb3B0aW9ucyk7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVzcG9uc2VBcmdzKHNlcmlhbGl6ZWRSZXNwb25zZUFyZ3MpO1xuICB9XG4gIC8vIGVuZHJlZ2lvblxuICBhc3luYyBzaWduQW5kU3VibWl0VHJhbnNhY3Rpb24oYWRkcmVzcywgYXJncywgb3B0aW9ucykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0QXJncyA9IHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZUFyZ3MgPSBhd2FpdCB0aGlzLnNpZ25SZXF1ZXN0KGFkZHJlc3MsIFNpZ25pbmdSZXF1ZXN0VHlwZXMuU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OLCBzZXJpYWxpemVkUmVxdWVzdEFyZ3MsIG9wdGlvbnMpO1xuICAgICAgdmFsaWRhdGVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZShyZXNwb25zZUFyZ3MpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlQXJncztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEF4aW9zRXJyb3IgJiYgZS5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZS5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgfVxuICBhc3luYyBnZXRDb25uZWN0ZWRBY2NvdW50cygpIHtcbiAgICBhd2FpdCB0aGlzLmluaXRQcm9taXNlO1xuICAgIGNvbnN0IHBhaXJpbmdzID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0QWxsKCk7XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocGFpcmluZ3MpLm1hcChcbiAgICAgICh7IGFjY291bnRBZGRyZXNzLCBhY2NvdW50RWQyNTUxOVB1YmxpY0tleUI2NCwgYWNjb3VudFB1YmxpY0tleUI2NCB9KSA9PiAoe1xuICAgICAgICBhZGRyZXNzOiBBY2NvdW50QWRkcmVzczIuZnJvbShhY2NvdW50QWRkcmVzcyksXG4gICAgICAgIHB1YmxpY0tleTogYWNjb3VudFB1YmxpY0tleUI2NCAhPT0gdm9pZCAwID8gZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQoYWNjb3VudFB1YmxpY0tleUI2NCkgOiBkZXNlcmlhbGl6ZUVkMjU1MTlQdWJsaWNLZXlCNjQoYWNjb3VudEVkMjU1MTlQdWJsaWNLZXlCNjQpXG4gICAgICB9KVxuICAgICk7XG4gIH1cbiAgb25EaXNjb25uZWN0KGxpc3RlbmVyKSB7XG4gICAgdGhpcy5vbkRpc2Nvbm5lY3RMaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcbiAgICByZXR1cm4gKCkgPT4gdGhpcy5vbkRpc2Nvbm5lY3RMaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgfVxufTtcblxuLy8gc3JjL0FDRGFwcENsaWVudC50c1xudmFyIEFDRGFwcENsaWVudCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGJhY2tlbmRCYXNlVVJMLFxuICAgIGRhcHBJZCxcbiAgICBkYXBwSW1hZ2VVUkksXG4gICAgZGFwcE5hbWUsXG4gICAgZGVmYXVsdE5ldHdvcmtOYW1lID0gTmV0d29ya05hbWUyLk1BSU5ORVQsXG4gICAgZnJvbnRlbmRCYXNlVVJMID0gREVGQVVMVF9GUk9OVEVORF9VUkwsXG4gICAgcHJvdmlkZXIgPSBcImdvb2dsZVwiLFxuICAgIHRnV2ViQXBwVVJMXG4gIH0gPSB7fSkge1xuICAgIHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lID0gZGVmYXVsdE5ldHdvcmtOYW1lO1xuICAgIHRoaXMuZGFwcEluZm8gPSB7XG4gICAgICBkb21haW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sXG4gICAgICBpbWFnZVVSSTogZGFwcEltYWdlVVJJLFxuICAgICAgbmFtZTogZGFwcE5hbWUgPz8gZG9jdW1lbnQudGl0bGVcbiAgICB9O1xuICAgIHRoaXMudHJhbnNwb3J0ID0gbmV3IFdlYldhbGxldFRyYW5zcG9ydChmcm9udGVuZEJhc2VVUkwsIHByb3ZpZGVyLCB0Z1dlYkFwcFVSTCk7XG4gICAgdGhpcy5kYXBwSWQgPSBkYXBwSWQ7XG4gICAgdGhpcy5wYWlyaW5nQ2xpZW50ID0gbmV3IEFDUGFpcmluZ0NsaWVudCh7XG4gICAgICBheGlvc0NvbmZpZzoge1xuICAgICAgICBiYXNlVVJMOiBiYWNrZW5kQmFzZVVSTCA/PyBmcm9udGVuZEJhc2VVUkxcbiAgICAgIH0sXG4gICAgICBkZWZhdWx0TmV0d29ya05hbWVcbiAgICB9KTtcbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICBhc3luYyBnZXRLZXlsZXNzQWNjb3VudHMoKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8pO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBnZXRJY0FjY291bnRzKCkge1xuICAgIHJldHVybiB0aGlzLnBhaXJpbmdDbGllbnQuZ2V0Q29ubmVjdGVkQWNjb3VudHMoKSA/PyBbXTtcbiAgfVxuICBhc3luYyBpc0ljQWNjb3VudChhZGRyZXNzKSB7XG4gICAgY29uc3QgaWNBY2NvdW50cyA9IGF3YWl0IHRoaXMuZ2V0SWNBY2NvdW50cygpO1xuICAgIHJldHVybiBpY0FjY291bnRzLmZpbmQoKGFjY291bnQpID0+IGFjY291bnQuYWRkcmVzcy5lcXVhbHMoQWNjb3VudEFkZHJlc3MzLmZyb20oYWRkcmVzcykpKSAhPT0gdm9pZCAwO1xuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGNvbnN0IGtleWxlc3NBY2NvdW50cyA9IGF3YWl0IHRoaXMuZ2V0S2V5bGVzc0FjY291bnRzKCk7XG4gICAgY29uc3QgaWNBY2NvdW50cyA9IGF3YWl0IHRoaXMuZ2V0SWNBY2NvdW50cygpO1xuICAgIHJldHVybiBbLi4ua2V5bGVzc0FjY291bnRzLCAuLi5pY0FjY291bnRzXTtcbiAgfVxuICBhc3luYyBkaXNjb25uZWN0KGFkZHJlc3MpIHtcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0ljQWNjb3VudChhZGRyZXNzKSkge1xuICAgICAgY29uc3Qgc3RyaW5nQWRkcmVzcyA9IEFjY291bnRBZGRyZXNzMy5mcm9tKGFkZHJlc3MpLnRvU3RyaW5nKCk7XG4gICAgICBhd2FpdCB0aGlzLnBhaXJpbmdDbGllbnQuZGlzY29ubmVjdChzdHJpbmdBZGRyZXNzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBEaXNjb25uZWN0UmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgICBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gICAgfVxuICB9XG4gIGFzeW5jIGNvbm5lY3Qoe1xuICAgIGNsYWltT3B0aW9ucyxcbiAgICBwcmVmZXJyZWRXYWxsZXROYW1lXG4gIH0gPSB7fSkge1xuICAgIGNvbnN0IGRhcHBLZXlwYWlyID0gY3JlYXRlRWQyNTUxOUtleVBhaXIoKTtcbiAgICBjb25zdCBpbmplY3RlZFByZWZlcnJlZFdhbGxldE5hbWUgPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93LkFDX1BSRUZFUlJFRF9XQUxMRVRfTkFNRSA6IHZvaWQgMDtcbiAgICBjb25zdCByZXF1ZXN0QXJncyA9IHtcbiAgICAgIGNsYWltT3B0aW9ucyxcbiAgICAgIGRhcHBFZDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQyKGRhcHBLZXlwYWlyLnB1YmxpY0tleS5rZXkpLFxuICAgICAgZGFwcElkOiB0aGlzLmRhcHBJZCxcbiAgICAgIHByZWZlcnJlZFdhbGxldE5hbWU6IHByZWZlcnJlZFdhbGxldE5hbWUgPz8gaW5qZWN0ZWRQcmVmZXJyZWRXYWxsZXROYW1lXG4gICAgfTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IENvbm5lY3RSZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvLCByZXF1ZXN0QXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgaWYgKHJlc3BvbnNlLmFyZ3Muc3RhdHVzID09PSBcImFwcHJvdmVkXCIpIHtcbiAgICAgIGNvbnN0IHsgYWNjb3VudCwgcGFpcmluZyB9ID0gcmVzcG9uc2UuYXJncy5hcmdzO1xuICAgICAgaWYgKHBhaXJpbmcpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wYWlyaW5nQ2xpZW50LmFkZFBhaXJpbmcoZGFwcEtleXBhaXIsIHBhaXJpbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ha2VVc2VyQXBwcm92YWwoeyBhY2NvdW50IH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBzaWduSW4oYXJncykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gU2lnbkluUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkluUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBzaWduTWVzc2FnZShhcmdzKSB7XG4gICAgY29uc3QgeyBzaWduZXJBZGRyZXNzIH0gPSBhcmdzO1xuICAgIGlmIChhd2FpdCB0aGlzLmlzSWNBY2NvdW50KHNpZ25lckFkZHJlc3MpKSB7XG4gICAgICBjb25zdCB7IGNoYWluSWQgfSA9IGFyZ3M7XG4gICAgICBjb25zdCBuZXR3b3JrID0gY2hhaW5JZFRvTmV0d29yayhjaGFpbklkKTtcbiAgICAgIGxldCBtZXNzYWdlO1xuICAgICAgbGV0IG5vbmNlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgbWVzc2FnZSA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShhcmdzLm1lc3NhZ2UpO1xuICAgICAgICBub25jZSA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShhcmdzLm5vbmNlKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IFVURi04IGVuY29kZWQgdGV4dCBpcyBzdXBwb3J0ZWQgd2hlbiB1c2luZyBJQ1wiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZnVsbE1lc3NhZ2UsIHNpZ25hdHVyZTogaGV4U2lnbmF0dXJlIH0gPSBhd2FpdCB0aGlzLnBhaXJpbmdDbGllbnQuc2lnbk1lc3NhZ2UoXG4gICAgICAgIHNpZ25lckFkZHJlc3MudG9TdHJpbmcoKSxcbiAgICAgICAge1xuICAgICAgICAgIGFkZHJlc3M6IHRydWUsXG4gICAgICAgICAgYXBwbGljYXRpb246IHRydWUsXG4gICAgICAgICAgY2hhaW5JZDogdHJ1ZSxcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIG5vbmNlXG4gICAgICAgIH0sXG4gICAgICAgIHsgbmV0d29ya05hbWU6IG5ldHdvcmsgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZUJ5dGVzID0gSGV4LmZyb21IZXhJbnB1dChoZXhTaWduYXR1cmUpLnRvVWludDhBcnJheSgpO1xuICAgICAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbmF0dXJlQnl0ZXMubGVuZ3RoID09PSBFZDI1NTE5U2lnbmF0dXJlLkxFTkdUSCA/IG5ldyBFZDI1NTE5U2lnbmF0dXJlKHNpZ25hdHVyZUJ5dGVzKSA6IEFueVNpZ25hdHVyZS5kZXNlcmlhbGl6ZShuZXcgRGVzZXJpYWxpemVyKHNpZ25hdHVyZUJ5dGVzKSk7XG4gICAgICByZXR1cm4gbWFrZVVzZXJBcHByb3ZhbCh7XG4gICAgICAgIGZ1bGxNZXNzYWdlLFxuICAgICAgICBzaWduYXR1cmVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25NZXNzYWdlUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbk1lc3NhZ2VSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25UcmFuc2FjdGlvbihhcmdzKSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZEFyZ3MgPSBcInRyYW5zYWN0aW9uXCIgaW4gYXJncyA/IFNpZ25UcmFuc2FjdGlvblJlcXVlc3Qubm9ybWFsaXplQXJncyhhcmdzKSA6IGFyZ3M7XG4gICAgY29uc3QgeyBzaWduZXJBZGRyZXNzIH0gPSBhcmdzO1xuICAgIGlmIChhd2FpdCB0aGlzLmlzSWNBY2NvdW50KHNpZ25lckFkZHJlc3MpKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyxcbiAgICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcCxcbiAgICAgICAgZmVlUGF5ZXIsXG4gICAgICAgIGdhc1VuaXRQcmljZSxcbiAgICAgICAgbWF4R2FzQW1vdW50LFxuICAgICAgICBuZXR3b3JrLFxuICAgICAgICBwYXlsb2FkLFxuICAgICAgICBzZWNvbmRhcnlTaWduZXJzLFxuICAgICAgICBzZW5kZXIsXG4gICAgICAgIHNlcXVlbmNlTnVtYmVyXG4gICAgICB9ID0gbm9ybWFsaXplZEFyZ3M7XG4gICAgICBpZiAoZmVlUGF5ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTcG9uc29yZWQgdHJhbnNhY3Rpb24gbm90IGN1cnJlbnRseSBzdXBwb3J0ZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoc2Vjb25kYXJ5U2lnbmVycyAmJiBzZWNvbmRhcnlTaWduZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGktYWdlbnQgdHJhbnNhY3Rpb25zIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCEoXCJiY3NUb0J5dGVzXCIgaW4gcGF5bG9hZCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGF5bG9hZCBpbnB1dCBmb3JtYXQgaXMgb25seSBzdXBwb3J0ZWQgd2l0aCBLZXlsZXNzIGFjY291bnRzLlwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3BvbnNlQXJncyA9IGF3YWl0IHRoaXMucGFpcmluZ0NsaWVudC5zaWduVHJhbnNhY3Rpb24oXG4gICAgICAgIHNpZ25lckFkZHJlc3MudG9TdHJpbmcoKSxcbiAgICAgICAge1xuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyxcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXAsXG4gICAgICAgICAgICBnYXNVbml0UHJpY2UsXG4gICAgICAgICAgICBtYXhHYXNBbW91bnQsXG4gICAgICAgICAgICBzZW5kZXI6IHNlbmRlcj8uYWRkcmVzcy50b1N0cmluZygpLFxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IHNlcXVlbmNlTnVtYmVyICE9PSB2b2lkIDAgPyBOdW1iZXIoc2VxdWVuY2VOdW1iZXIpIDogdm9pZCAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXlsb2FkXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuZXR3b3JrTmFtZTogbmV0d29ya1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIG1ha2VVc2VyQXBwcm92YWwoe1xuICAgICAgICBhdXRoZW50aWNhdG9yOiByZXNwb25zZUFyZ3MuYWNjb3VudEF1dGhlbnRpY2F0b3IsXG4gICAgICAgIHJhd1RyYW5zYWN0aW9uOiByZXNwb25zZUFyZ3MucmF3VHhuXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvLCBub3JtYWxpemVkQXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBzaWduQW5kU3VibWl0VHJhbnNhY3Rpb24oYXJncykge1xuICAgIGNvbnN0IHsgc2lnbmVyQWRkcmVzcyB9ID0gYXJncztcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0ljQWNjb3VudChzaWduZXJBZGRyZXNzKSkge1xuICAgICAgY29uc3QgeyBleHBpcmF0aW9uVGltZXN0YW1wLCBmZWVQYXllciwgZ2FzVW5pdFByaWNlLCBtYXhHYXNBbW91bnQsIG5ldHdvcmsgfSA9IGFyZ3M7XG4gICAgICBjb25zdCBhcHRvc0NvbmZpZyA9IG5ldyBBcHRvc0NvbmZpZzIoeyBuZXR3b3JrIH0pO1xuICAgICAgbGV0IGNvbnZlcnRlZEFyZ3M7XG4gICAgICBpZiAoZmVlUGF5ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gYXdhaXQgbm9ybWFsaXplUGF5bG9hZEZvcklDKGFyZ3MucGF5bG9hZCwgYXB0b3NDb25maWcpO1xuICAgICAgICBjb25zdCByYXdUeG4gPSBhd2FpdCBnZW5lcmF0ZVJhd1RyYW5zYWN0aW9uKHtcbiAgICAgICAgICBhcHRvc0NvbmZpZyxcbiAgICAgICAgICBmZWVQYXllckFkZHJlc3M6IGZlZVBheWVyLmFkZHJlc3MsXG4gICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgZ2FzVW5pdFByaWNlLFxuICAgICAgICAgICAgbWF4R2FzQW1vdW50XG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgIHNlbmRlcjogc2lnbmVyQWRkcmVzc1xuICAgICAgICB9KTtcbiAgICAgICAgY29udmVydGVkQXJncyA9IHtcbiAgICAgICAgICBmZWVQYXllckF1dGhlbnRpY2F0b3I6IGZlZVBheWVyLmF1dGhlbnRpY2F0b3IsXG4gICAgICAgICAgcmF3VHhuOiBuZXcgRmVlUGF5ZXJSYXdUcmFuc2FjdGlvbihyYXdUeG4sIFtdLCBmZWVQYXllci5hZGRyZXNzKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IG5vcm1hbGl6ZVBheWxvYWRGb3JJQyhhcmdzLnBheWxvYWQpO1xuICAgICAgICBjb252ZXJ0ZWRBcmdzID0ge1xuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXAsXG4gICAgICAgICAgICBnYXNVbml0UHJpY2UsXG4gICAgICAgICAgICBtYXhHYXNBbW91bnRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBheWxvYWRcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgaGFzaCB9ID0gYXdhaXQgdGhpcy5wYWlyaW5nQ2xpZW50LnNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihzaWduZXJBZGRyZXNzLnRvU3RyaW5nKCksIGNvbnZlcnRlZEFyZ3MsIHtcbiAgICAgICAgbmV0d29ya05hbWU6IG5ldHdvcmtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG1ha2VVc2VyQXBwcm92YWwoeyB0eG5IYXNoOiBoYXNoIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuXG4vLyBzcmMvSUNEYXBwQ2xpZW50LnRzXG5pbXBvcnQgeyBjcmVhdGVFZDI1NTE5S2V5UGFpciBhcyBjcmVhdGVFZDI1NTE5S2V5UGFpcjIsIGVuY29kZUJhc2U2NCBhcyBlbmNvZGVCYXNlNjQzIH0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L2NyeXB0b1wiO1xuaW1wb3J0IHsgaXNBeGlvc0Vycm9yIGFzIGlzQXhpb3NFcnJvcjIgfSBmcm9tIFwiYXhpb3NcIjtcblxuLy8gc3JjL3Byb21wdC50c1xudmFyIERFRkFVTFRfUFJPTVBUX1NJWkUgPSB7IGhlaWdodDogNjk1LCB3aWR0aDogNDY1IH07XG52YXIgUFJPTVBUX1BPTExFUl9JTlRFUlZBTCA9IDUwMDtcbmZ1bmN0aW9uIG9wZW5Qcm9tcHQodXJsLCBzaXplID0gREVGQVVMVF9QUk9NUFRfU0laRSkge1xuICBjb25zdCB7IGhlaWdodCwgd2lkdGggfSA9IHNpemU7XG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgaGVpZ2h0LFxuICAgIGxlZnQ6IHdpbmRvdy5zY3JlZW5MZWZ0ICsgTWF0aC5yb3VuZCgod2luZG93Lm91dGVyV2lkdGggLSB3aWR0aCkgLyAyKSxcbiAgICBwb3B1cDogdHJ1ZSxcbiAgICB0b3A6IHdpbmRvdy5zY3JlZW5Ub3AgKyBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJIZWlnaHQgLSBoZWlnaHQpIC8gMiksXG4gICAgd2lkdGhcbiAgfTtcbiAgY29uc3Qgc3RyT3B0aW9ucyA9IE9iamVjdC5lbnRyaWVzKG9wdGlvbnMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBgJHtrZXl9PSR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfWApLnJlZHVjZSgoYWNjLCBlbnRyeSkgPT4gYCR7YWNjfSwgJHtlbnRyeX1gKTtcbiAgY29uc3QgaHJlZiA9IHVybCBpbnN0YW5jZW9mIFVSTCA/IHVybC5ocmVmIDogdXJsO1xuICBjb25zdCBwcm9tcHRXaW5kb3cgPSB3aW5kb3cub3BlbihocmVmLCB2b2lkIDAsIHN0ck9wdGlvbnMpO1xuICBpZiAocHJvbXB0V2luZG93ID09PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3Qgb3BlbiBwcm9tcHRcIik7XG4gIH1cbiAgcmV0dXJuIHByb21wdFdpbmRvdztcbn1cbmFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JQcm9tcHRSZXNwb25zZShwcm9tcHRXaW5kb3cpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgY29uc3QgbGlzdGVuZXJzID0ge1xuICAgICAgb25NZXNzYWdlOiAobWVzc2FnZSkgPT4ge1xuICAgICAgICBpZiAobWVzc2FnZS5zb3VyY2UgIT09IHByb21wdFdpbmRvdykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXJzLm9uTWVzc2FnZSk7XG4gICAgICAgIGNsZWFyVGltZW91dChsaXN0ZW5lcnMucHJvbXB0UG9sbGVySWQpO1xuICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICBhcmdzOiBtZXNzYWdlLmRhdGEsXG4gICAgICAgICAgc3RhdHVzOiBcImFwcHJvdmVkXCJcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgcHJvbXB0UG9sbGVySWQ6IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHByb21wdFdpbmRvdy5jbG9zZWQpIHtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXJzLm9uTWVzc2FnZSk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGxpc3RlbmVycy5wcm9tcHRQb2xsZXJJZCk7XG4gICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICBzdGF0dXM6IFwiZGlzbWlzc2VkXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgUFJPTVBUX1BPTExFUl9JTlRFUlZBTClcbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgfSk7XG59XG5cbi8vIHNyYy9JQ0RhcHBDbGllbnQudHNcbnZhciBJQ0RhcHBDbGllbnQgPSBjbGFzcyBleHRlbmRzIEFDUGFpcmluZ0NsaWVudCB7XG4gIGNvbnN0cnVjdG9yKGRhcHBJZCwgeyBmcm9udGVuZEJhc2VVUkwgPSBERUZBVUxUX0ZST05URU5EX1VSTCwgLi4ucGFpcmluZ0NsaWVudENvbmZpZyB9ID0ge30pIHtcbiAgICBzdXBlcihwYWlyaW5nQ2xpZW50Q29uZmlnKTtcbiAgICB0aGlzLmRhcHBJZCA9IGRhcHBJZDtcbiAgICB0aGlzLmZyb250ZW5kQmFzZVVSTCA9IGZyb250ZW5kQmFzZVVSTDtcbiAgfVxuICBhc3luYyBjcmVhdGVQYWlyaW5nUmVxdWVzdChkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXhpb3NJbnN0YW5jZS5wb3N0KFwidjEvcGFpcmluZy9cIiwge1xuICAgICAgICBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgICAgICAgZGFwcElkOiB0aGlzLmRhcHBJZFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhLnBhaXJpbmc7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoaXNBeGlvc0Vycm9yMihlcnIpICYmIGVyci5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSA9PT0gXCJEYXBwIG5vdCBmb3VuZFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBVbnJlZ2lzdGVyZWREYXBwRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cbiAgLy8gcmVnaW9uIFB1YmxpYyBBUElcbiAgLyoqXG4gICAqIFJlcXVlc3RzIGEgY29ubmVjdGlvbiB0byBhbiBhY2NvdW50IChpbnRlcm5hbGx5IGtub3duIGFzIHBhaXJpbmcpLlxuICAgKiBAcmV0dXJucyBlaXRoZXIgdGhlIGFkZHJlc3Mgb2YgdGhlIGNvbm5lY3RlZCBhY2NvdW50LCBvciB1bmRlZmluZWQgaWYgdGhlXG4gICAqIGNvbm5lY3Rpb24gd2FzIGNhbmNlbGxlZC5cbiAgICovXG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgY29uc3QgeyBwdWJsaWNLZXksIHNlY3JldEtleSB9ID0gY3JlYXRlRWQyNTUxOUtleVBhaXIyKCk7XG4gICAgY29uc3QgZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQgPSBlbmNvZGVCYXNlNjQzKHB1YmxpY0tleS5rZXkpO1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5mcm9udGVuZEJhc2VVUkx9L3BhaXJpbmdgKTtcbiAgICBjb25zdCBwcm9tcHRXaW5kb3cgPSBhd2FpdCBvcGVuUHJvbXB0KHVybC5ocmVmKTtcbiAgICBsZXQgcGFpcmluZ0lkO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwZW5kaW5nUGFpcmluZyA9IGF3YWl0IHRoaXMuY3JlYXRlUGFpcmluZ1JlcXVlc3QoZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICAgICAgcGFpcmluZ0lkID0gcGVuZGluZ1BhaXJpbmcuaWQ7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBwcm9tcHRXaW5kb3cuY2xvc2UoKTtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJwYWlyaW5nSWRcIiwgcGFpcmluZ0lkKTtcbiAgICBwcm9tcHRXaW5kb3cubG9jYXRpb24uaHJlZiA9IHVybC5ocmVmO1xuICAgIGNvbnN0IHByb21wdFJlc3BvbnNlID0gYXdhaXQgd2FpdEZvclByb21wdFJlc3BvbnNlKHByb21wdFdpbmRvdyk7XG4gICAgaWYgKHByb21wdFJlc3BvbnNlLnN0YXR1cyA9PT0gXCJkaXNtaXNzZWRcIikge1xuICAgICAgdm9pZCB0aGlzLmRlbGV0ZVBhaXJpbmcocGFpcmluZ0lkLCBzZWNyZXRLZXksIHB1YmxpY0tleSk7XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICBjb25zdCBmaW5hbGl6ZWRQYWlyaW5nID0gcHJvbXB0UmVzcG9uc2UuYXJncztcbiAgICBhd2FpdCB0aGlzLmFkZFBhaXJpbmcoeyBwdWJsaWNLZXksIHNlY3JldEtleSB9LCBmaW5hbGl6ZWRQYWlyaW5nKTtcbiAgICByZXR1cm4gZmluYWxpemVkUGFpcmluZy5hY2NvdW50LmFjY291bnRBZGRyZXNzO1xuICB9XG4gIGFzeW5jIG9mZmJvYXJkKGFkZHJlc3MpIHtcbiAgICBjb25zdCBwYWlyaW5nID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0KGFkZHJlc3MpO1xuICAgIGlmIChwYWlyaW5nID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgYWNjb3VudCBpcyBub3QgcGFpcmVkXCIpO1xuICAgIH1cbiAgICBjb25zdCB3YWxsZXRJZCA9IHBhaXJpbmcuZGFwcFdhbGxldElkO1xuICAgIGlmICh3YWxsZXRJZCA9PT0gdm9pZCAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIGFjY291bnQgY2Fubm90IGJlIG9mZmJvYXJkZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5mcm9udGVuZEJhc2VVUkx9L29mZmJvYXJkaW5nP3dhbGxldElkPSR7d2FsbGV0SWR9YCk7XG4gICAgY29uc3QgcHJvbXB0V2luZG93ID0gb3BlblByb21wdCh1cmwpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2FpdEZvclByb21wdFJlc3BvbnNlKHByb21wdFdpbmRvdyk7XG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gXCJhcHByb3ZlZFwiICYmIHJlc3BvbnNlLmFyZ3Mub2ZmYm9hcmRlZCkge1xuICAgICAgdGhpcy5kaXNjb25uZWN0KGFkZHJlc3MpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICAvLyBlbmRyZWdpb25cbn07XG5cbi8vIHNyYy9LZXlsZXNzQ2xpZW50LnRzXG5pbXBvcnQge1xuICBDb25uZWN0UmVxdWVzdCBhcyBDb25uZWN0UmVxdWVzdDIsXG4gIENvbm5lY3RSZXNwb25zZSBhcyBDb25uZWN0UmVzcG9uc2UyLFxuICBEaXNjb25uZWN0UmVxdWVzdCBhcyBEaXNjb25uZWN0UmVxdWVzdDIsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdCBhcyBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlIGFzIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UyLFxuICBJc0Nvbm5lY3RlZFJlcXVlc3QsXG4gIElzQ29ubmVjdGVkUmVzcG9uc2UsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QgYXMgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlIGFzIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlMixcbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0IGFzIFNpZ25NZXNzYWdlUmVxdWVzdDIsXG4gIFNpZ25NZXNzYWdlUmVzcG9uc2UgYXMgU2lnbk1lc3NhZ2VSZXNwb25zZTIsXG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QgYXMgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIsXG4gIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlIGFzIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMlxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuaW1wb3J0IHsgV2ViV2FsbGV0VHJhbnNwb3J0IGFzIFdlYldhbGxldFRyYW5zcG9ydDIgfSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2ViLXRyYW5zcG9ydFwiO1xuaW1wb3J0IHsgTmV0d29ya05hbWUgYXMgTmV0d29ya05hbWUzIH0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L2FwaVwiO1xudmFyIEFDS2V5bGVzc0NsaWVudCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGRhcHBJbWFnZVVSSSxcbiAgICBkYXBwTmFtZSxcbiAgICBkZWZhdWx0TmV0d29ya05hbWUgPSBOZXR3b3JrTmFtZTMuTUFJTk5FVCxcbiAgICBmcm9udGVuZEJhc2VVUkwgPSBERUZBVUxUX0ZST05URU5EX1VSTCxcbiAgICBwcm92aWRlciA9IFwiZ29vZ2xlXCJcbiAgfSA9IHt9KSB7XG4gICAgdGhpcy5kZWZhdWx0TmV0d29ya05hbWUgPSBkZWZhdWx0TmV0d29ya05hbWU7XG4gICAgdGhpcy5kYXBwSW5mbyA9IHtcbiAgICAgIGRvbWFpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpbixcbiAgICAgIGltYWdlVVJJOiBkYXBwSW1hZ2VVUkksXG4gICAgICBuYW1lOiBkYXBwTmFtZSA/PyBkb2N1bWVudC50aXRsZVxuICAgIH07XG4gICAgdGhpcy50cmFuc3BvcnQgPSBuZXcgV2ViV2FsbGV0VHJhbnNwb3J0Mihmcm9udGVuZEJhc2VVUkwsIHByb3ZpZGVyKTtcbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICBhc3luYyBpc0Nvbm5lY3RlZCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IElzQ29ubmVjdGVkUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gSXNDb25uZWN0ZWRSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBkaXNjb25uZWN0KCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gRGlzY29ubmVjdFJlcXVlc3QyLnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvKTtcbiAgICBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25NZXNzYWdlUmVxdWVzdDIuc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25NZXNzYWdlUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKGFyZ3MpIHtcbiAgICBjb25zdCBub3JtYWxpemVkQXJncyA9IFwidHJhbnNhY3Rpb25cIiBpbiBhcmdzID8gU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubm9ybWFsaXplQXJncyhhcmdzKSA6IGFyZ3M7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgbm9ybWFsaXplZEFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuZXhwb3J0IHtcbiAgQUNEYXBwQ2xpZW50LFxuICBBQ0tleWxlc3NDbGllbnQsXG4gIERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZLFxuICBJQ0RhcHBDbGllbnQsXG4gIHdpbmRvd1N0YXRlQWNjZXNzb3JzXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/dapp-sdk/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WebWalletTransport: () => (/* binding */ WebWalletTransport)\n/* harmony export */ });\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _telegram_apps_bridge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @telegram-apps/bridge */ \"(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@telegram-apps/bridge/dist/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(ssr)/./node_modules/uuid/dist/esm-node/v4.js\");\n// src/index.ts\n\n\n// src/prompt.ts\n\nvar DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nvar PROMPT_POLLER_INTERVAL = 500;\nvar dismissalSerializedResponse = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.serialize({ status: \"dismissed\" });\nvar PromptUnauthorizedError = class extends Error {\n  constructor() {\n    super(\"Unauthorized\");\n  }\n};\nfunction openPrompt(url, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width\n  };\n  const strOptions = Object.entries(options).map(([key, value]) => `${key}=${JSON.stringify(value)}`).reduce((acc, entry) => `${acc}, ${entry}`);\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, void 0, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n  return promptWindow;\n}\nasync function waitForPromptResponse(baseUrl, promptWindow) {\n  return new Promise((resolve, reject) => {\n    const listeners = {\n      onMessage: (message) => {\n        if (message.source !== promptWindow || message.origin !== baseUrl) {\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptUnauthorizedErrorMessage, message.data)) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          reject(new PromptUnauthorizedError());\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptOpenerPingRequestMessage, message.data)) {\n          promptWindow.postMessage(new _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptOpenerPingResponseMessage(), baseUrl);\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptApprovalResponseMessage, message.data)) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(message.data.serializedValue);\n        }\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(dismissalSerializedResponse);\n        }\n      }, PROMPT_POLLER_INTERVAL)\n    };\n    window.addEventListener(\"message\", listeners.onMessage);\n  });\n}\n\n// src/state.ts\n\n\nvar localDappStateKey = \"@aptos-connect/dapp-local-state\";\nfunction serializeLocalDappState(state) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Serializer();\n  serializer.serializeU32AsUleb128(state.connectedAccounts.length);\n  for (const account of state.connectedAccounts) {\n    (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.serializeAccountInfo)(serializer, account);\n  }\n  return serializer.toUint8Array();\n}\nfunction deserializeLocalDappState(serializedValue) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Deserializer(serializedValue);\n  const connectedAccountsLength = deserializer.deserializeUleb128AsU32();\n  const connectedAccounts = [];\n  for (let i = 0; i < connectedAccountsLength; i += 1) {\n    connectedAccounts.push((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.deserializeAccountInfo)(deserializer));\n  }\n  return { connectedAccounts };\n}\nfunction getState() {\n  const encodedValue = window.localStorage.getItem(localDappStateKey);\n  return encodedValue ? deserializeLocalDappState((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.base64ToBytes)(encodedValue)) : { connectedAccounts: [] };\n}\nfunction setState(state) {\n  const serializedValue = serializeLocalDappState(state);\n  const encodedValue = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64)(serializedValue);\n  window.localStorage.setItem(localDappStateKey, encodedValue);\n}\nfunction getConnectedAccounts() {\n  const state = getState();\n  return state.connectedAccounts;\n}\nfunction addConnectedAccount(account) {\n  const { connectedAccounts, ...state } = getState();\n  connectedAccounts.push(account);\n  setState({ ...state, connectedAccounts });\n}\nfunction removeConnectedAccount(address) {\n  const { connectedAccounts, ...state } = getState();\n  const index = connectedAccounts.findIndex((a) => a.address.equals(address));\n  if (index >= 0) {\n    connectedAccounts.splice(index, 1);\n  }\n  setState({ ...state, connectedAccounts });\n}\n\n// src/telegram/openTelegramPrompt.ts\n\n\n\n\n// src/telegram/createWalletRequest.ts\n\nasync function createWalletRequest(baseUrl, request) {\n  const encodedClientIdentityKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64url)(request.clientIdentityKey.toUint8Array());\n  const response = await fetch(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/`, {\n    body: JSON.stringify({\n      body: (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodeWalletRequestBody)(request.body),\n      id: request.id,\n      signature: (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64)(request.signature.toUint8Array()),\n      timestamp: request.timestamp\n    }),\n    headers: { Accept: \"application/json\", \"Content-Type\": \"application/json\" },\n    method: \"post\"\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed creating the wallet request\");\n  }\n}\n\n// src/telegram/getClientIdentityKey.ts\n\nvar identityKeyStorageKey = \"@aptos-connect/client-identity-key\";\nfunction getClientIdentityKey() {\n  const serialized = window.localStorage.getItem(identityKeyStorageKey);\n  if (serialized) {\n    return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Ed25519PrivateKey(serialized);\n  }\n  const identityKey = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Ed25519PrivateKey.generate();\n  window.localStorage.setItem(identityKeyStorageKey, identityKey.toString());\n  return identityKey;\n}\n\n// src/telegram/getWalletResponse.ts\n\n\n// src/telegram/smartPolling.ts\nvar ON_RESUME_DELAY = 300;\nvar FG_RESPONSE_POLLING_INTERVAL = 2e3;\nvar BG_RESPONSE_POLLING_INTERVAL = 3e3;\nvar POLLING_TIMEOUT = 5 * 6e4;\nfunction waitFor(milliseconds) {\n  let timeoutId;\n  let cancel = () => {\n  };\n  const timer = new Promise((resolve) => {\n    timeoutId = setTimeout(resolve, milliseconds);\n    cancel = () => {\n      clearTimeout(timeoutId);\n      resolve();\n    };\n  });\n  timer.cancel = cancel;\n  return timer;\n}\nasync function smartPolling(callback) {\n  let timer;\n  let justResumed = false;\n  let pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n  const onWindowFocus = () => {\n    justResumed = true;\n    pollingInterval = FG_RESPONSE_POLLING_INTERVAL;\n    timer?.cancel();\n  };\n  const onWindowBlur = () => {\n    pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n  };\n  window.addEventListener(\"focus\", onWindowFocus);\n  window.addEventListener(\"blur\", onWindowBlur);\n  try {\n    const startTime = Date.now();\n    while (Date.now() - startTime < POLLING_TIMEOUT) {\n      timer = waitFor(pollingInterval);\n      await timer;\n      if (justResumed) {\n        timer = waitFor(ON_RESUME_DELAY);\n        await timer;\n      }\n      const response = await callback();\n      if (response.status === 200) {\n        return response;\n      }\n      justResumed = false;\n    }\n    throw new Error(\"Timeout\");\n  } finally {\n    window.removeEventListener(\"focus\", onWindowFocus);\n    window.removeEventListener(\"blur\", onWindowFocus);\n  }\n}\n\n// src/telegram/getWalletResponse.ts\nasync function getWalletResponse(baseUrl, clientIdentityKey, requestId) {\n  const encodedClientIdentityKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64url)(clientIdentityKey.toUint8Array());\n  const url = new URL(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/${requestId}/response/`);\n  const response = await smartPolling(\n    () => fetch(url, {\n      headers: { Accept: \"application/json\" },\n      method: \"get\"\n    })\n  );\n  const responseBody = await response.json();\n  const data = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.base64ToBytes)(responseBody.data.body);\n  return { data };\n}\n\n// src/telegram/openTelegramPrompt.ts\nasync function openTelegramPrompt(args) {\n  const { baseUrl, request: body, tgWebAppUrl = \"/AptosConnectBot/AptosConnect\" } = args;\n  const identityKey = getClientIdentityKey();\n  const clientIdentityKey = identityKey.publicKey();\n  const requestId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n  const timestamp = Date.now();\n  const challenge = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makePopupWalletRequestChallenge)({ body, id: requestId, timestamp });\n  const signature = identityKey.sign(challenge);\n  const signedWalletRequest = {\n    body,\n    clientIdentityKey,\n    id: requestId,\n    signature,\n    timestamp\n  };\n  let encodedRequest = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodePopupWalletRequest)(signedWalletRequest);\n  if (encodedRequest.length > 1024) {\n    void createWalletRequest(baseUrl, signedWalletRequest);\n    encodedRequest = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodePopupWalletRequest)({\n      clientIdentityKey,\n      id: requestId,\n      signature,\n      timestamp\n    });\n  }\n  (0,_telegram_apps_bridge__WEBPACK_IMPORTED_MODULE_3__.postEvent)(\"web_app_open_tg_link\", {\n    path_full: `${tgWebAppUrl}?startapp=${encodedRequest}`\n  });\n  return getWalletResponse(baseUrl, clientIdentityKey, requestId);\n}\n\n// src/telegram/index.ts\nfunction isTelegramMiniApp() {\n  return window.TelegramWebviewProxy !== void 0;\n}\n\n// src/index.ts\nvar WebWalletTransport = class {\n  constructor(baseUrl, provider = \"google\", tgWebAppUrl) {\n    this.baseUrl = baseUrl;\n    this.provider = provider;\n    this.tgWebAppUrl = tgWebAppUrl;\n    this.baseUrl = baseUrl;\n  }\n  async sendPromptRequest(request) {\n    if (isTelegramMiniApp()) {\n      return openTelegramPrompt({\n        baseUrl: this.baseUrl,\n        request,\n        tgWebAppUrl: this.tgWebAppUrl\n      });\n    }\n    const url = new URL(`${this.baseUrl}/prompt/`);\n    url.searchParams.set(\"request\", (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.urlEncodeWalletRequest)(request));\n    url.searchParams.set(\"provider\", this.provider);\n    const prompt = openPrompt(url);\n    return waitForPromptResponse(this.baseUrl, prompt);\n  }\n  async sendRequest(request) {\n    switch (request.name) {\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedResponse.serialize(connectedAccounts.length > 0);\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.serialize(connectedAccounts);\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.name: {\n        const serializedResponse = await this.sendPromptRequest(request);\n        const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n        if (response.args.status === \"approved\") {\n          const { account, pairing } = response.args.args;\n          if (pairing === void 0) {\n            addConnectedAccount(account);\n          }\n        }\n        return serializedResponse;\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignInRequest.name: {\n        const serializedResponse = await this.sendPromptRequest(request);\n        const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignInResponse.deserialize(serializedResponse);\n        if (response.args.status === \"approved\") {\n          const { account } = response.args.args;\n          addConnectedAccount(account);\n        }\n        return serializedResponse;\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.name: {\n        const [activeAccount] = getConnectedAccounts();\n        if (activeAccount) {\n          removeConnectedAccount(activeAccount.address);\n        }\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectResponse.serialize({});\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.name:\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.name:\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.name: {\n        return this.sendPromptRequest(request);\n      }\n      default: {\n        throw new Error(\"Unexpected request\");\n      }\n    }\n  }\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvZGFwcC1zZGsvbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dlYi10cmFuc3BvcnQvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQWdCbUM7O0FBRW5DO0FBUW1DO0FBQ25DLDRCQUE0QjtBQUM1QjtBQUNBLGtDQUFrQyxzRUFBZSxhQUFhLHFCQUFxQjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdCQUFnQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxJQUFJLEdBQUcsc0JBQXNCLDZCQUE2QixJQUFJLElBQUksTUFBTTtBQUM5STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5RUFBYyxDQUFDLHFGQUE4QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5RUFBYyxDQUFDLHFGQUE4QjtBQUN6RCx1Q0FBdUMsc0ZBQStCO0FBQ3RFO0FBQ0E7QUFDQSxZQUFZLHlFQUFjLENBQUMsb0ZBQTZCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBTW1DO0FBQzJCO0FBQzlEO0FBQ0E7QUFDQSx5QkFBeUIsMERBQVU7QUFDbkM7QUFDQTtBQUNBLElBQUksK0VBQW9CO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDREQUFZO0FBQ3ZDO0FBQ0E7QUFDQSxrQkFBa0IsNkJBQTZCO0FBQy9DLDJCQUEyQixpRkFBc0I7QUFDakQ7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHdFQUFhLG9CQUFvQjtBQUNuRjtBQUNBO0FBQ0E7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QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNocmF2XFxhaS5hcHQtbWV0YW1vdmUtaGFja2F0aG9uXFxmcm9udGVkXFxub2RlX21vZHVsZXNcXEBpZGVudGl0eS1jb25uZWN0XFxkYXBwLXNka1xcbm9kZV9tb2R1bGVzXFxAYXB0b3MtY29ubmVjdFxcd2ViLXRyYW5zcG9ydFxcZGlzdFxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9pbmRleC50c1xuaW1wb3J0IHtcbiAgQ29ubmVjdFJlcXVlc3QsXG4gIENvbm5lY3RSZXNwb25zZSBhcyBDb25uZWN0UmVzcG9uc2UyLFxuICBEaXNjb25uZWN0UmVxdWVzdCxcbiAgRGlzY29ubmVjdFJlc3BvbnNlLFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UsXG4gIElzQ29ubmVjdGVkUmVxdWVzdCxcbiAgSXNDb25uZWN0ZWRSZXNwb25zZSxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgU2lnbkluUmVxdWVzdCxcbiAgU2lnbkluUmVzcG9uc2UsXG4gIFNpZ25NZXNzYWdlUmVxdWVzdCxcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgdXJsRW5jb2RlV2FsbGV0UmVxdWVzdFxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuXG4vLyBzcmMvcHJvbXB0LnRzXG5pbXBvcnQge1xuICBDb25uZWN0UmVzcG9uc2UsXG4gIGlzVHlwZWRNZXNzYWdlLFxuICBQcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZSxcbiAgUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlLFxuICBQcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlLFxuICBQcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2Vcbn0gZnJvbSBcIkBhcHRvcy1jb25uZWN0L3dhbGxldC1hcGlcIjtcbnZhciBERUZBVUxUX1BST01QVF9TSVpFID0geyBoZWlnaHQ6IDY5NSwgd2lkdGg6IDQ2NSB9O1xudmFyIFBST01QVF9QT0xMRVJfSU5URVJWQUwgPSA1MDA7XG52YXIgZGlzbWlzc2FsU2VyaWFsaXplZFJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlLnNlcmlhbGl6ZSh7IHN0YXR1czogXCJkaXNtaXNzZWRcIiB9KTtcbnZhciBQcm9tcHRVbmF1dGhvcml6ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcIlVuYXV0aG9yaXplZFwiKTtcbiAgfVxufTtcbmZ1bmN0aW9uIG9wZW5Qcm9tcHQodXJsLCBzaXplID0gREVGQVVMVF9QUk9NUFRfU0laRSkge1xuICBjb25zdCB7IGhlaWdodCwgd2lkdGggfSA9IHNpemU7XG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgaGVpZ2h0LFxuICAgIGxlZnQ6IHdpbmRvdy5zY3JlZW5MZWZ0ICsgTWF0aC5yb3VuZCgod2luZG93Lm91dGVyV2lkdGggLSB3aWR0aCkgLyAyKSxcbiAgICBwb3B1cDogdHJ1ZSxcbiAgICB0b3A6IHdpbmRvdy5zY3JlZW5Ub3AgKyBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJIZWlnaHQgLSBoZWlnaHQpIC8gMiksXG4gICAgd2lkdGhcbiAgfTtcbiAgY29uc3Qgc3RyT3B0aW9ucyA9IE9iamVjdC5lbnRyaWVzKG9wdGlvbnMpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBgJHtrZXl9PSR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfWApLnJlZHVjZSgoYWNjLCBlbnRyeSkgPT4gYCR7YWNjfSwgJHtlbnRyeX1gKTtcbiAgY29uc3QgaHJlZiA9IHVybCBpbnN0YW5jZW9mIFVSTCA/IHVybC5ocmVmIDogdXJsO1xuICBjb25zdCBwcm9tcHRXaW5kb3cgPSB3aW5kb3cub3BlbihocmVmLCB2b2lkIDAsIHN0ck9wdGlvbnMpO1xuICBpZiAocHJvbXB0V2luZG93ID09PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGRuJ3Qgb3BlbiBwcm9tcHRcIik7XG4gIH1cbiAgcmV0dXJuIHByb21wdFdpbmRvdztcbn1cbmFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JQcm9tcHRSZXNwb25zZShiYXNlVXJsLCBwcm9tcHRXaW5kb3cpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB7XG4gICAgICBvbk1lc3NhZ2U6IChtZXNzYWdlKSA9PiB7XG4gICAgICAgIGlmIChtZXNzYWdlLnNvdXJjZSAhPT0gcHJvbXB0V2luZG93IHx8IG1lc3NhZ2Uub3JpZ2luICE9PSBiYXNlVXJsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1R5cGVkTWVzc2FnZShQcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2UsIG1lc3NhZ2UuZGF0YSkpIHtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXJzLm9uTWVzc2FnZSk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGxpc3RlbmVycy5wcm9tcHRQb2xsZXJJZCk7XG4gICAgICAgICAgcmVqZWN0KG5ldyBQcm9tcHRVbmF1dGhvcml6ZWRFcnJvcigpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVHlwZWRNZXNzYWdlKFByb21wdE9wZW5lclBpbmdSZXF1ZXN0TWVzc2FnZSwgbWVzc2FnZS5kYXRhKSkge1xuICAgICAgICAgIHByb21wdFdpbmRvdy5wb3N0TWVzc2FnZShuZXcgUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlTWVzc2FnZSgpLCBiYXNlVXJsKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVHlwZWRNZXNzYWdlKFByb21wdEFwcHJvdmFsUmVzcG9uc2VNZXNzYWdlLCBtZXNzYWdlLmRhdGEpKSB7XG4gICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGxpc3RlbmVycy5vbk1lc3NhZ2UpO1xuICAgICAgICAgIGNsZWFyVGltZW91dChsaXN0ZW5lcnMucHJvbXB0UG9sbGVySWQpO1xuICAgICAgICAgIHJlc29sdmUobWVzc2FnZS5kYXRhLnNlcmlhbGl6ZWRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBwcm9tcHRQb2xsZXJJZDogc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAocHJvbXB0V2luZG93LmNsb3NlZCkge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQobGlzdGVuZXJzLnByb21wdFBvbGxlcklkKTtcbiAgICAgICAgICByZXNvbHZlKGRpc21pc3NhbFNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIFBST01QVF9QT0xMRVJfSU5URVJWQUwpXG4gICAgfTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXJzLm9uTWVzc2FnZSk7XG4gIH0pO1xufVxuXG4vLyBzcmMvc3RhdGUudHNcbmltcG9ydCB7XG4gIGJhc2U2NFRvQnl0ZXMsXG4gIGJ5dGVzVG9CYXNlNjQsXG4gIGRlc2VyaWFsaXplQWNjb3VudEluZm8sXG4gIHNlcmlhbGl6ZUFjY291bnRJbmZvXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQgeyBEZXNlcmlhbGl6ZXIsIFNlcmlhbGl6ZXIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgbG9jYWxEYXBwU3RhdGVLZXkgPSBcIkBhcHRvcy1jb25uZWN0L2RhcHAtbG9jYWwtc3RhdGVcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZUxvY2FsRGFwcFN0YXRlKHN0YXRlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcigpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChzdGF0ZS5jb25uZWN0ZWRBY2NvdW50cy5sZW5ndGgpO1xuICBmb3IgKGNvbnN0IGFjY291bnQgb2Ygc3RhdGUuY29ubmVjdGVkQWNjb3VudHMpIHtcbiAgICBzZXJpYWxpemVBY2NvdW50SW5mbyhzZXJpYWxpemVyLCBhY2NvdW50KTtcbiAgfVxuICByZXR1cm4gc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplTG9jYWxEYXBwU3RhdGUoc2VyaWFsaXplZFZhbHVlKSB7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFZhbHVlKTtcbiAgY29uc3QgY29ubmVjdGVkQWNjb3VudHNMZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgY29uc3QgY29ubmVjdGVkQWNjb3VudHMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb25uZWN0ZWRBY2NvdW50c0xlbmd0aDsgaSArPSAxKSB7XG4gICAgY29ubmVjdGVkQWNjb3VudHMucHVzaChkZXNlcmlhbGl6ZUFjY291bnRJbmZvKGRlc2VyaWFsaXplcikpO1xuICB9XG4gIHJldHVybiB7IGNvbm5lY3RlZEFjY291bnRzIH07XG59XG5mdW5jdGlvbiBnZXRTdGF0ZSgpIHtcbiAgY29uc3QgZW5jb2RlZFZhbHVlID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGxvY2FsRGFwcFN0YXRlS2V5KTtcbiAgcmV0dXJuIGVuY29kZWRWYWx1ZSA/IGRlc2VyaWFsaXplTG9jYWxEYXBwU3RhdGUoYmFzZTY0VG9CeXRlcyhlbmNvZGVkVmFsdWUpKSA6IHsgY29ubmVjdGVkQWNjb3VudHM6IFtdIH07XG59XG5mdW5jdGlvbiBzZXRTdGF0ZShzdGF0ZSkge1xuICBjb25zdCBzZXJpYWxpemVkVmFsdWUgPSBzZXJpYWxpemVMb2NhbERhcHBTdGF0ZShzdGF0ZSk7XG4gIGNvbnN0IGVuY29kZWRWYWx1ZSA9IGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplZFZhbHVlKTtcbiAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGxvY2FsRGFwcFN0YXRlS2V5LCBlbmNvZGVkVmFsdWUpO1xufVxuZnVuY3Rpb24gZ2V0Q29ubmVjdGVkQWNjb3VudHMoKSB7XG4gIGNvbnN0IHN0YXRlID0gZ2V0U3RhdGUoKTtcbiAgcmV0dXJuIHN0YXRlLmNvbm5lY3RlZEFjY291bnRzO1xufVxuZnVuY3Rpb24gYWRkQ29ubmVjdGVkQWNjb3VudChhY2NvdW50KSB7XG4gIGNvbnN0IHsgY29ubmVjdGVkQWNjb3VudHMsIC4uLnN0YXRlIH0gPSBnZXRTdGF0ZSgpO1xuICBjb25uZWN0ZWRBY2NvdW50cy5wdXNoKGFjY291bnQpO1xuICBzZXRTdGF0ZSh7IC4uLnN0YXRlLCBjb25uZWN0ZWRBY2NvdW50cyB9KTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUNvbm5lY3RlZEFjY291bnQoYWRkcmVzcykge1xuICBjb25zdCB7IGNvbm5lY3RlZEFjY291bnRzLCAuLi5zdGF0ZSB9ID0gZ2V0U3RhdGUoKTtcbiAgY29uc3QgaW5kZXggPSBjb25uZWN0ZWRBY2NvdW50cy5maW5kSW5kZXgoKGEpID0+IGEuYWRkcmVzcy5lcXVhbHMoYWRkcmVzcykpO1xuICBpZiAoaW5kZXggPj0gMCkge1xuICAgIGNvbm5lY3RlZEFjY291bnRzLnNwbGljZShpbmRleCwgMSk7XG4gIH1cbiAgc2V0U3RhdGUoeyAuLi5zdGF0ZSwgY29ubmVjdGVkQWNjb3VudHMgfSk7XG59XG5cbi8vIHNyYy90ZWxlZ3JhbS9vcGVuVGVsZWdyYW1Qcm9tcHQudHNcbmltcG9ydCB7XG4gIGVuY29kZVBvcHVwV2FsbGV0UmVxdWVzdCxcbiAgbWFrZVBvcHVwV2FsbGV0UmVxdWVzdENoYWxsZW5nZVxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuaW1wb3J0IHsgcG9zdEV2ZW50IGFzIHBvc3RUZWxlZ3JhbUV2ZW50IH0gZnJvbSBcIkB0ZWxlZ3JhbS1hcHBzL2JyaWRnZVwiO1xuaW1wb3J0IHsgdjQgYXMgcmFuZG9tVVVJRCB9IGZyb20gXCJ1dWlkXCI7XG5cbi8vIHNyYy90ZWxlZ3JhbS9jcmVhdGVXYWxsZXRSZXF1ZXN0LnRzXG5pbXBvcnQge1xuICBieXRlc1RvQmFzZTY0IGFzIGJ5dGVzVG9CYXNlNjQyLFxuICBieXRlc1RvQmFzZTY0dXJsLFxuICBlbmNvZGVXYWxsZXRSZXF1ZXN0Qm9keVxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2FsbGV0UmVxdWVzdChiYXNlVXJsLCByZXF1ZXN0KSB7XG4gIGNvbnN0IGVuY29kZWRDbGllbnRJZGVudGl0eUtleSA9IGJ5dGVzVG9CYXNlNjR1cmwocmVxdWVzdC5jbGllbnRJZGVudGl0eUtleS50b1VpbnQ4QXJyYXkoKSk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7YmFzZVVybH0vdjEvZGFwcC9jbGllbnRzLyR7ZW5jb2RlZENsaWVudElkZW50aXR5S2V5fS9yZXF1ZXN0cy9gLCB7XG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgYm9keTogZW5jb2RlV2FsbGV0UmVxdWVzdEJvZHkocmVxdWVzdC5ib2R5KSxcbiAgICAgIGlkOiByZXF1ZXN0LmlkLFxuICAgICAgc2lnbmF0dXJlOiBieXRlc1RvQmFzZTY0MihyZXF1ZXN0LnNpZ25hdHVyZS50b1VpbnQ4QXJyYXkoKSksXG4gICAgICB0aW1lc3RhbXA6IHJlcXVlc3QudGltZXN0YW1wXG4gICAgfSksXG4gICAgaGVhZGVyczogeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiLCBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgIG1ldGhvZDogXCJwb3N0XCJcbiAgfSk7XG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgY3JlYXRpbmcgdGhlIHdhbGxldCByZXF1ZXN0XCIpO1xuICB9XG59XG5cbi8vIHNyYy90ZWxlZ3JhbS9nZXRDbGllbnRJZGVudGl0eUtleS50c1xuaW1wb3J0IHsgRWQyNTUxOVByaXZhdGVLZXkgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgaWRlbnRpdHlLZXlTdG9yYWdlS2V5ID0gXCJAYXB0b3MtY29ubmVjdC9jbGllbnQtaWRlbnRpdHkta2V5XCI7XG5mdW5jdGlvbiBnZXRDbGllbnRJZGVudGl0eUtleSgpIHtcbiAgY29uc3Qgc2VyaWFsaXplZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShpZGVudGl0eUtleVN0b3JhZ2VLZXkpO1xuICBpZiAoc2VyaWFsaXplZCkge1xuICAgIHJldHVybiBuZXcgRWQyNTUxOVByaXZhdGVLZXkoc2VyaWFsaXplZCk7XG4gIH1cbiAgY29uc3QgaWRlbnRpdHlLZXkgPSBFZDI1NTE5UHJpdmF0ZUtleS5nZW5lcmF0ZSgpO1xuICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oaWRlbnRpdHlLZXlTdG9yYWdlS2V5LCBpZGVudGl0eUtleS50b1N0cmluZygpKTtcbiAgcmV0dXJuIGlkZW50aXR5S2V5O1xufVxuXG4vLyBzcmMvdGVsZWdyYW0vZ2V0V2FsbGV0UmVzcG9uc2UudHNcbmltcG9ydCB7IGJhc2U2NFRvQnl0ZXMgYXMgYmFzZTY0VG9CeXRlczIsIGJ5dGVzVG9CYXNlNjR1cmwgYXMgYnl0ZXNUb0Jhc2U2NHVybDIgfSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuXG4vLyBzcmMvdGVsZWdyYW0vc21hcnRQb2xsaW5nLnRzXG52YXIgT05fUkVTVU1FX0RFTEFZID0gMzAwO1xudmFyIEZHX1JFU1BPTlNFX1BPTExJTkdfSU5URVJWQUwgPSAyZTM7XG52YXIgQkdfUkVTUE9OU0VfUE9MTElOR19JTlRFUlZBTCA9IDNlMztcbnZhciBQT0xMSU5HX1RJTUVPVVQgPSA1ICogNmU0O1xuZnVuY3Rpb24gd2FpdEZvcihtaWxsaXNlY29uZHMpIHtcbiAgbGV0IHRpbWVvdXRJZDtcbiAgbGV0IGNhbmNlbCA9ICgpID0+IHtcbiAgfTtcbiAgY29uc3QgdGltZXIgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcbiAgICBjYW5jZWwgPSAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9O1xuICB9KTtcbiAgdGltZXIuY2FuY2VsID0gY2FuY2VsO1xuICByZXR1cm4gdGltZXI7XG59XG5hc3luYyBmdW5jdGlvbiBzbWFydFBvbGxpbmcoY2FsbGJhY2spIHtcbiAgbGV0IHRpbWVyO1xuICBsZXQganVzdFJlc3VtZWQgPSBmYWxzZTtcbiAgbGV0IHBvbGxpbmdJbnRlcnZhbCA9IEJHX1JFU1BPTlNFX1BPTExJTkdfSU5URVJWQUw7XG4gIGNvbnN0IG9uV2luZG93Rm9jdXMgPSAoKSA9PiB7XG4gICAganVzdFJlc3VtZWQgPSB0cnVlO1xuICAgIHBvbGxpbmdJbnRlcnZhbCA9IEZHX1JFU1BPTlNFX1BPTExJTkdfSU5URVJWQUw7XG4gICAgdGltZXI/LmNhbmNlbCgpO1xuICB9O1xuICBjb25zdCBvbldpbmRvd0JsdXIgPSAoKSA9PiB7XG4gICAgcG9sbGluZ0ludGVydmFsID0gQkdfUkVTUE9OU0VfUE9MTElOR19JTlRFUlZBTDtcbiAgfTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBvbldpbmRvd0ZvY3VzKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIG9uV2luZG93Qmx1cik7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB3aGlsZSAoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSA8IFBPTExJTkdfVElNRU9VVCkge1xuICAgICAgdGltZXIgPSB3YWl0Rm9yKHBvbGxpbmdJbnRlcnZhbCk7XG4gICAgICBhd2FpdCB0aW1lcjtcbiAgICAgIGlmIChqdXN0UmVzdW1lZCkge1xuICAgICAgICB0aW1lciA9IHdhaXRGb3IoT05fUkVTVU1FX0RFTEFZKTtcbiAgICAgICAgYXdhaXQgdGltZXI7XG4gICAgICB9XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGxiYWNrKCk7XG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgfVxuICAgICAganVzdFJlc3VtZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVGltZW91dFwiKTtcbiAgfSBmaW5hbGx5IHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIG9uV2luZG93Rm9jdXMpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBvbldpbmRvd0ZvY3VzKTtcbiAgfVxufVxuXG4vLyBzcmMvdGVsZWdyYW0vZ2V0V2FsbGV0UmVzcG9uc2UudHNcbmFzeW5jIGZ1bmN0aW9uIGdldFdhbGxldFJlc3BvbnNlKGJhc2VVcmwsIGNsaWVudElkZW50aXR5S2V5LCByZXF1ZXN0SWQpIHtcbiAgY29uc3QgZW5jb2RlZENsaWVudElkZW50aXR5S2V5ID0gYnl0ZXNUb0Jhc2U2NHVybDIoY2xpZW50SWRlbnRpdHlLZXkudG9VaW50OEFycmF5KCkpO1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke2Jhc2VVcmx9L3YxL2RhcHAvY2xpZW50cy8ke2VuY29kZWRDbGllbnRJZGVudGl0eUtleX0vcmVxdWVzdHMvJHtyZXF1ZXN0SWR9L3Jlc3BvbnNlL2ApO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHNtYXJ0UG9sbGluZyhcbiAgICAoKSA9PiBmZXRjaCh1cmwsIHtcbiAgICAgIGhlYWRlcnM6IHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgbWV0aG9kOiBcImdldFwiXG4gICAgfSlcbiAgKTtcbiAgY29uc3QgcmVzcG9uc2VCb2R5ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICBjb25zdCBkYXRhID0gYmFzZTY0VG9CeXRlczIocmVzcG9uc2VCb2R5LmRhdGEuYm9keSk7XG4gIHJldHVybiB7IGRhdGEgfTtcbn1cblxuLy8gc3JjL3RlbGVncmFtL29wZW5UZWxlZ3JhbVByb21wdC50c1xuYXN5bmMgZnVuY3Rpb24gb3BlblRlbGVncmFtUHJvbXB0KGFyZ3MpIHtcbiAgY29uc3QgeyBiYXNlVXJsLCByZXF1ZXN0OiBib2R5LCB0Z1dlYkFwcFVybCA9IFwiL0FwdG9zQ29ubmVjdEJvdC9BcHRvc0Nvbm5lY3RcIiB9ID0gYXJncztcbiAgY29uc3QgaWRlbnRpdHlLZXkgPSBnZXRDbGllbnRJZGVudGl0eUtleSgpO1xuICBjb25zdCBjbGllbnRJZGVudGl0eUtleSA9IGlkZW50aXR5S2V5LnB1YmxpY0tleSgpO1xuICBjb25zdCByZXF1ZXN0SWQgPSByYW5kb21VVUlEKCk7XG4gIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCk7XG4gIGNvbnN0IGNoYWxsZW5nZSA9IG1ha2VQb3B1cFdhbGxldFJlcXVlc3RDaGFsbGVuZ2UoeyBib2R5LCBpZDogcmVxdWVzdElkLCB0aW1lc3RhbXAgfSk7XG4gIGNvbnN0IHNpZ25hdHVyZSA9IGlkZW50aXR5S2V5LnNpZ24oY2hhbGxlbmdlKTtcbiAgY29uc3Qgc2lnbmVkV2FsbGV0UmVxdWVzdCA9IHtcbiAgICBib2R5LFxuICAgIGNsaWVudElkZW50aXR5S2V5LFxuICAgIGlkOiByZXF1ZXN0SWQsXG4gICAgc2lnbmF0dXJlLFxuICAgIHRpbWVzdGFtcFxuICB9O1xuICBsZXQgZW5jb2RlZFJlcXVlc3QgPSBlbmNvZGVQb3B1cFdhbGxldFJlcXVlc3Qoc2lnbmVkV2FsbGV0UmVxdWVzdCk7XG4gIGlmIChlbmNvZGVkUmVxdWVzdC5sZW5ndGggPiAxMDI0KSB7XG4gICAgdm9pZCBjcmVhdGVXYWxsZXRSZXF1ZXN0KGJhc2VVcmwsIHNpZ25lZFdhbGxldFJlcXVlc3QpO1xuICAgIGVuY29kZWRSZXF1ZXN0ID0gZW5jb2RlUG9wdXBXYWxsZXRSZXF1ZXN0KHtcbiAgICAgIGNsaWVudElkZW50aXR5S2V5LFxuICAgICAgaWQ6IHJlcXVlc3RJZCxcbiAgICAgIHNpZ25hdHVyZSxcbiAgICAgIHRpbWVzdGFtcFxuICAgIH0pO1xuICB9XG4gIHBvc3RUZWxlZ3JhbUV2ZW50KFwid2ViX2FwcF9vcGVuX3RnX2xpbmtcIiwge1xuICAgIHBhdGhfZnVsbDogYCR7dGdXZWJBcHBVcmx9P3N0YXJ0YXBwPSR7ZW5jb2RlZFJlcXVlc3R9YFxuICB9KTtcbiAgcmV0dXJuIGdldFdhbGxldFJlc3BvbnNlKGJhc2VVcmwsIGNsaWVudElkZW50aXR5S2V5LCByZXF1ZXN0SWQpO1xufVxuXG4vLyBzcmMvdGVsZWdyYW0vaW5kZXgudHNcbmZ1bmN0aW9uIGlzVGVsZWdyYW1NaW5pQXBwKCkge1xuICByZXR1cm4gd2luZG93LlRlbGVncmFtV2Vidmlld1Byb3h5ICE9PSB2b2lkIDA7XG59XG5cbi8vIHNyYy9pbmRleC50c1xudmFyIFdlYldhbGxldFRyYW5zcG9ydCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoYmFzZVVybCwgcHJvdmlkZXIgPSBcImdvb2dsZVwiLCB0Z1dlYkFwcFVybCkge1xuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5wcm92aWRlciA9IHByb3ZpZGVyO1xuICAgIHRoaXMudGdXZWJBcHBVcmwgPSB0Z1dlYkFwcFVybDtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICB9XG4gIGFzeW5jIHNlbmRQcm9tcHRSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBpZiAoaXNUZWxlZ3JhbU1pbmlBcHAoKSkge1xuICAgICAgcmV0dXJuIG9wZW5UZWxlZ3JhbVByb21wdCh7XG4gICAgICAgIGJhc2VVcmw6IHRoaXMuYmFzZVVybCxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgdGdXZWJBcHBVcmw6IHRoaXMudGdXZWJBcHBVcmxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke3RoaXMuYmFzZVVybH0vcHJvbXB0L2ApO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVxdWVzdFwiLCB1cmxFbmNvZGVXYWxsZXRSZXF1ZXN0KHJlcXVlc3QpKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInByb3ZpZGVyXCIsIHRoaXMucHJvdmlkZXIpO1xuICAgIGNvbnN0IHByb21wdCA9IG9wZW5Qcm9tcHQodXJsKTtcbiAgICByZXR1cm4gd2FpdEZvclByb21wdFJlc3BvbnNlKHRoaXMuYmFzZVVybCwgcHJvbXB0KTtcbiAgfVxuICBhc3luYyBzZW5kUmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgc3dpdGNoIChyZXF1ZXN0Lm5hbWUpIHtcbiAgICAgIGNhc2UgSXNDb25uZWN0ZWRSZXF1ZXN0Lm5hbWU6IHtcbiAgICAgICAgY29uc3QgY29ubmVjdGVkQWNjb3VudHMgPSBnZXRDb25uZWN0ZWRBY2NvdW50cygpO1xuICAgICAgICByZXR1cm4gSXNDb25uZWN0ZWRSZXNwb25zZS5zZXJpYWxpemUoY29ubmVjdGVkQWNjb3VudHMubGVuZ3RoID4gMCk7XG4gICAgICB9XG4gICAgICBjYXNlIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdC5uYW1lOiB7XG4gICAgICAgIGNvbnN0IGNvbm5lY3RlZEFjY291bnRzID0gZ2V0Q29ubmVjdGVkQWNjb3VudHMoKTtcbiAgICAgICAgcmV0dXJuIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2Uuc2VyaWFsaXplKGNvbm5lY3RlZEFjY291bnRzKTtcbiAgICAgIH1cbiAgICAgIGNhc2UgQ29ubmVjdFJlcXVlc3QubmFtZToge1xuICAgICAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlbmRQcm9tcHRSZXF1ZXN0KHJlcXVlc3QpO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IENvbm5lY3RSZXNwb25zZTIuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmFyZ3Muc3RhdHVzID09PSBcImFwcHJvdmVkXCIpIHtcbiAgICAgICAgICBjb25zdCB7IGFjY291bnQsIHBhaXJpbmcgfSA9IHJlc3BvbnNlLmFyZ3MuYXJncztcbiAgICAgICAgICBpZiAocGFpcmluZyA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBhZGRDb25uZWN0ZWRBY2NvdW50KGFjY291bnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VyaWFsaXplZFJlc3BvbnNlO1xuICAgICAgfVxuICAgICAgY2FzZSBTaWduSW5SZXF1ZXN0Lm5hbWU6IHtcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy5zZW5kUHJvbXB0UmVxdWVzdChyZXF1ZXN0KTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBTaWduSW5SZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgICAgICBpZiAocmVzcG9uc2UuYXJncy5zdGF0dXMgPT09IFwiYXBwcm92ZWRcIikge1xuICAgICAgICAgIGNvbnN0IHsgYWNjb3VudCB9ID0gcmVzcG9uc2UuYXJncy5hcmdzO1xuICAgICAgICAgIGFkZENvbm5lY3RlZEFjY291bnQoYWNjb3VudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZWRSZXNwb25zZTtcbiAgICAgIH1cbiAgICAgIGNhc2UgRGlzY29ubmVjdFJlcXVlc3QubmFtZToge1xuICAgICAgICBjb25zdCBbYWN0aXZlQWNjb3VudF0gPSBnZXRDb25uZWN0ZWRBY2NvdW50cygpO1xuICAgICAgICBpZiAoYWN0aXZlQWNjb3VudCkge1xuICAgICAgICAgIHJlbW92ZUNvbm5lY3RlZEFjY291bnQoYWN0aXZlQWNjb3VudC5hZGRyZXNzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRGlzY29ubmVjdFJlc3BvbnNlLnNlcmlhbGl6ZSh7fSk7XG4gICAgICB9XG4gICAgICBjYXNlIFNpZ25NZXNzYWdlUmVxdWVzdC5uYW1lOlxuICAgICAgY2FzZSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Lm5hbWU6XG4gICAgICBjYXNlIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QubmFtZToge1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kUHJvbXB0UmVxdWVzdChyZXF1ZXN0KTtcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCByZXF1ZXN0XCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcbmV4cG9ydCB7XG4gIFdlYldhbGxldFRyYW5zcG9ydFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@telegram-apps/bridge/dist/index.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@identity-connect/dapp-sdk/node_modules/@telegram-apps/bridge/dist/index.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   $debug: () => (/* binding */ ae),\n/* harmony export */   $targetOrigin: () => (/* binding */ ue),\n/* harmony export */   CancelablePromise: () => (/* binding */ w),\n/* harmony export */   ERR_ABORTED: () => (/* binding */ re),\n/* harmony export */   ERR_CANCELED: () => (/* binding */ ne),\n/* harmony export */   ERR_CUSTOM_METHOD_ERR_RESPONSE: () => (/* binding */ Ke),\n/* harmony export */   ERR_METHOD_PARAMETER_UNSUPPORTED: () => (/* binding */ He),\n/* harmony export */   ERR_METHOD_UNSUPPORTED: () => (/* binding */ Je),\n/* harmony export */   ERR_RETRIEVE_LP_FAILED: () => (/* binding */ Be),\n/* harmony export */   ERR_TIMED_OUT: () => (/* binding */ oe),\n/* harmony export */   ERR_UNKNOWN_ENV: () => (/* binding */ Ge),\n/* harmony export */   EnhancedPromise: () => (/* binding */ S),\n/* harmony export */   TypedError: () => (/* binding */ b),\n/* harmony export */   addEventListener: () => (/* binding */ te),\n/* harmony export */   camelToKebab: () => (/* binding */ ct),\n/* harmony export */   camelToSnake: () => (/* binding */ it),\n/* harmony export */   captureSameReq: () => (/* binding */ et),\n/* harmony export */   compareVersions: () => (/* binding */ tt),\n/* harmony export */   createAbortError: () => (/* binding */ M),\n/* harmony export */   createCbCollector: () => (/* binding */ k),\n/* harmony export */   createLogger: () => (/* binding */ ke),\n/* harmony export */   createPostEvent: () => (/* binding */ dt),\n/* harmony export */   createTypedErrorPredicate: () => (/* binding */ L),\n/* harmony export */   defineEventHandlers: () => (/* binding */ bt),\n/* harmony export */   deleteCssVar: () => (/* binding */ ft),\n/* harmony export */   emitMiniAppsEvent: () => (/* binding */ x),\n/* harmony export */   getStorageValue: () => (/* binding */ xe),\n/* harmony export */   hasWebviewProxy: () => (/* binding */ Q),\n/* harmony export */   invokeCustomMethod: () => (/* binding */ Et),\n/* harmony export */   isAbortError: () => (/* binding */ ot),\n/* harmony export */   isCanceledError: () => (/* binding */ st),\n/* harmony export */   isIframe: () => (/* binding */ Ne),\n/* harmony export */   isTMA: () => (/* binding */ _t),\n/* harmony export */   isTimeoutError: () => (/* binding */ nt),\n/* harmony export */   mockTelegramEnv: () => (/* binding */ lt),\n/* harmony export */   off: () => (/* binding */ wt),\n/* harmony export */   on: () => (/* binding */ Fe),\n/* harmony export */   postEvent: () => (/* binding */ pe),\n/* harmony export */   removeEventHandlers: () => (/* binding */ gt),\n/* harmony export */   request: () => (/* binding */ fe),\n/* harmony export */   resetPackageState: () => (/* binding */ yt),\n/* harmony export */   retrieveLaunchParams: () => (/* binding */ Ye),\n/* harmony export */   setCssVar: () => (/* binding */ pt),\n/* harmony export */   setStorageValue: () => (/* binding */ We),\n/* harmony export */   sleep: () => (/* binding */ at),\n/* harmony export */   snakeToCamel: () => (/* binding */ ut),\n/* harmony export */   subscribe: () => (/* binding */ ht),\n/* harmony export */   supports: () => (/* binding */ H),\n/* harmony export */   unsubscribe: () => (/* binding */ mt)\n/* harmony export */ });\nclass d extends Error {\n  constructor(t, r, n) {\n    super(\n      typeof r == \"object\" ? r.message : r || t,\n      {\n        cause: typeof r == \"object\" ? r.cause : n\n      }\n    ), this.type = t, this.name = \"TypedError\", Object.setPrototypeOf(this, d.prototype);\n  }\n}\nfunction G(e) {\n  return e.replace(/[A-Z]/g, (t) => `_${t.toLowerCase()}`);\n}\nfunction we(e) {\n  return e.replace(/_[a-z]/g, (t) => t[1].toUpperCase());\n}\nconst he = \"ERR_INVALID_VALUE\", me = \"ERR_UNEXPECTED_VALUE\", de = \"ERR_UNEXPECTED_TYPE\", K = \"ERR_PARSE\";\nfunction V(e, t) {\n  const r = {};\n  for (const n in e) {\n    const o = e[n];\n    if (!o)\n      continue;\n    let s, a;\n    typeof o == \"function\" ? (s = n, a = o) : [s, a] = o;\n    try {\n      const c = a(t(s));\n      c !== void 0 && (r[n] = c);\n    } catch (c) {\n      throw new d(\n        K,\n        `Parser for \"${n}\" property failed${s === n ? \"\" : `. Source field: \"${s}\"`}`,\n        c\n      );\n    }\n  }\n  return r;\n}\nfunction Z(e) {\n  let t = e;\n  if (typeof t == \"string\")\n    try {\n      t = JSON.parse(t);\n    } catch (r) {\n      throw new d(he, { cause: r });\n    }\n  if (typeof t != \"object\" || !t || Array.isArray(t))\n    throw new d(me);\n  return t;\n}\nfunction g(e, t) {\n  return (r) => {\n    const n = (o) => {\n      if (!(r && o === void 0))\n        try {\n          return t(o);\n        } catch (s) {\n          throw new d(K, {\n            message: `\"${e}\" transformer failed to parse the value`,\n            cause: s\n          });\n        }\n    };\n    return /* @__PURE__ */ Object.assign(\n      n,\n      {\n        isValid(o) {\n          try {\n            return n(o), !0;\n          } catch {\n            return !1;\n          }\n        }\n      }\n    );\n  };\n}\nfunction l(e, t) {\n  return g(t || \"object\", (r) => {\n    const n = Z(r);\n    return V(e, (o) => n[o]);\n  });\n}\nfunction R(e) {\n  throw new d(de, `Unexpected value received: ${JSON.stringify(e)}`);\n}\nconst $ = g(\"boolean\", (e) => {\n  if (typeof e == \"boolean\")\n    return e;\n  const t = String(e);\n  if (t === \"1\" || t === \"true\")\n    return !0;\n  if (t === \"0\" || t === \"false\")\n    return !1;\n  R(e);\n}), _ = g(\"string\", (e) => {\n  if (typeof e == \"string\" || typeof e == \"number\")\n    return e.toString();\n  R(e);\n}), P = g(\"number\", (e) => {\n  if (typeof e == \"number\")\n    return e;\n  if (typeof e == \"string\") {\n    const t = Number(e);\n    if (!Number.isNaN(t))\n      return t;\n  }\n  R(e);\n}), Ee = g(\"date\", (e) => e instanceof Date ? e : new Date(P()(e) * 1e3));\nfunction z(e, t) {\n  return g(t || \"searchParams\", (r) => {\n    typeof r != \"string\" && !(r instanceof URLSearchParams) && R(r);\n    const n = typeof r == \"string\" ? new URLSearchParams(r) : r;\n    return V(e, (o) => {\n      const s = n.get(o);\n      return s === null ? void 0 : s;\n    });\n  });\n}\nfunction j(e) {\n  for (const t in e)\n    e[t] = [G(t), e[t]];\n  return e;\n}\nconst ye = (e) => {\n  const t = P(), r = P(!0), n = _(), o = _(!0), s = $(!0), a = l(j({\n    addedToAttachmentMenu: s,\n    allowsWriteToPm: s,\n    firstName: n,\n    id: t,\n    isBot: s,\n    isPremium: s,\n    languageCode: o,\n    lastName: o,\n    photoUrl: o,\n    username: o\n  }), \"User\")(!0);\n  return z(\n    j({\n      authDate: Ee(),\n      canSendAfter: r,\n      chat: l(\n        j({\n          id: t,\n          type: n,\n          title: n,\n          photoUrl: o,\n          username: o\n        }),\n        \"Chat\"\n      )(!0),\n      chatInstance: o,\n      chatType: o,\n      hash: n,\n      queryId: o,\n      receiver: a,\n      startParam: o,\n      signature: n,\n      user: a\n    }),\n    \"initData\"\n  )(e);\n};\nfunction ve(e) {\n  return /^#[\\da-f]{6}$/i.test(e);\n}\nfunction Pe(e) {\n  return /^#[\\da-f]{3}$/i.test(e);\n}\nfunction Re(e) {\n  const t = e.replace(/\\s/g, \"\").toLowerCase();\n  if (ve(t))\n    return t;\n  if (Pe(t)) {\n    let n = \"#\";\n    for (let o = 0; o < 3; o += 1)\n      n += t[1 + o].repeat(2);\n    return n;\n  }\n  const r = t.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/) || t.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n  if (!r)\n    throw new Error(`Value \"${e}\" does not satisfy any of known RGB formats.`);\n  return r.slice(1).reduce((n, o) => {\n    const s = parseInt(o, 10).toString(16);\n    return n + (s.length === 1 ? \"0\" : \"\") + s;\n  }, \"#\");\n}\nconst Te = g(\"rgb\", (e) => Re(_()(e))), I = g(\n  \"themeParams\",\n  (e) => {\n    const t = Te(!0);\n    return Object.entries(Z(e)).reduce((r, [n, o]) => (r[we(n)] = t(o), r), {});\n  }\n);\n// @__NO_SIDE_EFFECTS__\nfunction W(e) {\n  return JSON.stringify(\n    Object.fromEntries(\n      Object.entries(e).map(([t, r]) => [G(t), r])\n    )\n  );\n}\nconst Ae = (e) => {\n  const t = _(), r = _(!0), n = $(!0);\n  return z({\n    botInline: [\"tgWebAppBotInline\", n],\n    defaultColors: [\"tgWebAppDefaultColors\", I(!0)],\n    fullscreen: [\"tgWebAppFullscreen\", n],\n    initData: [\"tgWebAppData\", ye(!0)],\n    initDataRaw: [\"tgWebAppData\", r],\n    platform: [\"tgWebAppPlatform\", t],\n    showSettings: [\"tgWebAppShowSettings\", n],\n    startParam: [\"tgWebAppStartParam\", r],\n    themeParams: [\"tgWebAppThemeParams\", I()],\n    version: [\"tgWebAppVersion\", t]\n  }, \"launchParams\")(e);\n};\n// @__NO_SIDE_EFFECTS__\nfunction Se(e) {\n  const {\n    initDataRaw: t,\n    startParam: r,\n    showSettings: n,\n    botInline: o,\n    fullscreen: s,\n    defaultColors: a\n  } = e, c = new URLSearchParams();\n  return c.set(\"tgWebAppPlatform\", e.platform), c.set(\"tgWebAppThemeParams\", /* @__PURE__ */ W(e.themeParams)), c.set(\"tgWebAppVersion\", e.version), t && c.set(\"tgWebAppData\", t), r && c.set(\"tgWebAppStartParam\", r), typeof n == \"boolean\" && c.set(\"tgWebAppShowSettings\", n ? \"1\" : \"0\"), typeof o == \"boolean\" && c.set(\"tgWebAppBotInline\", o ? \"1\" : \"0\"), typeof s == \"boolean\" && c.set(\"tgWebAppFullscreen\", s ? \"1\" : \"0\"), a && c.set(\"tgWebAppDefaultColors\", /* @__PURE__ */ W(a)), c.toString();\n}\nconst X = l({\n  eventType: _(),\n  eventData: (e) => e\n}, \"miniAppsMessage\"), Y = g(\"fn\", (e) => {\n  if (typeof e == \"function\")\n    return e;\n  R(e);\n});\nfunction $e(e) {\n  return !!e && typeof e == \"object\" && !Array.isArray(e);\n}\nconst Ce = l({\n  TelegramWebviewProxy: l({ postEvent: Y() })()\n});\nfunction Q(e) {\n  return Ce().isValid(e);\n}\nfunction Ne() {\n  try {\n    return window.self !== window.top;\n  } catch {\n    return !0;\n  }\n}\nvar De = Object.defineProperty, je = (e, t, r) => t in e ? De(e, t, { enumerable: !0, configurable: !0, writable: !0, value: r }) : e[t] = r, ee = (e, t, r) => je(e, typeof t != \"symbol\" ? t + \"\" : t, r);\nclass b extends Error {\n  constructor(t, r, n) {\n    super(\n      typeof r == \"object\" ? r.message : r || t,\n      {\n        cause: typeof r == \"object\" ? r.cause : n\n      }\n    ), this.type = t, this.name = \"TypedError\", Object.setPrototypeOf(this, b.prototype);\n  }\n}\nfunction te(e, t, r) {\n  return e.addEventListener(t, r), () => e.removeEventListener(t, r);\n}\nfunction k(...e) {\n  const t = e.flat(1);\n  return [\n    t.push.bind(t),\n    () => {\n      t.forEach((r) => {\n        r();\n      });\n    }\n  ];\n}\nfunction Ue(e, t) {\n  return e instanceof b && e.type === t;\n}\nfunction L(e) {\n  return (t) => Ue(t, e);\n}\nconst re = \"ERR_ABORTED\", ne = \"ERR_CANCELED\", oe = \"ERR_TIMED_OUT\";\nfunction M(e) {\n  return new b(re, { cause: e });\n}\nconst nt = L(oe), ot = L(re), st = L(ne);\nfunction F(e, t) {\n  return e.reject = t.reject, e;\n}\nclass w extends Promise {\n  constructor(t, r) {\n    let n, o;\n    typeof t == \"function\" ? (n = t, o = r) : o = t;\n    let s, a;\n    super((c, i) => {\n      o || (o = {});\n      const { abortSignal: u } = o;\n      if (u && u.aborted)\n        return i(M(u.reason));\n      const [f, h] = k(), m = (E) => (...ge) => (h(), E(...ge)), T = new AbortController(), { signal: A } = T;\n      a = m((E) => {\n        T.abort(E), i(E);\n      }), s = m(c), u && f(\n        te(u, \"abort\", () => {\n          a(M(u.reason));\n        })\n      );\n      const { timeout: D } = o;\n      if (D) {\n        const E = setTimeout(() => {\n          a(new b(oe, `Timeout reached: ${D}ms`));\n        }, D);\n        f(() => {\n          clearTimeout(E);\n        });\n      }\n      n && n(s, a, A);\n    }), ee(this, \"reject\"), this.reject = a;\n  }\n  /**\n   * Creates a new BetterPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, r) {\n    return new w((n, o, s) => {\n      try {\n        const a = t(s);\n        return a instanceof Promise ? a.then(n, o) : n(a);\n      } catch (a) {\n        o(a);\n      }\n    }, r);\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new w((r) => {\n      r(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new w((r, n) => {\n      n(t);\n    });\n  }\n  /**\n   * Cancels the promise execution.\n   */\n  cancel() {\n    this.reject(new b(ne));\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return F(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, r) {\n    return F(super.then(t, r), this);\n  }\n}\nfunction J(e, t) {\n  return e.resolve = t.resolve, e;\n}\nclass S extends w {\n  constructor(t, r) {\n    let n, o;\n    typeof t == \"function\" ? (n = t, o = r) : o = t;\n    let s;\n    super((a, c, i) => {\n      s = a, n && n(a, c, i);\n    }, o), ee(this, \"resolve\"), this.resolve = s;\n  }\n  /**\n   * Creates a new EnhancedPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, r) {\n    return new S(\n      (n, o, s) => w.withFn(t, { abortSignal: s }).then(n, o),\n      r\n    );\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new S((r) => {\n      r(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new S((r, n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return J(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, r) {\n    return J(super.then(t, r), this);\n  }\n}\nfunction at(e, t) {\n  return new w((r) => {\n    setTimeout(r, e);\n  }, { abortSignal: t });\n}\nfunction se(e) {\n  return `tapps/${e}`;\n}\nfunction We(e, t) {\n  sessionStorage.setItem(se(e), JSON.stringify(t));\n}\nfunction xe(e) {\n  const t = sessionStorage.getItem(se(e));\n  try {\n    return t ? JSON.parse(t) : void 0;\n  } catch {\n  }\n}\nfunction ct(e) {\n  return e.replace(/[A-Z]/g, (t) => `-${t.toLowerCase()}`);\n}\nfunction it(e) {\n  return e.replace(/[A-Z]/g, (t) => `_${t.toLowerCase()}`);\n}\nfunction ut(e) {\n  return e.replace(/_[a-z]/g, (t) => t[1].toUpperCase());\n}\n// @__NO_SIDE_EFFECTS__\nfunction ke(e, t) {\n  t || (t = {});\n  const {\n    textColor: r,\n    bgColor: n,\n    shouldLog: o = !0\n  } = t;\n  function s(a, ...c) {\n    if (!o || typeof o == \"function\" && !o())\n      return;\n    const i = \"font-weight:bold;padding:0 5px;border-radius:5px\";\n    console[a](\n      `%c${Intl.DateTimeFormat(\"en-GB\", {\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        second: \"2-digit\",\n        fractionalSecondDigits: 3,\n        timeZone: \"UTC\"\n      }).format(/* @__PURE__ */ new Date())}%c / %c${e}`,\n      `${i};background-color: lightblue;color:black`,\n      \"\",\n      `${i};${r ? `color:${r};` : \"\"}${n ? `background-color:${n}` : \"\"}`,\n      ...c\n    );\n  }\n  return [\n    function(...a) {\n      s(\"log\", ...a);\n    },\n    function(...a) {\n      s(\"error\", ...a);\n    }\n  ];\n}\nfunction pt(e, t) {\n  document.documentElement.style.setProperty(e, t);\n}\nfunction ft(e) {\n  document.documentElement.style.removeProperty(e);\n}\nfunction Le(e, t) {\n  t();\n}\n// @__NO_SIDE_EFFECTS__\nfunction y(e, t) {\n  t || (t = {});\n  const r = t.equals || Object.is;\n  let n = [], o = e;\n  const s = (u) => {\n    if (!r(o, u)) {\n      const f = o;\n      o = u, Le(i, () => {\n        [...n].forEach(([h, m]) => {\n          h(u, f), m && c(h, !0);\n        });\n      });\n    }\n  };\n  function a(u) {\n    const f = typeof u != \"object\" ? { once: u } : u;\n    return {\n      once: f.once || !1,\n      signal: f.signal || !1\n    };\n  }\n  const c = (u, f) => {\n    const h = a(f), m = n.findIndex(([T, A]) => T === u && A.once === h.once && A.signal === h.signal);\n    m >= 0 && n.splice(m, 1);\n  }, i = Object.assign(\n    function() {\n      return Oe(i), o;\n    },\n    {\n      destroy() {\n        n = [];\n      },\n      set: s,\n      reset() {\n        s(e);\n      },\n      sub(u, f) {\n        return n.push([u, a(f)]), () => c(u, f);\n      },\n      unsub: c,\n      unsubAll() {\n        n = n.filter((u) => u[1].signal);\n      }\n    }\n  );\n  return i;\n}\nconst U = [];\nfunction Oe(e) {\n  U.length && U[U.length - 1].add(e);\n}\nconst ae = /* @__PURE__ */ y(!1), [O, qe] = /* @__PURE__ */ ke(\"Bridge\", {\n  bgColor: \"#9147ff\",\n  textColor: \"white\",\n  shouldLog: ae\n}), Ie = {\n  clipboard_text_received: l({\n    req_id: _(),\n    data: (e) => e === null ? e : _(!0)(e)\n  }, \"clipboard_text_received\"),\n  custom_method_invoked: l({\n    req_id: _(),\n    result: (e) => e,\n    error: _(!0)\n  }, \"custom_method_invoked\"),\n  popup_closed: g(\"popup_closed\", (e) => e ? l({\n    button_id: (t) => t == null ? void 0 : _()(t)\n  })()(e) : {}),\n  viewport_changed: l({\n    height: P(),\n    width: (e) => e == null ? window.innerWidth : P()(e),\n    is_state_stable: $(),\n    is_expanded: $()\n  }, \"viewport_changed\")\n};\nfunction Me(e) {\n  const t = window, [, r] = k(\n    // Add listener, which handles events sent from the Telegram web application and also events\n    // generated by the local emitEvent function.\n    te(t, \"message\", (n) => {\n      if (n.source !== t.parent)\n        return;\n      let o;\n      try {\n        o = X()(n.data);\n      } catch {\n        return;\n      }\n      const { eventType: s, eventData: a } = o, c = Ie[s];\n      try {\n        const i = c ? c()(a) : a;\n        O(\"Event received:\", i ? { eventType: s, eventData: i } : { eventType: s }), e([s, i]);\n      } catch (i) {\n        qe(\n          [\n            `An error occurred processing the \"${s}\" event from the Telegram application.`,\n            \"Please, file an issue here:\",\n            \"https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose\"\n          ].join(`\n`),\n          o,\n          i\n        );\n      }\n    })\n  );\n  return r;\n}\nconst C = /* @__PURE__ */ y(), N = /* @__PURE__ */ y();\nfunction ce() {\n  return N() || N.set(Me(C.set)), C;\n}\nconst v = /* @__PURE__ */ y({});\nfunction ie(e) {\n  let t = v()[e];\n  return t || (t = /* @__PURE__ */ y(void 0, {\n    equals() {\n      return !1;\n    }\n  }), ce().sub((r) => {\n    r && r[0] === e && t.set(r[1]);\n  }), v.set({ ...v(), [e]: t })), t;\n}\nfunction Fe(e, t, r) {\n  return ie(e).sub(t, r);\n}\nconst Je = \"ERR_METHOD_UNSUPPORTED\", Be = \"ERR_RETRIEVE_LP_FAILED\", He = \"ERR_METHOD_PARAMETER_UNSUPPORTED\", Ge = \"ERR_UNKNOWN_ENV\", Ke = \"ERR_INVOKE_CUSTOM_METHOD_RESPONSE\", ue = /* @__PURE__ */ y(\"https://web.telegram.org\");\nfunction pe(e, t) {\n  O(\"Posting event:\", t ? { eventType: e, eventData: t } : { eventType: e });\n  const r = window;\n  if (Q(r)) {\n    r.TelegramWebviewProxy.postEvent(e, JSON.stringify(t));\n    return;\n  }\n  const n = JSON.stringify({ eventType: e, eventData: t });\n  if (Ne())\n    return r.parent.postMessage(n, ue());\n  const { external: o } = r;\n  if (l({ notify: Y() })().isValid(o)) {\n    o.notify(n);\n    return;\n  }\n  throw new b(Ge);\n}\nfunction fe(e, t, r) {\n  r || (r = {});\n  const { capture: n } = r, [o, s] = k();\n  return new w((a) => {\n    (Array.isArray(t) ? t : [t]).forEach((c) => {\n      o(\n        Fe(c, (i) => {\n          (!n || (Array.isArray(t) ? n({\n            event: c,\n            payload: i\n          }) : n(i))) && a(i);\n        })\n      );\n    }), (r.postEvent || pe)(e, r.params);\n  }, r).finally(s);\n}\nfunction q(e) {\n  return Ae()(e);\n}\nfunction _e(e) {\n  return q(\n    e.replace(/^[^?#]*[?#]/, \"\").replace(/[?#]/g, \"&\")\n  );\n}\nfunction Ve() {\n  return _e(window.location.href);\n}\nfunction Ze() {\n  const e = performance.getEntriesByType(\"navigation\")[0];\n  if (!e)\n    throw new Error(\"Unable to get first navigation entry.\");\n  return _e(e.name);\n}\nconst ze = \"launchParams\";\nfunction Xe() {\n  return q(xe(ze) || \"\");\n}\nfunction le(e) {\n  We(\"launchParams\", /* @__PURE__ */ Se(e));\n}\nfunction be(e) {\n  return e instanceof Error ? e.message + (e.cause ? `\n  ${be(e.cause)}` : \"\") : JSON.stringify(e);\n}\nfunction Ye() {\n  const e = [];\n  for (const t of [\n    // Try to retrieve launch parameters from the current location. This method can return\n    // nothing in case, location was changed, and then the page was reloaded.\n    Ve,\n    // Then, try using the lower level API - window.performance.\n    Ze,\n    // Finally, try to extract launch parameters from the session storage.\n    Xe\n  ])\n    try {\n      const r = t();\n      return le(r), r;\n    } catch (r) {\n      e.push(r);\n    }\n  throw new b(Be, [\n    \"Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?\",\n    \"📖 Refer to docs for more information:\",\n    \"https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment\",\n    \"Collected errors:\",\n    ...e.map((t) => `— ${be(t)}`)\n  ].join(`\n`));\n}\nfunction _t(e) {\n  if (e === \"simple\")\n    try {\n      return Ye(), !0;\n    } catch {\n      return !1;\n    }\n  return w.withFn(async () => {\n    if (Q(window))\n      return !0;\n    try {\n      return await fe(\"web_app_request_theme\", \"theme_changed\", { timeout: 100 }), !0;\n    } catch {\n      return !1;\n    }\n  }, e);\n}\nfunction x(e, t) {\n  window.dispatchEvent(new MessageEvent(\"message\", {\n    data: JSON.stringify({ eventType: e, eventData: t }),\n    // We specify window.parent to imitate the case, the parent iframe sent us this event.\n    source: window.parent\n  }));\n}\nfunction Qe(e, t) {\n  if (typeof t == \"string\")\n    try {\n      const { eventType: r } = X()(t);\n      r === \"web_app_request_theme\" && x(\"theme_changed\", {\n        theme_params: JSON.parse(/* @__PURE__ */ W(e))\n      }), r === \"web_app_request_viewport\" && x(\"viewport_changed\", {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        is_state_stable: !0,\n        is_expanded: !0\n      });\n    } catch {\n    }\n}\nfunction lt(e) {\n  var n;\n  const t = typeof e == \"string\" ? q(e) : e;\n  le(t);\n  const r = (n = window.TelegramWebviewProxy) == null ? void 0 : n.postEvent;\n  window.TelegramWebviewProxy = {\n    postEvent(o, s) {\n      Qe(t.themeParams, JSON.stringify({ eventType: o, eventData: s })), r == null || r(o, s);\n    }\n  }, O(\"Environment was mocked by the mockTelegramEnv function\");\n}\nfunction bt() {\n  [\n    [\"TelegramGameProxy_receiveEvent\"],\n    // Windows Phone.\n    [\"TelegramGameProxy\", \"receiveEvent\"],\n    // Desktop.\n    [\"Telegram\", \"WebView\", \"receiveEvent\"]\n    // Android and iOS.\n  ].forEach((e) => {\n    let t = window;\n    e.forEach((r, n, o) => {\n      if (n === o.length - 1) {\n        t[r] = x;\n        return;\n      }\n      r in t || (t[r] = {}), t = t[r];\n    });\n  });\n}\nfunction gt() {\n  [\"TelegramGameProxy_receiveEvent\", \"TelegramGameProxy\", \"Telegram\"].forEach((e) => {\n    delete window[e];\n  });\n}\nfunction wt(e, t, r) {\n  ie(e).unsub(t, r);\n}\nfunction ht(e, t) {\n  return ce().sub(e, t);\n}\nfunction mt(e, t) {\n  C.unsub(e, t);\n}\nfunction et(e) {\n  return ({ req_id: t }) => t === e;\n}\nfunction B(e) {\n  return e.split(\".\").map(Number);\n}\nfunction tt(e, t) {\n  const r = B(e), n = B(t), o = Math.max(r.length, n.length);\n  for (let s = 0; s < o; s += 1) {\n    const a = r[s] || 0, c = n[s] || 0;\n    if (a !== c)\n      return a > c ? 1 : -1;\n  }\n  return 0;\n}\nfunction p(e, t) {\n  return tt(e, t) <= 0;\n}\nfunction H(e, t, r) {\n  if (typeof r == \"string\") {\n    if (e === \"web_app_open_link\") {\n      if (t === \"try_instant_view\")\n        return p(\"6.4\", r);\n      if (t === \"try_browser\")\n        return p(\"7.6\", r);\n    }\n    if (e === \"web_app_set_header_color\" && t === \"color\")\n      return p(\"6.9\", r);\n    if (e === \"web_app_close\" && t === \"return_back\")\n      return p(\"7.6\", r);\n    if (e === \"web_app_setup_main_button\" && t === \"has_shine_effect\")\n      return p(\"7.10\", r);\n  }\n  switch (e) {\n    case \"web_app_open_tg_link\":\n    case \"web_app_open_invoice\":\n    case \"web_app_setup_back_button\":\n    case \"web_app_set_background_color\":\n    case \"web_app_set_header_color\":\n    case \"web_app_trigger_haptic_feedback\":\n      return p(\"6.1\", t);\n    case \"web_app_open_popup\":\n      return p(\"6.2\", t);\n    case \"web_app_close_scan_qr_popup\":\n    case \"web_app_open_scan_qr_popup\":\n    case \"web_app_read_text_from_clipboard\":\n      return p(\"6.4\", t);\n    case \"web_app_switch_inline_query\":\n      return p(\"6.7\", t);\n    case \"web_app_invoke_custom_method\":\n    case \"web_app_request_write_access\":\n    case \"web_app_request_phone\":\n      return p(\"6.9\", t);\n    case \"web_app_setup_settings_button\":\n      return p(\"6.10\", t);\n    case \"web_app_biometry_get_info\":\n    case \"web_app_biometry_open_settings\":\n    case \"web_app_biometry_request_access\":\n    case \"web_app_biometry_request_auth\":\n    case \"web_app_biometry_update_token\":\n      return p(\"7.2\", t);\n    case \"web_app_setup_swipe_behavior\":\n      return p(\"7.7\", t);\n    case \"web_app_share_to_story\":\n      return p(\"7.8\", t);\n    case \"web_app_setup_secondary_button\":\n    case \"web_app_set_bottom_bar_color\":\n      return p(\"7.10\", t);\n    case \"web_app_request_safe_area\":\n    case \"web_app_request_content_safe_area\":\n    case \"web_app_request_fullscreen\":\n    case \"web_app_exit_fullscreen\":\n    case \"web_app_set_emoji_status\":\n    case \"web_app_add_to_home_screen\":\n    case \"web_app_check_home_screen\":\n    case \"web_app_request_emoji_status_access\":\n      return p(\"8.0\", t);\n    default:\n      return [\n        \"iframe_ready\",\n        \"iframe_will_reload\",\n        \"web_app_close\",\n        \"web_app_data_send\",\n        \"web_app_expand\",\n        \"web_app_open_link\",\n        \"web_app_ready\",\n        \"web_app_request_theme\",\n        \"web_app_request_viewport\",\n        \"web_app_setup_main_button\",\n        \"web_app_setup_closing_behavior\"\n      ].includes(e);\n  }\n}\nfunction dt(e, t) {\n  t || (t = \"strict\");\n  const r = typeof t == \"function\" ? t : (n) => {\n    const { method: o, version: s } = n;\n    let a, c;\n    if (\"param\" in n ? (a = `Parameter \"${n.param}\" of \"${o}\" method is unsupported in Mini Apps version ${s}`, c = He) : (a = `Method \"${o}\" is unsupported in Mini Apps version ${s}`, c = Je), t === \"strict\")\n      throw new b(c, a);\n    return console.warn(a);\n  };\n  return (n, o) => H(n, e) ? $e(o) && n === \"web_app_set_header_color\" && \"color\" in o && !H(n, \"color\", e) ? r({ version: e, method: n, param: \"color\" }) : pe(n, o) : r({ version: e, method: n });\n}\nfunction Et(e, t, r, n) {\n  return fe(\"web_app_invoke_custom_method\", \"custom_method_invoked\", {\n    ...n || {},\n    params: { method: e, params: t, req_id: r },\n    capture: et(r)\n  }).then(({ result: o, error: s }) => {\n    if (s)\n      throw new b(Ke, s);\n    return o;\n  });\n}\nfunction rt(e) {\n  e.unsubAll(), e.reset();\n}\nfunction yt() {\n  var e;\n  (e = N()) == null || e(), [\n    ...Object.values(v()),\n    v,\n    C,\n    N,\n    ue,\n    ae\n  ].forEach(rt);\n}\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvZGFwcC1zZGsvbm9kZV9tb2R1bGVzL0B0ZWxlZ3JhbS1hcHBzL2JyaWRnZS9kaXN0L2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGdCQUFnQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsdUJBQXVCLEVBQUUsbUJBQW1CLG1DQUFtQyxFQUFFLEdBQUc7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTix3QkFBd0IsVUFBVTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EseUJBQXlCLEVBQUU7QUFDM0I7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxnREFBZ0Qsa0JBQWtCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQSxrQkFBa0IsT0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdCQUF3QjtBQUNwQztBQUNBLDBDQUEwQyxRQUFRLFFBQVEsRUFBRSwrQ0FBK0MsRUFBRSw2QkFBNkIsRUFBRSx3Q0FBd0MsRUFBRTtBQUN0TDtBQUNBO0FBQ0E7QUFDQSxrSEFBa0gsdUNBQXVDLG1CQUFtQix1QkFBdUI7QUFDbk07QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkLGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0EsR0FBRyxVQUFVLHFCQUFxQjtBQUNsQztBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbURFO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcc2hyYXZcXGFpLmFwdC1tZXRhbW92ZS1oYWNrYXRob25cXGZyb250ZWRcXG5vZGVfbW9kdWxlc1xcQGlkZW50aXR5LWNvbm5lY3RcXGRhcHAtc2RrXFxub2RlX21vZHVsZXNcXEB0ZWxlZ3JhbS1hcHBzXFxicmlkZ2VcXGRpc3RcXGluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIGQgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHQsIHIsIG4pIHtcbiAgICBzdXBlcihcbiAgICAgIHR5cGVvZiByID09IFwib2JqZWN0XCIgPyByLm1lc3NhZ2UgOiByIHx8IHQsXG4gICAgICB7XG4gICAgICAgIGNhdXNlOiB0eXBlb2YgciA9PSBcIm9iamVjdFwiID8gci5jYXVzZSA6IG5cbiAgICAgIH1cbiAgICApLCB0aGlzLnR5cGUgPSB0LCB0aGlzLm5hbWUgPSBcIlR5cGVkRXJyb3JcIiwgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIGQucHJvdG90eXBlKTtcbiAgfVxufVxuZnVuY3Rpb24gRyhlKSB7XG4gIHJldHVybiBlLnJlcGxhY2UoL1tBLVpdL2csICh0KSA9PiBgXyR7dC50b0xvd2VyQ2FzZSgpfWApO1xufVxuZnVuY3Rpb24gd2UoZSkge1xuICByZXR1cm4gZS5yZXBsYWNlKC9fW2Etel0vZywgKHQpID0+IHRbMV0udG9VcHBlckNhc2UoKSk7XG59XG5jb25zdCBoZSA9IFwiRVJSX0lOVkFMSURfVkFMVUVcIiwgbWUgPSBcIkVSUl9VTkVYUEVDVEVEX1ZBTFVFXCIsIGRlID0gXCJFUlJfVU5FWFBFQ1RFRF9UWVBFXCIsIEsgPSBcIkVSUl9QQVJTRVwiO1xuZnVuY3Rpb24gVihlLCB0KSB7XG4gIGNvbnN0IHIgPSB7fTtcbiAgZm9yIChjb25zdCBuIGluIGUpIHtcbiAgICBjb25zdCBvID0gZVtuXTtcbiAgICBpZiAoIW8pXG4gICAgICBjb250aW51ZTtcbiAgICBsZXQgcywgYTtcbiAgICB0eXBlb2YgbyA9PSBcImZ1bmN0aW9uXCIgPyAocyA9IG4sIGEgPSBvKSA6IFtzLCBhXSA9IG87XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGMgPSBhKHQocykpO1xuICAgICAgYyAhPT0gdm9pZCAwICYmIChyW25dID0gYyk7XG4gICAgfSBjYXRjaCAoYykge1xuICAgICAgdGhyb3cgbmV3IGQoXG4gICAgICAgIEssXG4gICAgICAgIGBQYXJzZXIgZm9yIFwiJHtufVwiIHByb3BlcnR5IGZhaWxlZCR7cyA9PT0gbiA/IFwiXCIgOiBgLiBTb3VyY2UgZmllbGQ6IFwiJHtzfVwiYH1gLFxuICAgICAgICBjXG4gICAgICApO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcjtcbn1cbmZ1bmN0aW9uIFooZSkge1xuICBsZXQgdCA9IGU7XG4gIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKVxuICAgIHRyeSB7XG4gICAgICB0ID0gSlNPTi5wYXJzZSh0KTtcbiAgICB9IGNhdGNoIChyKSB7XG4gICAgICB0aHJvdyBuZXcgZChoZSwgeyBjYXVzZTogciB9KTtcbiAgICB9XG4gIGlmICh0eXBlb2YgdCAhPSBcIm9iamVjdFwiIHx8ICF0IHx8IEFycmF5LmlzQXJyYXkodCkpXG4gICAgdGhyb3cgbmV3IGQobWUpO1xuICByZXR1cm4gdDtcbn1cbmZ1bmN0aW9uIGcoZSwgdCkge1xuICByZXR1cm4gKHIpID0+IHtcbiAgICBjb25zdCBuID0gKG8pID0+IHtcbiAgICAgIGlmICghKHIgJiYgbyA9PT0gdm9pZCAwKSlcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gdChvKTtcbiAgICAgICAgfSBjYXRjaCAocykge1xuICAgICAgICAgIHRocm93IG5ldyBkKEssIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBcIiR7ZX1cIiB0cmFuc2Zvcm1lciBmYWlsZWQgdG8gcGFyc2UgdGhlIHZhbHVlYCxcbiAgICAgICAgICAgIGNhdXNlOiBzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmFzc2lnbihcbiAgICAgIG4sXG4gICAgICB7XG4gICAgICAgIGlzVmFsaWQobykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbihvKSwgITA7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGwoZSwgdCkge1xuICByZXR1cm4gZyh0IHx8IFwib2JqZWN0XCIsIChyKSA9PiB7XG4gICAgY29uc3QgbiA9IFoocik7XG4gICAgcmV0dXJuIFYoZSwgKG8pID0+IG5bb10pO1xuICB9KTtcbn1cbmZ1bmN0aW9uIFIoZSkge1xuICB0aHJvdyBuZXcgZChkZSwgYFVuZXhwZWN0ZWQgdmFsdWUgcmVjZWl2ZWQ6ICR7SlNPTi5zdHJpbmdpZnkoZSl9YCk7XG59XG5jb25zdCAkID0gZyhcImJvb2xlYW5cIiwgKGUpID0+IHtcbiAgaWYgKHR5cGVvZiBlID09IFwiYm9vbGVhblwiKVxuICAgIHJldHVybiBlO1xuICBjb25zdCB0ID0gU3RyaW5nKGUpO1xuICBpZiAodCA9PT0gXCIxXCIgfHwgdCA9PT0gXCJ0cnVlXCIpXG4gICAgcmV0dXJuICEwO1xuICBpZiAodCA9PT0gXCIwXCIgfHwgdCA9PT0gXCJmYWxzZVwiKVxuICAgIHJldHVybiAhMTtcbiAgUihlKTtcbn0pLCBfID0gZyhcInN0cmluZ1wiLCAoZSkgPT4ge1xuICBpZiAodHlwZW9mIGUgPT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgZSA9PSBcIm51bWJlclwiKVxuICAgIHJldHVybiBlLnRvU3RyaW5nKCk7XG4gIFIoZSk7XG59KSwgUCA9IGcoXCJudW1iZXJcIiwgKGUpID0+IHtcbiAgaWYgKHR5cGVvZiBlID09IFwibnVtYmVyXCIpXG4gICAgcmV0dXJuIGU7XG4gIGlmICh0eXBlb2YgZSA9PSBcInN0cmluZ1wiKSB7XG4gICAgY29uc3QgdCA9IE51bWJlcihlKTtcbiAgICBpZiAoIU51bWJlci5pc05hTih0KSlcbiAgICAgIHJldHVybiB0O1xuICB9XG4gIFIoZSk7XG59KSwgRWUgPSBnKFwiZGF0ZVwiLCAoZSkgPT4gZSBpbnN0YW5jZW9mIERhdGUgPyBlIDogbmV3IERhdGUoUCgpKGUpICogMWUzKSk7XG5mdW5jdGlvbiB6KGUsIHQpIHtcbiAgcmV0dXJuIGcodCB8fCBcInNlYXJjaFBhcmFtc1wiLCAocikgPT4ge1xuICAgIHR5cGVvZiByICE9IFwic3RyaW5nXCIgJiYgIShyIGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zKSAmJiBSKHIpO1xuICAgIGNvbnN0IG4gPSB0eXBlb2YgciA9PSBcInN0cmluZ1wiID8gbmV3IFVSTFNlYXJjaFBhcmFtcyhyKSA6IHI7XG4gICAgcmV0dXJuIFYoZSwgKG8pID0+IHtcbiAgICAgIGNvbnN0IHMgPSBuLmdldChvKTtcbiAgICAgIHJldHVybiBzID09PSBudWxsID8gdm9pZCAwIDogcztcbiAgICB9KTtcbiAgfSk7XG59XG5mdW5jdGlvbiBqKGUpIHtcbiAgZm9yIChjb25zdCB0IGluIGUpXG4gICAgZVt0XSA9IFtHKHQpLCBlW3RdXTtcbiAgcmV0dXJuIGU7XG59XG5jb25zdCB5ZSA9IChlKSA9PiB7XG4gIGNvbnN0IHQgPSBQKCksIHIgPSBQKCEwKSwgbiA9IF8oKSwgbyA9IF8oITApLCBzID0gJCghMCksIGEgPSBsKGooe1xuICAgIGFkZGVkVG9BdHRhY2htZW50TWVudTogcyxcbiAgICBhbGxvd3NXcml0ZVRvUG06IHMsXG4gICAgZmlyc3ROYW1lOiBuLFxuICAgIGlkOiB0LFxuICAgIGlzQm90OiBzLFxuICAgIGlzUHJlbWl1bTogcyxcbiAgICBsYW5ndWFnZUNvZGU6IG8sXG4gICAgbGFzdE5hbWU6IG8sXG4gICAgcGhvdG9Vcmw6IG8sXG4gICAgdXNlcm5hbWU6IG9cbiAgfSksIFwiVXNlclwiKSghMCk7XG4gIHJldHVybiB6KFxuICAgIGooe1xuICAgICAgYXV0aERhdGU6IEVlKCksXG4gICAgICBjYW5TZW5kQWZ0ZXI6IHIsXG4gICAgICBjaGF0OiBsKFxuICAgICAgICBqKHtcbiAgICAgICAgICBpZDogdCxcbiAgICAgICAgICB0eXBlOiBuLFxuICAgICAgICAgIHRpdGxlOiBuLFxuICAgICAgICAgIHBob3RvVXJsOiBvLFxuICAgICAgICAgIHVzZXJuYW1lOiBvXG4gICAgICAgIH0pLFxuICAgICAgICBcIkNoYXRcIlxuICAgICAgKSghMCksXG4gICAgICBjaGF0SW5zdGFuY2U6IG8sXG4gICAgICBjaGF0VHlwZTogbyxcbiAgICAgIGhhc2g6IG4sXG4gICAgICBxdWVyeUlkOiBvLFxuICAgICAgcmVjZWl2ZXI6IGEsXG4gICAgICBzdGFydFBhcmFtOiBvLFxuICAgICAgc2lnbmF0dXJlOiBuLFxuICAgICAgdXNlcjogYVxuICAgIH0pLFxuICAgIFwiaW5pdERhdGFcIlxuICApKGUpO1xufTtcbmZ1bmN0aW9uIHZlKGUpIHtcbiAgcmV0dXJuIC9eI1tcXGRhLWZdezZ9JC9pLnRlc3QoZSk7XG59XG5mdW5jdGlvbiBQZShlKSB7XG4gIHJldHVybiAvXiNbXFxkYS1mXXszfSQvaS50ZXN0KGUpO1xufVxuZnVuY3Rpb24gUmUoZSkge1xuICBjb25zdCB0ID0gZS5yZXBsYWNlKC9cXHMvZywgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgaWYgKHZlKHQpKVxuICAgIHJldHVybiB0O1xuICBpZiAoUGUodCkpIHtcbiAgICBsZXQgbiA9IFwiI1wiO1xuICAgIGZvciAobGV0IG8gPSAwOyBvIDwgMzsgbyArPSAxKVxuICAgICAgbiArPSB0WzEgKyBvXS5yZXBlYXQoMik7XG4gICAgcmV0dXJuIG47XG4gIH1cbiAgY29uc3QgciA9IHQubWF0Y2goL15yZ2JcXCgoXFxkezEsM30pLChcXGR7MSwzfSksKFxcZHsxLDN9KVxcKSQvKSB8fCB0Lm1hdGNoKC9ecmdiYVxcKChcXGR7MSwzfSksKFxcZHsxLDN9KSwoXFxkezEsM30pLFxcZHsxLDN9XFwpJC8pO1xuICBpZiAoIXIpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBWYWx1ZSBcIiR7ZX1cIiBkb2VzIG5vdCBzYXRpc2Z5IGFueSBvZiBrbm93biBSR0IgZm9ybWF0cy5gKTtcbiAgcmV0dXJuIHIuc2xpY2UoMSkucmVkdWNlKChuLCBvKSA9PiB7XG4gICAgY29uc3QgcyA9IHBhcnNlSW50KG8sIDEwKS50b1N0cmluZygxNik7XG4gICAgcmV0dXJuIG4gKyAocy5sZW5ndGggPT09IDEgPyBcIjBcIiA6IFwiXCIpICsgcztcbiAgfSwgXCIjXCIpO1xufVxuY29uc3QgVGUgPSBnKFwicmdiXCIsIChlKSA9PiBSZShfKCkoZSkpKSwgSSA9IGcoXG4gIFwidGhlbWVQYXJhbXNcIixcbiAgKGUpID0+IHtcbiAgICBjb25zdCB0ID0gVGUoITApO1xuICAgIHJldHVybiBPYmplY3QuZW50cmllcyhaKGUpKS5yZWR1Y2UoKHIsIFtuLCBvXSkgPT4gKHJbd2UobildID0gdChvKSwgciksIHt9KTtcbiAgfVxuKTtcbi8vIEBfX05PX1NJREVfRUZGRUNUU19fXG5mdW5jdGlvbiBXKGUpIHtcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KFxuICAgIE9iamVjdC5mcm9tRW50cmllcyhcbiAgICAgIE9iamVjdC5lbnRyaWVzKGUpLm1hcCgoW3QsIHJdKSA9PiBbRyh0KSwgcl0pXG4gICAgKVxuICApO1xufVxuY29uc3QgQWUgPSAoZSkgPT4ge1xuICBjb25zdCB0ID0gXygpLCByID0gXyghMCksIG4gPSAkKCEwKTtcbiAgcmV0dXJuIHooe1xuICAgIGJvdElubGluZTogW1widGdXZWJBcHBCb3RJbmxpbmVcIiwgbl0sXG4gICAgZGVmYXVsdENvbG9yczogW1widGdXZWJBcHBEZWZhdWx0Q29sb3JzXCIsIEkoITApXSxcbiAgICBmdWxsc2NyZWVuOiBbXCJ0Z1dlYkFwcEZ1bGxzY3JlZW5cIiwgbl0sXG4gICAgaW5pdERhdGE6IFtcInRnV2ViQXBwRGF0YVwiLCB5ZSghMCldLFxuICAgIGluaXREYXRhUmF3OiBbXCJ0Z1dlYkFwcERhdGFcIiwgcl0sXG4gICAgcGxhdGZvcm06IFtcInRnV2ViQXBwUGxhdGZvcm1cIiwgdF0sXG4gICAgc2hvd1NldHRpbmdzOiBbXCJ0Z1dlYkFwcFNob3dTZXR0aW5nc1wiLCBuXSxcbiAgICBzdGFydFBhcmFtOiBbXCJ0Z1dlYkFwcFN0YXJ0UGFyYW1cIiwgcl0sXG4gICAgdGhlbWVQYXJhbXM6IFtcInRnV2ViQXBwVGhlbWVQYXJhbXNcIiwgSSgpXSxcbiAgICB2ZXJzaW9uOiBbXCJ0Z1dlYkFwcFZlcnNpb25cIiwgdF1cbiAgfSwgXCJsYXVuY2hQYXJhbXNcIikoZSk7XG59O1xuLy8gQF9fTk9fU0lERV9FRkZFQ1RTX19cbmZ1bmN0aW9uIFNlKGUpIHtcbiAgY29uc3Qge1xuICAgIGluaXREYXRhUmF3OiB0LFxuICAgIHN0YXJ0UGFyYW06IHIsXG4gICAgc2hvd1NldHRpbmdzOiBuLFxuICAgIGJvdElubGluZTogbyxcbiAgICBmdWxsc2NyZWVuOiBzLFxuICAgIGRlZmF1bHRDb2xvcnM6IGFcbiAgfSA9IGUsIGMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gIHJldHVybiBjLnNldChcInRnV2ViQXBwUGxhdGZvcm1cIiwgZS5wbGF0Zm9ybSksIGMuc2V0KFwidGdXZWJBcHBUaGVtZVBhcmFtc1wiLCAvKiBAX19QVVJFX18gKi8gVyhlLnRoZW1lUGFyYW1zKSksIGMuc2V0KFwidGdXZWJBcHBWZXJzaW9uXCIsIGUudmVyc2lvbiksIHQgJiYgYy5zZXQoXCJ0Z1dlYkFwcERhdGFcIiwgdCksIHIgJiYgYy5zZXQoXCJ0Z1dlYkFwcFN0YXJ0UGFyYW1cIiwgciksIHR5cGVvZiBuID09IFwiYm9vbGVhblwiICYmIGMuc2V0KFwidGdXZWJBcHBTaG93U2V0dGluZ3NcIiwgbiA/IFwiMVwiIDogXCIwXCIpLCB0eXBlb2YgbyA9PSBcImJvb2xlYW5cIiAmJiBjLnNldChcInRnV2ViQXBwQm90SW5saW5lXCIsIG8gPyBcIjFcIiA6IFwiMFwiKSwgdHlwZW9mIHMgPT0gXCJib29sZWFuXCIgJiYgYy5zZXQoXCJ0Z1dlYkFwcEZ1bGxzY3JlZW5cIiwgcyA/IFwiMVwiIDogXCIwXCIpLCBhICYmIGMuc2V0KFwidGdXZWJBcHBEZWZhdWx0Q29sb3JzXCIsIC8qIEBfX1BVUkVfXyAqLyBXKGEpKSwgYy50b1N0cmluZygpO1xufVxuY29uc3QgWCA9IGwoe1xuICBldmVudFR5cGU6IF8oKSxcbiAgZXZlbnREYXRhOiAoZSkgPT4gZVxufSwgXCJtaW5pQXBwc01lc3NhZ2VcIiksIFkgPSBnKFwiZm5cIiwgKGUpID0+IHtcbiAgaWYgKHR5cGVvZiBlID09IFwiZnVuY3Rpb25cIilcbiAgICByZXR1cm4gZTtcbiAgUihlKTtcbn0pO1xuZnVuY3Rpb24gJGUoZSkge1xuICByZXR1cm4gISFlICYmIHR5cGVvZiBlID09IFwib2JqZWN0XCIgJiYgIUFycmF5LmlzQXJyYXkoZSk7XG59XG5jb25zdCBDZSA9IGwoe1xuICBUZWxlZ3JhbVdlYnZpZXdQcm94eTogbCh7IHBvc3RFdmVudDogWSgpIH0pKClcbn0pO1xuZnVuY3Rpb24gUShlKSB7XG4gIHJldHVybiBDZSgpLmlzVmFsaWQoZSk7XG59XG5mdW5jdGlvbiBOZSgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gd2luZG93LnNlbGYgIT09IHdpbmRvdy50b3A7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiAhMDtcbiAgfVxufVxudmFyIERlID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LCBqZSA9IChlLCB0LCByKSA9PiB0IGluIGUgPyBEZShlLCB0LCB7IGVudW1lcmFibGU6ICEwLCBjb25maWd1cmFibGU6ICEwLCB3cml0YWJsZTogITAsIHZhbHVlOiByIH0pIDogZVt0XSA9IHIsIGVlID0gKGUsIHQsIHIpID0+IGplKGUsIHR5cGVvZiB0ICE9IFwic3ltYm9sXCIgPyB0ICsgXCJcIiA6IHQsIHIpO1xuY2xhc3MgYiBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IodCwgciwgbikge1xuICAgIHN1cGVyKFxuICAgICAgdHlwZW9mIHIgPT0gXCJvYmplY3RcIiA/IHIubWVzc2FnZSA6IHIgfHwgdCxcbiAgICAgIHtcbiAgICAgICAgY2F1c2U6IHR5cGVvZiByID09IFwib2JqZWN0XCIgPyByLmNhdXNlIDogblxuICAgICAgfVxuICAgICksIHRoaXMudHlwZSA9IHQsIHRoaXMubmFtZSA9IFwiVHlwZWRFcnJvclwiLCBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgYi5wcm90b3R5cGUpO1xuICB9XG59XG5mdW5jdGlvbiB0ZShlLCB0LCByKSB7XG4gIHJldHVybiBlLmFkZEV2ZW50TGlzdGVuZXIodCwgciksICgpID0+IGUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LCByKTtcbn1cbmZ1bmN0aW9uIGsoLi4uZSkge1xuICBjb25zdCB0ID0gZS5mbGF0KDEpO1xuICByZXR1cm4gW1xuICAgIHQucHVzaC5iaW5kKHQpLFxuICAgICgpID0+IHtcbiAgICAgIHQuZm9yRWFjaCgocikgPT4ge1xuICAgICAgICByKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIF07XG59XG5mdW5jdGlvbiBVZShlLCB0KSB7XG4gIHJldHVybiBlIGluc3RhbmNlb2YgYiAmJiBlLnR5cGUgPT09IHQ7XG59XG5mdW5jdGlvbiBMKGUpIHtcbiAgcmV0dXJuICh0KSA9PiBVZSh0LCBlKTtcbn1cbmNvbnN0IHJlID0gXCJFUlJfQUJPUlRFRFwiLCBuZSA9IFwiRVJSX0NBTkNFTEVEXCIsIG9lID0gXCJFUlJfVElNRURfT1VUXCI7XG5mdW5jdGlvbiBNKGUpIHtcbiAgcmV0dXJuIG5ldyBiKHJlLCB7IGNhdXNlOiBlIH0pO1xufVxuY29uc3QgbnQgPSBMKG9lKSwgb3QgPSBMKHJlKSwgc3QgPSBMKG5lKTtcbmZ1bmN0aW9uIEYoZSwgdCkge1xuICByZXR1cm4gZS5yZWplY3QgPSB0LnJlamVjdCwgZTtcbn1cbmNsYXNzIHcgZXh0ZW5kcyBQcm9taXNlIHtcbiAgY29uc3RydWN0b3IodCwgcikge1xuICAgIGxldCBuLCBvO1xuICAgIHR5cGVvZiB0ID09IFwiZnVuY3Rpb25cIiA/IChuID0gdCwgbyA9IHIpIDogbyA9IHQ7XG4gICAgbGV0IHMsIGE7XG4gICAgc3VwZXIoKGMsIGkpID0+IHtcbiAgICAgIG8gfHwgKG8gPSB7fSk7XG4gICAgICBjb25zdCB7IGFib3J0U2lnbmFsOiB1IH0gPSBvO1xuICAgICAgaWYgKHUgJiYgdS5hYm9ydGVkKVxuICAgICAgICByZXR1cm4gaShNKHUucmVhc29uKSk7XG4gICAgICBjb25zdCBbZiwgaF0gPSBrKCksIG0gPSAoRSkgPT4gKC4uLmdlKSA9PiAoaCgpLCBFKC4uLmdlKSksIFQgPSBuZXcgQWJvcnRDb250cm9sbGVyKCksIHsgc2lnbmFsOiBBIH0gPSBUO1xuICAgICAgYSA9IG0oKEUpID0+IHtcbiAgICAgICAgVC5hYm9ydChFKSwgaShFKTtcbiAgICAgIH0pLCBzID0gbShjKSwgdSAmJiBmKFxuICAgICAgICB0ZSh1LCBcImFib3J0XCIsICgpID0+IHtcbiAgICAgICAgICBhKE0odS5yZWFzb24pKTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjb25zdCB7IHRpbWVvdXQ6IEQgfSA9IG87XG4gICAgICBpZiAoRCkge1xuICAgICAgICBjb25zdCBFID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgYShuZXcgYihvZSwgYFRpbWVvdXQgcmVhY2hlZDogJHtEfW1zYCkpO1xuICAgICAgICB9LCBEKTtcbiAgICAgICAgZigoKSA9PiB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KEUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIG4gJiYgbihzLCBhLCBBKTtcbiAgICB9KSwgZWUodGhpcywgXCJyZWplY3RcIiksIHRoaXMucmVqZWN0ID0gYTtcbiAgfVxuICAvKipcbiAgICogQ3JlYXRlcyBhIG5ldyBCZXR0ZXJQcm9taXNlIGluc3RhbmNlIHVzaW5nIGV4ZWN1dG9yLCByZXNvbHZpbmcgcHJvbWlzZSB3aGVuIGEgcmVzdWx0XG4gICAqIHdhcyByZXR1cm5lZC5cbiAgICogQHBhcmFtIGZuIC0gZnVuY3Rpb24gcmV0dXJuaW5nIHByb21pc2UgcmVzdWx0LlxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIGFkZGl0aW9uYWwgb3B0aW9ucy5cbiAgICovXG4gIHN0YXRpYyB3aXRoRm4odCwgcikge1xuICAgIHJldHVybiBuZXcgdygobiwgbywgcykgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYSA9IHQocyk7XG4gICAgICAgIHJldHVybiBhIGluc3RhbmNlb2YgUHJvbWlzZSA/IGEudGhlbihuLCBvKSA6IG4oYSk7XG4gICAgICB9IGNhdGNoIChhKSB7XG4gICAgICAgIG8oYSk7XG4gICAgICB9XG4gICAgfSwgcik7XG4gIH1cbiAgLyoqXG4gICAqIEBzZWUgUHJvbWlzZS5yZXNvbHZlXG4gICAqL1xuICBzdGF0aWMgcmVzb2x2ZSh0KSB7XG4gICAgcmV0dXJuIG5ldyB3KChyKSA9PiB7XG4gICAgICByKHQpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBAc2VlIFByb21pc2UucmVqZWN0XG4gICAqL1xuICBzdGF0aWMgcmVqZWN0KHQpIHtcbiAgICByZXR1cm4gbmV3IHcoKHIsIG4pID0+IHtcbiAgICAgIG4odCk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIENhbmNlbHMgdGhlIHByb21pc2UgZXhlY3V0aW9uLlxuICAgKi9cbiAgY2FuY2VsKCkge1xuICAgIHRoaXMucmVqZWN0KG5ldyBiKG5lKSk7XG4gIH1cbiAgLyoqXG4gICAqIEBzZWUgUHJvbWlzZS5jYXRjaFxuICAgKi9cbiAgY2F0Y2godCkge1xuICAgIHJldHVybiB0aGlzLnRoZW4odm9pZCAwLCB0KTtcbiAgfVxuICAvKipcbiAgICogQHNlZSBQcm9taXNlLmZpbmFsbHlcbiAgICovXG4gIGZpbmFsbHkodCkge1xuICAgIHJldHVybiBGKHN1cGVyLmZpbmFsbHkodCksIHRoaXMpO1xuICB9XG4gIC8qKlxuICAgKiBAc2VlIFByb21pc2UudGhlblxuICAgKi9cbiAgdGhlbih0LCByKSB7XG4gICAgcmV0dXJuIEYoc3VwZXIudGhlbih0LCByKSwgdGhpcyk7XG4gIH1cbn1cbmZ1bmN0aW9uIEooZSwgdCkge1xuICByZXR1cm4gZS5yZXNvbHZlID0gdC5yZXNvbHZlLCBlO1xufVxuY2xhc3MgUyBleHRlbmRzIHcge1xuICBjb25zdHJ1Y3Rvcih0LCByKSB7XG4gICAgbGV0IG4sIG87XG4gICAgdHlwZW9mIHQgPT0gXCJmdW5jdGlvblwiID8gKG4gPSB0LCBvID0gcikgOiBvID0gdDtcbiAgICBsZXQgcztcbiAgICBzdXBlcigoYSwgYywgaSkgPT4ge1xuICAgICAgcyA9IGEsIG4gJiYgbihhLCBjLCBpKTtcbiAgICB9LCBvKSwgZWUodGhpcywgXCJyZXNvbHZlXCIpLCB0aGlzLnJlc29sdmUgPSBzO1xuICB9XG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgbmV3IEVuaGFuY2VkUHJvbWlzZSBpbnN0YW5jZSB1c2luZyBleGVjdXRvciwgcmVzb2x2aW5nIHByb21pc2Ugd2hlbiBhIHJlc3VsdFxuICAgKiB3YXMgcmV0dXJuZWQuXG4gICAqIEBwYXJhbSBmbiAtIGZ1bmN0aW9uIHJldHVybmluZyBwcm9taXNlIHJlc3VsdC5cbiAgICogQHBhcmFtIG9wdGlvbnMgLSBhZGRpdGlvbmFsIG9wdGlvbnMuXG4gICAqL1xuICBzdGF0aWMgd2l0aEZuKHQsIHIpIHtcbiAgICByZXR1cm4gbmV3IFMoXG4gICAgICAobiwgbywgcykgPT4gdy53aXRoRm4odCwgeyBhYm9ydFNpZ25hbDogcyB9KS50aGVuKG4sIG8pLFxuICAgICAgclxuICAgICk7XG4gIH1cbiAgLyoqXG4gICAqIEBzZWUgUHJvbWlzZS5yZXNvbHZlXG4gICAqL1xuICBzdGF0aWMgcmVzb2x2ZSh0KSB7XG4gICAgcmV0dXJuIG5ldyBTKChyKSA9PiB7XG4gICAgICByKHQpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBAc2VlIFByb21pc2UucmVqZWN0XG4gICAqL1xuICBzdGF0aWMgcmVqZWN0KHQpIHtcbiAgICByZXR1cm4gbmV3IFMoKHIsIG4pID0+IHtcbiAgICAgIG4odCk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEBzZWUgUHJvbWlzZS5jYXRjaFxuICAgKi9cbiAgY2F0Y2godCkge1xuICAgIHJldHVybiB0aGlzLnRoZW4odm9pZCAwLCB0KTtcbiAgfVxuICAvKipcbiAgICogQHNlZSBQcm9taXNlLmZpbmFsbHlcbiAgICovXG4gIGZpbmFsbHkodCkge1xuICAgIHJldHVybiBKKHN1cGVyLmZpbmFsbHkodCksIHRoaXMpO1xuICB9XG4gIC8qKlxuICAgKiBAc2VlIFByb21pc2UudGhlblxuICAgKi9cbiAgdGhlbih0LCByKSB7XG4gICAgcmV0dXJuIEooc3VwZXIudGhlbih0LCByKSwgdGhpcyk7XG4gIH1cbn1cbmZ1bmN0aW9uIGF0KGUsIHQpIHtcbiAgcmV0dXJuIG5ldyB3KChyKSA9PiB7XG4gICAgc2V0VGltZW91dChyLCBlKTtcbiAgfSwgeyBhYm9ydFNpZ25hbDogdCB9KTtcbn1cbmZ1bmN0aW9uIHNlKGUpIHtcbiAgcmV0dXJuIGB0YXBwcy8ke2V9YDtcbn1cbmZ1bmN0aW9uIFdlKGUsIHQpIHtcbiAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShzZShlKSwgSlNPTi5zdHJpbmdpZnkodCkpO1xufVxuZnVuY3Rpb24geGUoZSkge1xuICBjb25zdCB0ID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzZShlKSk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHQgPyBKU09OLnBhcnNlKHQpIDogdm9pZCAwO1xuICB9IGNhdGNoIHtcbiAgfVxufVxuZnVuY3Rpb24gY3QoZSkge1xuICByZXR1cm4gZS5yZXBsYWNlKC9bQS1aXS9nLCAodCkgPT4gYC0ke3QudG9Mb3dlckNhc2UoKX1gKTtcbn1cbmZ1bmN0aW9uIGl0KGUpIHtcbiAgcmV0dXJuIGUucmVwbGFjZSgvW0EtWl0vZywgKHQpID0+IGBfJHt0LnRvTG93ZXJDYXNlKCl9YCk7XG59XG5mdW5jdGlvbiB1dChlKSB7XG4gIHJldHVybiBlLnJlcGxhY2UoL19bYS16XS9nLCAodCkgPT4gdFsxXS50b1VwcGVyQ2FzZSgpKTtcbn1cbi8vIEBfX05PX1NJREVfRUZGRUNUU19fXG5mdW5jdGlvbiBrZShlLCB0KSB7XG4gIHQgfHwgKHQgPSB7fSk7XG4gIGNvbnN0IHtcbiAgICB0ZXh0Q29sb3I6IHIsXG4gICAgYmdDb2xvcjogbixcbiAgICBzaG91bGRMb2c6IG8gPSAhMFxuICB9ID0gdDtcbiAgZnVuY3Rpb24gcyhhLCAuLi5jKSB7XG4gICAgaWYgKCFvIHx8IHR5cGVvZiBvID09IFwiZnVuY3Rpb25cIiAmJiAhbygpKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGkgPSBcImZvbnQtd2VpZ2h0OmJvbGQ7cGFkZGluZzowIDVweDtib3JkZXItcmFkaXVzOjVweFwiO1xuICAgIGNvbnNvbGVbYV0oXG4gICAgICBgJWMke0ludGwuRGF0ZVRpbWVGb3JtYXQoXCJlbi1HQlwiLCB7XG4gICAgICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxuICAgICAgICBtaW51dGU6IFwiMi1kaWdpdFwiLFxuICAgICAgICBzZWNvbmQ6IFwiMi1kaWdpdFwiLFxuICAgICAgICBmcmFjdGlvbmFsU2Vjb25kRGlnaXRzOiAzLFxuICAgICAgICB0aW1lWm9uZTogXCJVVENcIlxuICAgICAgfSkuZm9ybWF0KC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKX0lYyAvICVjJHtlfWAsXG4gICAgICBgJHtpfTtiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGJsdWU7Y29sb3I6YmxhY2tgLFxuICAgICAgXCJcIixcbiAgICAgIGAke2l9OyR7ciA/IGBjb2xvcjoke3J9O2AgOiBcIlwifSR7biA/IGBiYWNrZ3JvdW5kLWNvbG9yOiR7bn1gIDogXCJcIn1gLFxuICAgICAgLi4uY1xuICAgICk7XG4gIH1cbiAgcmV0dXJuIFtcbiAgICBmdW5jdGlvbiguLi5hKSB7XG4gICAgICBzKFwibG9nXCIsIC4uLmEpO1xuICAgIH0sXG4gICAgZnVuY3Rpb24oLi4uYSkge1xuICAgICAgcyhcImVycm9yXCIsIC4uLmEpO1xuICAgIH1cbiAgXTtcbn1cbmZ1bmN0aW9uIHB0KGUsIHQpIHtcbiAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGUsIHQpO1xufVxuZnVuY3Rpb24gZnQoZSkge1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUucmVtb3ZlUHJvcGVydHkoZSk7XG59XG5mdW5jdGlvbiBMZShlLCB0KSB7XG4gIHQoKTtcbn1cbi8vIEBfX05PX1NJREVfRUZGRUNUU19fXG5mdW5jdGlvbiB5KGUsIHQpIHtcbiAgdCB8fCAodCA9IHt9KTtcbiAgY29uc3QgciA9IHQuZXF1YWxzIHx8IE9iamVjdC5pcztcbiAgbGV0IG4gPSBbXSwgbyA9IGU7XG4gIGNvbnN0IHMgPSAodSkgPT4ge1xuICAgIGlmICghcihvLCB1KSkge1xuICAgICAgY29uc3QgZiA9IG87XG4gICAgICBvID0gdSwgTGUoaSwgKCkgPT4ge1xuICAgICAgICBbLi4ubl0uZm9yRWFjaCgoW2gsIG1dKSA9PiB7XG4gICAgICAgICAgaCh1LCBmKSwgbSAmJiBjKGgsICEwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIGZ1bmN0aW9uIGEodSkge1xuICAgIGNvbnN0IGYgPSB0eXBlb2YgdSAhPSBcIm9iamVjdFwiID8geyBvbmNlOiB1IH0gOiB1O1xuICAgIHJldHVybiB7XG4gICAgICBvbmNlOiBmLm9uY2UgfHwgITEsXG4gICAgICBzaWduYWw6IGYuc2lnbmFsIHx8ICExXG4gICAgfTtcbiAgfVxuICBjb25zdCBjID0gKHUsIGYpID0+IHtcbiAgICBjb25zdCBoID0gYShmKSwgbSA9IG4uZmluZEluZGV4KChbVCwgQV0pID0+IFQgPT09IHUgJiYgQS5vbmNlID09PSBoLm9uY2UgJiYgQS5zaWduYWwgPT09IGguc2lnbmFsKTtcbiAgICBtID49IDAgJiYgbi5zcGxpY2UobSwgMSk7XG4gIH0sIGkgPSBPYmplY3QuYXNzaWduKFxuICAgIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE9lKGkpLCBvO1xuICAgIH0sXG4gICAge1xuICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgbiA9IFtdO1xuICAgICAgfSxcbiAgICAgIHNldDogcyxcbiAgICAgIHJlc2V0KCkge1xuICAgICAgICBzKGUpO1xuICAgICAgfSxcbiAgICAgIHN1Yih1LCBmKSB7XG4gICAgICAgIHJldHVybiBuLnB1c2goW3UsIGEoZildKSwgKCkgPT4gYyh1LCBmKTtcbiAgICAgIH0sXG4gICAgICB1bnN1YjogYyxcbiAgICAgIHVuc3ViQWxsKCkge1xuICAgICAgICBuID0gbi5maWx0ZXIoKHUpID0+IHVbMV0uc2lnbmFsKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJldHVybiBpO1xufVxuY29uc3QgVSA9IFtdO1xuZnVuY3Rpb24gT2UoZSkge1xuICBVLmxlbmd0aCAmJiBVW1UubGVuZ3RoIC0gMV0uYWRkKGUpO1xufVxuY29uc3QgYWUgPSAvKiBAX19QVVJFX18gKi8geSghMSksIFtPLCBxZV0gPSAvKiBAX19QVVJFX18gKi8ga2UoXCJCcmlkZ2VcIiwge1xuICBiZ0NvbG9yOiBcIiM5MTQ3ZmZcIixcbiAgdGV4dENvbG9yOiBcIndoaXRlXCIsXG4gIHNob3VsZExvZzogYWVcbn0pLCBJZSA9IHtcbiAgY2xpcGJvYXJkX3RleHRfcmVjZWl2ZWQ6IGwoe1xuICAgIHJlcV9pZDogXygpLFxuICAgIGRhdGE6IChlKSA9PiBlID09PSBudWxsID8gZSA6IF8oITApKGUpXG4gIH0sIFwiY2xpcGJvYXJkX3RleHRfcmVjZWl2ZWRcIiksXG4gIGN1c3RvbV9tZXRob2RfaW52b2tlZDogbCh7XG4gICAgcmVxX2lkOiBfKCksXG4gICAgcmVzdWx0OiAoZSkgPT4gZSxcbiAgICBlcnJvcjogXyghMClcbiAgfSwgXCJjdXN0b21fbWV0aG9kX2ludm9rZWRcIiksXG4gIHBvcHVwX2Nsb3NlZDogZyhcInBvcHVwX2Nsb3NlZFwiLCAoZSkgPT4gZSA/IGwoe1xuICAgIGJ1dHRvbl9pZDogKHQpID0+IHQgPT0gbnVsbCA/IHZvaWQgMCA6IF8oKSh0KVxuICB9KSgpKGUpIDoge30pLFxuICB2aWV3cG9ydF9jaGFuZ2VkOiBsKHtcbiAgICBoZWlnaHQ6IFAoKSxcbiAgICB3aWR0aDogKGUpID0+IGUgPT0gbnVsbCA/IHdpbmRvdy5pbm5lcldpZHRoIDogUCgpKGUpLFxuICAgIGlzX3N0YXRlX3N0YWJsZTogJCgpLFxuICAgIGlzX2V4cGFuZGVkOiAkKClcbiAgfSwgXCJ2aWV3cG9ydF9jaGFuZ2VkXCIpXG59O1xuZnVuY3Rpb24gTWUoZSkge1xuICBjb25zdCB0ID0gd2luZG93LCBbLCByXSA9IGsoXG4gICAgLy8gQWRkIGxpc3RlbmVyLCB3aGljaCBoYW5kbGVzIGV2ZW50cyBzZW50IGZyb20gdGhlIFRlbGVncmFtIHdlYiBhcHBsaWNhdGlvbiBhbmQgYWxzbyBldmVudHNcbiAgICAvLyBnZW5lcmF0ZWQgYnkgdGhlIGxvY2FsIGVtaXRFdmVudCBmdW5jdGlvbi5cbiAgICB0ZSh0LCBcIm1lc3NhZ2VcIiwgKG4pID0+IHtcbiAgICAgIGlmIChuLnNvdXJjZSAhPT0gdC5wYXJlbnQpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGxldCBvO1xuICAgICAgdHJ5IHtcbiAgICAgICAgbyA9IFgoKShuLmRhdGEpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZXZlbnRUeXBlOiBzLCBldmVudERhdGE6IGEgfSA9IG8sIGMgPSBJZVtzXTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGkgPSBjID8gYygpKGEpIDogYTtcbiAgICAgICAgTyhcIkV2ZW50IHJlY2VpdmVkOlwiLCBpID8geyBldmVudFR5cGU6IHMsIGV2ZW50RGF0YTogaSB9IDogeyBldmVudFR5cGU6IHMgfSksIGUoW3MsIGldKTtcbiAgICAgIH0gY2F0Y2ggKGkpIHtcbiAgICAgICAgcWUoXG4gICAgICAgICAgW1xuICAgICAgICAgICAgYEFuIGVycm9yIG9jY3VycmVkIHByb2Nlc3NpbmcgdGhlIFwiJHtzfVwiIGV2ZW50IGZyb20gdGhlIFRlbGVncmFtIGFwcGxpY2F0aW9uLmAsXG4gICAgICAgICAgICBcIlBsZWFzZSwgZmlsZSBhbiBpc3N1ZSBoZXJlOlwiLFxuICAgICAgICAgICAgXCJodHRwczovL2dpdGh1Yi5jb20vVGVsZWdyYW0tTWluaS1BcHBzL3RlbGVncmFtLWFwcHMvaXNzdWVzL25ldy9jaG9vc2VcIlxuICAgICAgICAgIF0uam9pbihgXG5gKSxcbiAgICAgICAgICBvLFxuICAgICAgICAgIGlcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KVxuICApO1xuICByZXR1cm4gcjtcbn1cbmNvbnN0IEMgPSAvKiBAX19QVVJFX18gKi8geSgpLCBOID0gLyogQF9fUFVSRV9fICovIHkoKTtcbmZ1bmN0aW9uIGNlKCkge1xuICByZXR1cm4gTigpIHx8IE4uc2V0KE1lKEMuc2V0KSksIEM7XG59XG5jb25zdCB2ID0gLyogQF9fUFVSRV9fICovIHkoe30pO1xuZnVuY3Rpb24gaWUoZSkge1xuICBsZXQgdCA9IHYoKVtlXTtcbiAgcmV0dXJuIHQgfHwgKHQgPSAvKiBAX19QVVJFX18gKi8geSh2b2lkIDAsIHtcbiAgICBlcXVhbHMoKSB7XG4gICAgICByZXR1cm4gITE7XG4gICAgfVxuICB9KSwgY2UoKS5zdWIoKHIpID0+IHtcbiAgICByICYmIHJbMF0gPT09IGUgJiYgdC5zZXQoclsxXSk7XG4gIH0pLCB2LnNldCh7IC4uLnYoKSwgW2VdOiB0IH0pKSwgdDtcbn1cbmZ1bmN0aW9uIEZlKGUsIHQsIHIpIHtcbiAgcmV0dXJuIGllKGUpLnN1Yih0LCByKTtcbn1cbmNvbnN0IEplID0gXCJFUlJfTUVUSE9EX1VOU1VQUE9SVEVEXCIsIEJlID0gXCJFUlJfUkVUUklFVkVfTFBfRkFJTEVEXCIsIEhlID0gXCJFUlJfTUVUSE9EX1BBUkFNRVRFUl9VTlNVUFBPUlRFRFwiLCBHZSA9IFwiRVJSX1VOS05PV05fRU5WXCIsIEtlID0gXCJFUlJfSU5WT0tFX0NVU1RPTV9NRVRIT0RfUkVTUE9OU0VcIiwgdWUgPSAvKiBAX19QVVJFX18gKi8geShcImh0dHBzOi8vd2ViLnRlbGVncmFtLm9yZ1wiKTtcbmZ1bmN0aW9uIHBlKGUsIHQpIHtcbiAgTyhcIlBvc3RpbmcgZXZlbnQ6XCIsIHQgPyB7IGV2ZW50VHlwZTogZSwgZXZlbnREYXRhOiB0IH0gOiB7IGV2ZW50VHlwZTogZSB9KTtcbiAgY29uc3QgciA9IHdpbmRvdztcbiAgaWYgKFEocikpIHtcbiAgICByLlRlbGVncmFtV2Vidmlld1Byb3h5LnBvc3RFdmVudChlLCBKU09OLnN0cmluZ2lmeSh0KSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IG4gPSBKU09OLnN0cmluZ2lmeSh7IGV2ZW50VHlwZTogZSwgZXZlbnREYXRhOiB0IH0pO1xuICBpZiAoTmUoKSlcbiAgICByZXR1cm4gci5wYXJlbnQucG9zdE1lc3NhZ2UobiwgdWUoKSk7XG4gIGNvbnN0IHsgZXh0ZXJuYWw6IG8gfSA9IHI7XG4gIGlmIChsKHsgbm90aWZ5OiBZKCkgfSkoKS5pc1ZhbGlkKG8pKSB7XG4gICAgby5ub3RpZnkobik7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRocm93IG5ldyBiKEdlKTtcbn1cbmZ1bmN0aW9uIGZlKGUsIHQsIHIpIHtcbiAgciB8fCAociA9IHt9KTtcbiAgY29uc3QgeyBjYXB0dXJlOiBuIH0gPSByLCBbbywgc10gPSBrKCk7XG4gIHJldHVybiBuZXcgdygoYSkgPT4ge1xuICAgIChBcnJheS5pc0FycmF5KHQpID8gdCA6IFt0XSkuZm9yRWFjaCgoYykgPT4ge1xuICAgICAgbyhcbiAgICAgICAgRmUoYywgKGkpID0+IHtcbiAgICAgICAgICAoIW4gfHwgKEFycmF5LmlzQXJyYXkodCkgPyBuKHtcbiAgICAgICAgICAgIGV2ZW50OiBjLFxuICAgICAgICAgICAgcGF5bG9hZDogaVxuICAgICAgICAgIH0pIDogbihpKSkpICYmIGEoaSk7XG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pLCAoci5wb3N0RXZlbnQgfHwgcGUpKGUsIHIucGFyYW1zKTtcbiAgfSwgcikuZmluYWxseShzKTtcbn1cbmZ1bmN0aW9uIHEoZSkge1xuICByZXR1cm4gQWUoKShlKTtcbn1cbmZ1bmN0aW9uIF9lKGUpIHtcbiAgcmV0dXJuIHEoXG4gICAgZS5yZXBsYWNlKC9eW14/I10qWz8jXS8sIFwiXCIpLnJlcGxhY2UoL1s/I10vZywgXCImXCIpXG4gICk7XG59XG5mdW5jdGlvbiBWZSgpIHtcbiAgcmV0dXJuIF9lKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbn1cbmZ1bmN0aW9uIFplKCkge1xuICBjb25zdCBlID0gcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIilbMF07XG4gIGlmICghZSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gZ2V0IGZpcnN0IG5hdmlnYXRpb24gZW50cnkuXCIpO1xuICByZXR1cm4gX2UoZS5uYW1lKTtcbn1cbmNvbnN0IHplID0gXCJsYXVuY2hQYXJhbXNcIjtcbmZ1bmN0aW9uIFhlKCkge1xuICByZXR1cm4gcSh4ZSh6ZSkgfHwgXCJcIik7XG59XG5mdW5jdGlvbiBsZShlKSB7XG4gIFdlKFwibGF1bmNoUGFyYW1zXCIsIC8qIEBfX1BVUkVfXyAqLyBTZShlKSk7XG59XG5mdW5jdGlvbiBiZShlKSB7XG4gIHJldHVybiBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UgKyAoZS5jYXVzZSA/IGBcbiAgJHtiZShlLmNhdXNlKX1gIDogXCJcIikgOiBKU09OLnN0cmluZ2lmeShlKTtcbn1cbmZ1bmN0aW9uIFllKCkge1xuICBjb25zdCBlID0gW107XG4gIGZvciAoY29uc3QgdCBvZiBbXG4gICAgLy8gVHJ5IHRvIHJldHJpZXZlIGxhdW5jaCBwYXJhbWV0ZXJzIGZyb20gdGhlIGN1cnJlbnQgbG9jYXRpb24uIFRoaXMgbWV0aG9kIGNhbiByZXR1cm5cbiAgICAvLyBub3RoaW5nIGluIGNhc2UsIGxvY2F0aW9uIHdhcyBjaGFuZ2VkLCBhbmQgdGhlbiB0aGUgcGFnZSB3YXMgcmVsb2FkZWQuXG4gICAgVmUsXG4gICAgLy8gVGhlbiwgdHJ5IHVzaW5nIHRoZSBsb3dlciBsZXZlbCBBUEkgLSB3aW5kb3cucGVyZm9ybWFuY2UuXG4gICAgWmUsXG4gICAgLy8gRmluYWxseSwgdHJ5IHRvIGV4dHJhY3QgbGF1bmNoIHBhcmFtZXRlcnMgZnJvbSB0aGUgc2Vzc2lvbiBzdG9yYWdlLlxuICAgIFhlXG4gIF0pXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHIgPSB0KCk7XG4gICAgICByZXR1cm4gbGUociksIHI7XG4gICAgfSBjYXRjaCAocikge1xuICAgICAgZS5wdXNoKHIpO1xuICAgIH1cbiAgdGhyb3cgbmV3IGIoQmUsIFtcbiAgICBcIlVuYWJsZSB0byByZXRyaWV2ZSBsYXVuY2ggcGFyYW1ldGVycyBmcm9tIGFueSBrbm93biBzb3VyY2UuIFBlcmhhcHMsIHlvdSBoYXZlIG9wZW5lZCB5b3VyIGFwcCBvdXRzaWRlIFRlbGVncmFtP1wiLFxuICAgIFwi8J+TliBSZWZlciB0byBkb2NzIGZvciBtb3JlIGluZm9ybWF0aW9uOlwiLFxuICAgIFwiaHR0cHM6Ly9kb2NzLnRlbGVncmFtLW1pbmktYXBwcy5jb20vcGFja2FnZXMvdGVsZWdyYW0tYXBwcy1icmlkZ2UvZW52aXJvbm1lbnRcIixcbiAgICBcIkNvbGxlY3RlZCBlcnJvcnM6XCIsXG4gICAgLi4uZS5tYXAoKHQpID0+IGDigJQgJHtiZSh0KX1gKVxuICBdLmpvaW4oYFxuYCkpO1xufVxuZnVuY3Rpb24gX3QoZSkge1xuICBpZiAoZSA9PT0gXCJzaW1wbGVcIilcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIFllKCksICEwO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgcmV0dXJuIHcud2l0aEZuKGFzeW5jICgpID0+IHtcbiAgICBpZiAoUSh3aW5kb3cpKVxuICAgICAgcmV0dXJuICEwO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgZmUoXCJ3ZWJfYXBwX3JlcXVlc3RfdGhlbWVcIiwgXCJ0aGVtZV9jaGFuZ2VkXCIsIHsgdGltZW91dDogMTAwIH0pLCAhMDtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gIH0sIGUpO1xufVxuZnVuY3Rpb24geChlLCB0KSB7XG4gIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBNZXNzYWdlRXZlbnQoXCJtZXNzYWdlXCIsIHtcbiAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7IGV2ZW50VHlwZTogZSwgZXZlbnREYXRhOiB0IH0pLFxuICAgIC8vIFdlIHNwZWNpZnkgd2luZG93LnBhcmVudCB0byBpbWl0YXRlIHRoZSBjYXNlLCB0aGUgcGFyZW50IGlmcmFtZSBzZW50IHVzIHRoaXMgZXZlbnQuXG4gICAgc291cmNlOiB3aW5kb3cucGFyZW50XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIFFlKGUsIHQpIHtcbiAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZXZlbnRUeXBlOiByIH0gPSBYKCkodCk7XG4gICAgICByID09PSBcIndlYl9hcHBfcmVxdWVzdF90aGVtZVwiICYmIHgoXCJ0aGVtZV9jaGFuZ2VkXCIsIHtcbiAgICAgICAgdGhlbWVfcGFyYW1zOiBKU09OLnBhcnNlKC8qIEBfX1BVUkVfXyAqLyBXKGUpKVxuICAgICAgfSksIHIgPT09IFwid2ViX2FwcF9yZXF1ZXN0X3ZpZXdwb3J0XCIgJiYgeChcInZpZXdwb3J0X2NoYW5nZWRcIiwge1xuICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsXG4gICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICBpc19zdGF0ZV9zdGFibGU6ICEwLFxuICAgICAgICBpc19leHBhbmRlZDogITBcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2gge1xuICAgIH1cbn1cbmZ1bmN0aW9uIGx0KGUpIHtcbiAgdmFyIG47XG4gIGNvbnN0IHQgPSB0eXBlb2YgZSA9PSBcInN0cmluZ1wiID8gcShlKSA6IGU7XG4gIGxlKHQpO1xuICBjb25zdCByID0gKG4gPSB3aW5kb3cuVGVsZWdyYW1XZWJ2aWV3UHJveHkpID09IG51bGwgPyB2b2lkIDAgOiBuLnBvc3RFdmVudDtcbiAgd2luZG93LlRlbGVncmFtV2Vidmlld1Byb3h5ID0ge1xuICAgIHBvc3RFdmVudChvLCBzKSB7XG4gICAgICBRZSh0LnRoZW1lUGFyYW1zLCBKU09OLnN0cmluZ2lmeSh7IGV2ZW50VHlwZTogbywgZXZlbnREYXRhOiBzIH0pKSwgciA9PSBudWxsIHx8IHIobywgcyk7XG4gICAgfVxuICB9LCBPKFwiRW52aXJvbm1lbnQgd2FzIG1vY2tlZCBieSB0aGUgbW9ja1RlbGVncmFtRW52IGZ1bmN0aW9uXCIpO1xufVxuZnVuY3Rpb24gYnQoKSB7XG4gIFtcbiAgICBbXCJUZWxlZ3JhbUdhbWVQcm94eV9yZWNlaXZlRXZlbnRcIl0sXG4gICAgLy8gV2luZG93cyBQaG9uZS5cbiAgICBbXCJUZWxlZ3JhbUdhbWVQcm94eVwiLCBcInJlY2VpdmVFdmVudFwiXSxcbiAgICAvLyBEZXNrdG9wLlxuICAgIFtcIlRlbGVncmFtXCIsIFwiV2ViVmlld1wiLCBcInJlY2VpdmVFdmVudFwiXVxuICAgIC8vIEFuZHJvaWQgYW5kIGlPUy5cbiAgXS5mb3JFYWNoKChlKSA9PiB7XG4gICAgbGV0IHQgPSB3aW5kb3c7XG4gICAgZS5mb3JFYWNoKChyLCBuLCBvKSA9PiB7XG4gICAgICBpZiAobiA9PT0gby5sZW5ndGggLSAxKSB7XG4gICAgICAgIHRbcl0gPSB4O1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICByIGluIHQgfHwgKHRbcl0gPSB7fSksIHQgPSB0W3JdO1xuICAgIH0pO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGd0KCkge1xuICBbXCJUZWxlZ3JhbUdhbWVQcm94eV9yZWNlaXZlRXZlbnRcIiwgXCJUZWxlZ3JhbUdhbWVQcm94eVwiLCBcIlRlbGVncmFtXCJdLmZvckVhY2goKGUpID0+IHtcbiAgICBkZWxldGUgd2luZG93W2VdO1xuICB9KTtcbn1cbmZ1bmN0aW9uIHd0KGUsIHQsIHIpIHtcbiAgaWUoZSkudW5zdWIodCwgcik7XG59XG5mdW5jdGlvbiBodChlLCB0KSB7XG4gIHJldHVybiBjZSgpLnN1YihlLCB0KTtcbn1cbmZ1bmN0aW9uIG10KGUsIHQpIHtcbiAgQy51bnN1YihlLCB0KTtcbn1cbmZ1bmN0aW9uIGV0KGUpIHtcbiAgcmV0dXJuICh7IHJlcV9pZDogdCB9KSA9PiB0ID09PSBlO1xufVxuZnVuY3Rpb24gQihlKSB7XG4gIHJldHVybiBlLnNwbGl0KFwiLlwiKS5tYXAoTnVtYmVyKTtcbn1cbmZ1bmN0aW9uIHR0KGUsIHQpIHtcbiAgY29uc3QgciA9IEIoZSksIG4gPSBCKHQpLCBvID0gTWF0aC5tYXgoci5sZW5ndGgsIG4ubGVuZ3RoKTtcbiAgZm9yIChsZXQgcyA9IDA7IHMgPCBvOyBzICs9IDEpIHtcbiAgICBjb25zdCBhID0gcltzXSB8fCAwLCBjID0gbltzXSB8fCAwO1xuICAgIGlmIChhICE9PSBjKVxuICAgICAgcmV0dXJuIGEgPiBjID8gMSA6IC0xO1xuICB9XG4gIHJldHVybiAwO1xufVxuZnVuY3Rpb24gcChlLCB0KSB7XG4gIHJldHVybiB0dChlLCB0KSA8PSAwO1xufVxuZnVuY3Rpb24gSChlLCB0LCByKSB7XG4gIGlmICh0eXBlb2YgciA9PSBcInN0cmluZ1wiKSB7XG4gICAgaWYgKGUgPT09IFwid2ViX2FwcF9vcGVuX2xpbmtcIikge1xuICAgICAgaWYgKHQgPT09IFwidHJ5X2luc3RhbnRfdmlld1wiKVxuICAgICAgICByZXR1cm4gcChcIjYuNFwiLCByKTtcbiAgICAgIGlmICh0ID09PSBcInRyeV9icm93c2VyXCIpXG4gICAgICAgIHJldHVybiBwKFwiNy42XCIsIHIpO1xuICAgIH1cbiAgICBpZiAoZSA9PT0gXCJ3ZWJfYXBwX3NldF9oZWFkZXJfY29sb3JcIiAmJiB0ID09PSBcImNvbG9yXCIpXG4gICAgICByZXR1cm4gcChcIjYuOVwiLCByKTtcbiAgICBpZiAoZSA9PT0gXCJ3ZWJfYXBwX2Nsb3NlXCIgJiYgdCA9PT0gXCJyZXR1cm5fYmFja1wiKVxuICAgICAgcmV0dXJuIHAoXCI3LjZcIiwgcik7XG4gICAgaWYgKGUgPT09IFwid2ViX2FwcF9zZXR1cF9tYWluX2J1dHRvblwiICYmIHQgPT09IFwiaGFzX3NoaW5lX2VmZmVjdFwiKVxuICAgICAgcmV0dXJuIHAoXCI3LjEwXCIsIHIpO1xuICB9XG4gIHN3aXRjaCAoZSkge1xuICAgIGNhc2UgXCJ3ZWJfYXBwX29wZW5fdGdfbGlua1wiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX29wZW5faW52b2ljZVwiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX3NldHVwX2JhY2tfYnV0dG9uXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfc2V0X2JhY2tncm91bmRfY29sb3JcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9zZXRfaGVhZGVyX2NvbG9yXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfdHJpZ2dlcl9oYXB0aWNfZmVlZGJhY2tcIjpcbiAgICAgIHJldHVybiBwKFwiNi4xXCIsIHQpO1xuICAgIGNhc2UgXCJ3ZWJfYXBwX29wZW5fcG9wdXBcIjpcbiAgICAgIHJldHVybiBwKFwiNi4yXCIsIHQpO1xuICAgIGNhc2UgXCJ3ZWJfYXBwX2Nsb3NlX3NjYW5fcXJfcG9wdXBcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9vcGVuX3NjYW5fcXJfcG9wdXBcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9yZWFkX3RleHRfZnJvbV9jbGlwYm9hcmRcIjpcbiAgICAgIHJldHVybiBwKFwiNi40XCIsIHQpO1xuICAgIGNhc2UgXCJ3ZWJfYXBwX3N3aXRjaF9pbmxpbmVfcXVlcnlcIjpcbiAgICAgIHJldHVybiBwKFwiNi43XCIsIHQpO1xuICAgIGNhc2UgXCJ3ZWJfYXBwX2ludm9rZV9jdXN0b21fbWV0aG9kXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfcmVxdWVzdF93cml0ZV9hY2Nlc3NcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9yZXF1ZXN0X3Bob25lXCI6XG4gICAgICByZXR1cm4gcChcIjYuOVwiLCB0KTtcbiAgICBjYXNlIFwid2ViX2FwcF9zZXR1cF9zZXR0aW5nc19idXR0b25cIjpcbiAgICAgIHJldHVybiBwKFwiNi4xMFwiLCB0KTtcbiAgICBjYXNlIFwid2ViX2FwcF9iaW9tZXRyeV9nZXRfaW5mb1wiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX2Jpb21ldHJ5X29wZW5fc2V0dGluZ3NcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9iaW9tZXRyeV9yZXF1ZXN0X2FjY2Vzc1wiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX2Jpb21ldHJ5X3JlcXVlc3RfYXV0aFwiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX2Jpb21ldHJ5X3VwZGF0ZV90b2tlblwiOlxuICAgICAgcmV0dXJuIHAoXCI3LjJcIiwgdCk7XG4gICAgY2FzZSBcIndlYl9hcHBfc2V0dXBfc3dpcGVfYmVoYXZpb3JcIjpcbiAgICAgIHJldHVybiBwKFwiNy43XCIsIHQpO1xuICAgIGNhc2UgXCJ3ZWJfYXBwX3NoYXJlX3RvX3N0b3J5XCI6XG4gICAgICByZXR1cm4gcChcIjcuOFwiLCB0KTtcbiAgICBjYXNlIFwid2ViX2FwcF9zZXR1cF9zZWNvbmRhcnlfYnV0dG9uXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfc2V0X2JvdHRvbV9iYXJfY29sb3JcIjpcbiAgICAgIHJldHVybiBwKFwiNy4xMFwiLCB0KTtcbiAgICBjYXNlIFwid2ViX2FwcF9yZXF1ZXN0X3NhZmVfYXJlYVwiOlxuICAgIGNhc2UgXCJ3ZWJfYXBwX3JlcXVlc3RfY29udGVudF9zYWZlX2FyZWFcIjpcbiAgICBjYXNlIFwid2ViX2FwcF9yZXF1ZXN0X2Z1bGxzY3JlZW5cIjpcbiAgICBjYXNlIFwid2ViX2FwcF9leGl0X2Z1bGxzY3JlZW5cIjpcbiAgICBjYXNlIFwid2ViX2FwcF9zZXRfZW1vamlfc3RhdHVzXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfYWRkX3RvX2hvbWVfc2NyZWVuXCI6XG4gICAgY2FzZSBcIndlYl9hcHBfY2hlY2tfaG9tZV9zY3JlZW5cIjpcbiAgICBjYXNlIFwid2ViX2FwcF9yZXF1ZXN0X2Vtb2ppX3N0YXR1c19hY2Nlc3NcIjpcbiAgICAgIHJldHVybiBwKFwiOC4wXCIsIHQpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gW1xuICAgICAgICBcImlmcmFtZV9yZWFkeVwiLFxuICAgICAgICBcImlmcmFtZV93aWxsX3JlbG9hZFwiLFxuICAgICAgICBcIndlYl9hcHBfY2xvc2VcIixcbiAgICAgICAgXCJ3ZWJfYXBwX2RhdGFfc2VuZFwiLFxuICAgICAgICBcIndlYl9hcHBfZXhwYW5kXCIsXG4gICAgICAgIFwid2ViX2FwcF9vcGVuX2xpbmtcIixcbiAgICAgICAgXCJ3ZWJfYXBwX3JlYWR5XCIsXG4gICAgICAgIFwid2ViX2FwcF9yZXF1ZXN0X3RoZW1lXCIsXG4gICAgICAgIFwid2ViX2FwcF9yZXF1ZXN0X3ZpZXdwb3J0XCIsXG4gICAgICAgIFwid2ViX2FwcF9zZXR1cF9tYWluX2J1dHRvblwiLFxuICAgICAgICBcIndlYl9hcHBfc2V0dXBfY2xvc2luZ19iZWhhdmlvclwiXG4gICAgICBdLmluY2x1ZGVzKGUpO1xuICB9XG59XG5mdW5jdGlvbiBkdChlLCB0KSB7XG4gIHQgfHwgKHQgPSBcInN0cmljdFwiKTtcbiAgY29uc3QgciA9IHR5cGVvZiB0ID09IFwiZnVuY3Rpb25cIiA/IHQgOiAobikgPT4ge1xuICAgIGNvbnN0IHsgbWV0aG9kOiBvLCB2ZXJzaW9uOiBzIH0gPSBuO1xuICAgIGxldCBhLCBjO1xuICAgIGlmIChcInBhcmFtXCIgaW4gbiA/IChhID0gYFBhcmFtZXRlciBcIiR7bi5wYXJhbX1cIiBvZiBcIiR7b31cIiBtZXRob2QgaXMgdW5zdXBwb3J0ZWQgaW4gTWluaSBBcHBzIHZlcnNpb24gJHtzfWAsIGMgPSBIZSkgOiAoYSA9IGBNZXRob2QgXCIke299XCIgaXMgdW5zdXBwb3J0ZWQgaW4gTWluaSBBcHBzIHZlcnNpb24gJHtzfWAsIGMgPSBKZSksIHQgPT09IFwic3RyaWN0XCIpXG4gICAgICB0aHJvdyBuZXcgYihjLCBhKTtcbiAgICByZXR1cm4gY29uc29sZS53YXJuKGEpO1xuICB9O1xuICByZXR1cm4gKG4sIG8pID0+IEgobiwgZSkgPyAkZShvKSAmJiBuID09PSBcIndlYl9hcHBfc2V0X2hlYWRlcl9jb2xvclwiICYmIFwiY29sb3JcIiBpbiBvICYmICFIKG4sIFwiY29sb3JcIiwgZSkgPyByKHsgdmVyc2lvbjogZSwgbWV0aG9kOiBuLCBwYXJhbTogXCJjb2xvclwiIH0pIDogcGUobiwgbykgOiByKHsgdmVyc2lvbjogZSwgbWV0aG9kOiBuIH0pO1xufVxuZnVuY3Rpb24gRXQoZSwgdCwgciwgbikge1xuICByZXR1cm4gZmUoXCJ3ZWJfYXBwX2ludm9rZV9jdXN0b21fbWV0aG9kXCIsIFwiY3VzdG9tX21ldGhvZF9pbnZva2VkXCIsIHtcbiAgICAuLi5uIHx8IHt9LFxuICAgIHBhcmFtczogeyBtZXRob2Q6IGUsIHBhcmFtczogdCwgcmVxX2lkOiByIH0sXG4gICAgY2FwdHVyZTogZXQocilcbiAgfSkudGhlbigoeyByZXN1bHQ6IG8sIGVycm9yOiBzIH0pID0+IHtcbiAgICBpZiAocylcbiAgICAgIHRocm93IG5ldyBiKEtlLCBzKTtcbiAgICByZXR1cm4gbztcbiAgfSk7XG59XG5mdW5jdGlvbiBydChlKSB7XG4gIGUudW5zdWJBbGwoKSwgZS5yZXNldCgpO1xufVxuZnVuY3Rpb24geXQoKSB7XG4gIHZhciBlO1xuICAoZSA9IE4oKSkgPT0gbnVsbCB8fCBlKCksIFtcbiAgICAuLi5PYmplY3QudmFsdWVzKHYoKSksXG4gICAgdixcbiAgICBDLFxuICAgIE4sXG4gICAgdWUsXG4gICAgYWVcbiAgXS5mb3JFYWNoKHJ0KTtcbn1cbmV4cG9ydCB7XG4gIGFlIGFzICRkZWJ1ZyxcbiAgdWUgYXMgJHRhcmdldE9yaWdpbixcbiAgdyBhcyBDYW5jZWxhYmxlUHJvbWlzZSxcbiAgcmUgYXMgRVJSX0FCT1JURUQsXG4gIG5lIGFzIEVSUl9DQU5DRUxFRCxcbiAgS2UgYXMgRVJSX0NVU1RPTV9NRVRIT0RfRVJSX1JFU1BPTlNFLFxuICBIZSBhcyBFUlJfTUVUSE9EX1BBUkFNRVRFUl9VTlNVUFBPUlRFRCxcbiAgSmUgYXMgRVJSX01FVEhPRF9VTlNVUFBPUlRFRCxcbiAgQmUgYXMgRVJSX1JFVFJJRVZFX0xQX0ZBSUxFRCxcbiAgb2UgYXMgRVJSX1RJTUVEX09VVCxcbiAgR2UgYXMgRVJSX1VOS05PV05fRU5WLFxuICBTIGFzIEVuaGFuY2VkUHJvbWlzZSxcbiAgYiBhcyBUeXBlZEVycm9yLFxuICB0ZSBhcyBhZGRFdmVudExpc3RlbmVyLFxuICBjdCBhcyBjYW1lbFRvS2ViYWIsXG4gIGl0IGFzIGNhbWVsVG9TbmFrZSxcbiAgZXQgYXMgY2FwdHVyZVNhbWVSZXEsXG4gIHR0IGFzIGNvbXBhcmVWZXJzaW9ucyxcbiAgTSBhcyBjcmVhdGVBYm9ydEVycm9yLFxuICBrIGFzIGNyZWF0ZUNiQ29sbGVjdG9yLFxuICBrZSBhcyBjcmVhdGVMb2dnZXIsXG4gIGR0IGFzIGNyZWF0ZVBvc3RFdmVudCxcbiAgTCBhcyBjcmVhdGVUeXBlZEVycm9yUHJlZGljYXRlLFxuICBidCBhcyBkZWZpbmVFdmVudEhhbmRsZXJzLFxuICBmdCBhcyBkZWxldGVDc3NWYXIsXG4gIHggYXMgZW1pdE1pbmlBcHBzRXZlbnQsXG4gIHhlIGFzIGdldFN0b3JhZ2VWYWx1ZSxcbiAgUSBhcyBoYXNXZWJ2aWV3UHJveHksXG4gIEV0IGFzIGludm9rZUN1c3RvbU1ldGhvZCxcbiAgb3QgYXMgaXNBYm9ydEVycm9yLFxuICBzdCBhcyBpc0NhbmNlbGVkRXJyb3IsXG4gIE5lIGFzIGlzSWZyYW1lLFxuICBfdCBhcyBpc1RNQSxcbiAgbnQgYXMgaXNUaW1lb3V0RXJyb3IsXG4gIGx0IGFzIG1vY2tUZWxlZ3JhbUVudixcbiAgd3QgYXMgb2ZmLFxuICBGZSBhcyBvbixcbiAgcGUgYXMgcG9zdEV2ZW50LFxuICBndCBhcyByZW1vdmVFdmVudEhhbmRsZXJzLFxuICBmZSBhcyByZXF1ZXN0LFxuICB5dCBhcyByZXNldFBhY2thZ2VTdGF0ZSxcbiAgWWUgYXMgcmV0cmlldmVMYXVuY2hQYXJhbXMsXG4gIHB0IGFzIHNldENzc1ZhcixcbiAgV2UgYXMgc2V0U3RvcmFnZVZhbHVlLFxuICBhdCBhcyBzbGVlcCxcbiAgdXQgYXMgc25ha2VUb0NhbWVsLFxuICBodCBhcyBzdWJzY3JpYmUsXG4gIEggYXMgc3VwcG9ydHMsXG4gIG10IGFzIHVuc3Vic2NyaWJlXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/dapp-sdk/node_modules/@telegram-apps/bridge/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@identity-connect/wallet-api/dist/index.mjs":
/*!******************************************************************!*\
  !*** ./node_modules/@identity-connect/wallet-api/dist/index.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bcsDeserialize: () => (/* binding */ bcsDeserialize),\n/* harmony export */   bcsSerialize: () => (/* binding */ bcsSerialize),\n/* harmony export */   deserializeJsonTransactionPayload: () => (/* binding */ deserializeJsonTransactionPayload),\n/* harmony export */   deserializeRawTransaction: () => (/* binding */ deserializeRawTransaction),\n/* harmony export */   deserializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ deserializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionRequestArgs: () => (/* binding */ deserializeSignTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionResponseArgs: () => (/* binding */ deserializeSignTransactionResponseArgs),\n/* harmony export */   isBcsSerializable: () => (/* binding */ isBcsSerializable),\n/* harmony export */   makeFullMessage: () => (/* binding */ makeFullMessage),\n/* harmony export */   serializeJsonTransactionPayload: () => (/* binding */ serializeJsonTransactionPayload),\n/* harmony export */   serializeRawTransaction: () => (/* binding */ serializeRawTransaction),\n/* harmony export */   serializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ serializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionRequestArgs: () => (/* binding */ serializeSignTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionResponseArgs: () => (/* binding */ serializeSignTransactionResponseArgs)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var aptos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aptos */ \"(ssr)/./node_modules/aptos/dist/index.mjs\");\n// src/serialization/bcsSerialization.ts\n\n\nfunction isBcsSerializableV1(value) {\n  return value?.serialize !== void 0;\n}\nfunction isBcsSerializableV2(value) {\n  return value?.serialize !== void 0 && value?.bcsToBytes !== void 0 && value?.bcsToHex !== void 0;\n}\nfunction isBcsSerializable(value) {\n  return isBcsSerializableV1(value) || isBcsSerializableV2(value);\n}\nfunction bcsSerialize(serializable) {\n  if (isBcsSerializableV2(serializable)) {\n    return serializable.bcsToHex().toString();\n  }\n  const serializedValueBytes = aptos__WEBPACK_IMPORTED_MODULE_1__.BCS.bcsToBytes(serializable);\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(serializedValueBytes).toString();\n}\nfunction bcsDeserialize(deserializableClass, serializedValue) {\n  const serializedValueBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexString(serializedValue).toUint8Array();\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedValueBytes);\n  return deserializableClass.deserialize(deserializer);\n}\n\n// src/serialization/jsonPayload.ts\n\n\n// src/serialization/error.ts\nvar UnexpectedValueError = class _UnexpectedValueError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = \"UnexpectedValueError\";\n    Object.setPrototypeOf(this, _UnexpectedValueError.prototype);\n  }\n};\n\n// src/serialization/jsonPayload.ts\nfunction isSerializedUint8Array(arg) {\n  return arg?.type === \"Uint8Array\" && typeof arg?.value === \"string\";\n}\nfunction serializeEntryFunctionArg(arg) {\n  if (arg instanceof Uint8Array) {\n    return {\n      type: \"Uint8Array\",\n      value: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg).toString()\n    };\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(serializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction deserializeEntryFunctionArg(arg) {\n  if (isSerializedUint8Array(arg)) {\n    return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg.value).toUint8Array();\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(deserializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction serializeEntryFunctionPayload(payload) {\n  const normalizedArgs = payload.arguments.map(serializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: normalizedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction deserializeEntryFunctionPayload(payload) {\n  const deserializedArgs = payload.arguments.map(deserializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: deserializedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction serializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return serializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? serializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return deserializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? deserializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/rawTxn.ts\n\nfunction serializeRawTransaction(rawTxn) {\n  const value = bcsSerialize(rawTxn);\n  if (\"fee_payer_address\" in rawTxn) {\n    return { type: \"fee_payer_raw_txn\", value };\n  }\n  if (\"secondary_signer_addresses\" in rawTxn) {\n    return { type: \"multi_agent_raw_txn\", value };\n  }\n  if (\"chain_id\" in rawTxn) {\n    return { type: \"raw_txn\", value };\n  }\n  throw new UnexpectedValueError(\"Invalid raw transaction type\");\n}\nfunction deserializeRawTransaction(serialized) {\n  switch (serialized.type) {\n    case \"raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, serialized.value);\n    case \"fee_payer_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    case \"multi_agent_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    default:\n      throw new UnexpectedValueError(\"Invalid raw transaction type\");\n  }\n}\n\n// src/serialization/signAndSubmitTransactionRequestArgs.ts\n\nfunction serializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    return {\n      feePayerAuthenticator: bcsSerialize(args.feePayerAuthenticator),\n      rawTxn: serializeRawTransaction(args.rawTxn)\n    };\n  }\n  if (\"rawTxn\" in args) {\n    return { rawTxn: serializeRawTransaction(args.rawTxn) };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    const feePayerAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.feePayerAuthenticator);\n    return { feePayerAuthenticator, rawTxn: deserializedRawTxn };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionRequestArgs.ts\n\nfunction serializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"rawTxn\" in args) {\n    const serializedRawTxn = serializeRawTransaction(args.rawTxn);\n    return { rawTxn: serializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionResponseArgs.ts\n\nfunction serializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsSerialize(args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsSerialize(args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\nfunction deserializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\n\n// src/utils/makeFullMessage.ts\nvar prefix = \"APTOS\";\nfunction makeFullMessage(params, flags) {\n  let fullMessage = prefix;\n  if (flags.address) {\n    fullMessage += `\naddress: ${params.address}`;\n  }\n  if (flags.application) {\n    fullMessage += `\napplication: ${params.application}`;\n  }\n  if (flags.chainId) {\n    fullMessage += `\nchainId: ${params.chainId}`;\n  }\n  fullMessage += `\nmessage: ${params.message}`;\n  fullMessage += `\nnonce: ${params.nonce}`;\n  return {\n    fullMessage,\n    prefix\n  };\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3Qvd2FsbGV0LWFwaS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDdUQ7QUFDM0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0NBQUc7QUFDbEMsU0FBUyxtREFBRztBQUNaO0FBQ0E7QUFDQSwrQkFBK0IsbURBQUc7QUFDbEMsMkJBQTJCLDREQUFZO0FBQ3ZDO0FBQ0E7O0FBRUE7QUFDaUQ7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsbURBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxtREFBSTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFJNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQWM7QUFDMUM7QUFDQSw0QkFBNEIsc0VBQXNCO0FBQ2xEO0FBQ0EsNEJBQTRCLHNFQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUM4RTtBQUM5RTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLGtFQUFrQjtBQUN4RixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaURBQWlELG9FQUFvQjtBQUNyRSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUMrRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0Usa0VBQW1CO0FBQ3pGLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ3NIO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSw4Q0FBOEMsb0VBQXFCO0FBQ25FO0FBQ0Esa0NBQWtDLDhEQUFlO0FBQ2pELGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGVBQWU7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxtQkFBbUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsV0FBVyxlQUFlO0FBQzFCO0FBQ0E7QUFDQSxXQUFXLGVBQWU7QUFDMUI7QUFDQSxTQUFTLGFBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdCRTtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNocmF2XFxhaS5hcHQtbWV0YW1vdmUtaGFja2F0aG9uXFxmcm9udGVkXFxub2RlX21vZHVsZXNcXEBpZGVudGl0eS1jb25uZWN0XFx3YWxsZXQtYXBpXFxkaXN0XFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3NlcmlhbGl6YXRpb24vYmNzU2VyaWFsaXphdGlvbi50c1xuaW1wb3J0IHsgRGVzZXJpYWxpemVyLCBIZXggfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBCQ1MgfSBmcm9tIFwiYXB0b3NcIjtcbmZ1bmN0aW9uIGlzQmNzU2VyaWFsaXphYmxlVjEodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlPy5zZXJpYWxpemUgIT09IHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGlzQmNzU2VyaWFsaXphYmxlVjIodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlPy5zZXJpYWxpemUgIT09IHZvaWQgMCAmJiB2YWx1ZT8uYmNzVG9CeXRlcyAhPT0gdm9pZCAwICYmIHZhbHVlPy5iY3NUb0hleCAhPT0gdm9pZCAwO1xufVxuZnVuY3Rpb24gaXNCY3NTZXJpYWxpemFibGUodmFsdWUpIHtcbiAgcmV0dXJuIGlzQmNzU2VyaWFsaXphYmxlVjEodmFsdWUpIHx8IGlzQmNzU2VyaWFsaXphYmxlVjIodmFsdWUpO1xufVxuZnVuY3Rpb24gYmNzU2VyaWFsaXplKHNlcmlhbGl6YWJsZSkge1xuICBpZiAoaXNCY3NTZXJpYWxpemFibGVWMihzZXJpYWxpemFibGUpKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6YWJsZS5iY3NUb0hleCgpLnRvU3RyaW5nKCk7XG4gIH1cbiAgY29uc3Qgc2VyaWFsaXplZFZhbHVlQnl0ZXMgPSBCQ1MuYmNzVG9CeXRlcyhzZXJpYWxpemFibGUpO1xuICByZXR1cm4gSGV4LmZyb21IZXhJbnB1dChzZXJpYWxpemVkVmFsdWVCeXRlcykudG9TdHJpbmcoKTtcbn1cbmZ1bmN0aW9uIGJjc0Rlc2VyaWFsaXplKGRlc2VyaWFsaXphYmxlQ2xhc3MsIHNlcmlhbGl6ZWRWYWx1ZSkge1xuICBjb25zdCBzZXJpYWxpemVkVmFsdWVCeXRlcyA9IEhleC5mcm9tSGV4U3RyaW5nKHNlcmlhbGl6ZWRWYWx1ZSkudG9VaW50OEFycmF5KCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFZhbHVlQnl0ZXMpO1xuICByZXR1cm4gZGVzZXJpYWxpemFibGVDbGFzcy5kZXNlcmlhbGl6ZShkZXNlcmlhbGl6ZXIpO1xufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9qc29uUGF5bG9hZC50c1xuaW1wb3J0IHsgSGV4IGFzIEhleDIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL2Vycm9yLnRzXG52YXIgVW5leHBlY3RlZFZhbHVlRXJyb3IgPSBjbGFzcyBfVW5leHBlY3RlZFZhbHVlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVuZXhwZWN0ZWRWYWx1ZUVycm9yXCI7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIF9VbmV4cGVjdGVkVmFsdWVFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9qc29uUGF5bG9hZC50c1xuZnVuY3Rpb24gaXNTZXJpYWxpemVkVWludDhBcnJheShhcmcpIHtcbiAgcmV0dXJuIGFyZz8udHlwZSA9PT0gXCJVaW50OEFycmF5XCIgJiYgdHlwZW9mIGFyZz8udmFsdWUgPT09IFwic3RyaW5nXCI7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKGFyZykge1xuICBpZiAoYXJnIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcIlVpbnQ4QXJyYXlcIixcbiAgICAgIHZhbHVlOiBIZXgyLmZyb21IZXhJbnB1dChhcmcpLnRvU3RyaW5nKClcbiAgICB9O1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGFyZykpIHtcbiAgICByZXR1cm4gYXJnLm1hcChzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKTtcbiAgfVxuICByZXR1cm4gYXJnO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKGFyZykge1xuICBpZiAoaXNTZXJpYWxpemVkVWludDhBcnJheShhcmcpKSB7XG4gICAgcmV0dXJuIEhleDIuZnJvbUhleElucHV0KGFyZy52YWx1ZSkudG9VaW50OEFycmF5KCk7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSkge1xuICAgIHJldHVybiBhcmcubWFwKGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZyk7XG4gIH1cbiAgcmV0dXJuIGFyZztcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgY29uc3Qgbm9ybWFsaXplZEFyZ3MgPSBwYXlsb2FkLmFyZ3VtZW50cy5tYXAoc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZyk7XG4gIHJldHVybiB7XG4gICAgLi4ucGF5bG9hZCxcbiAgICBhcmd1bWVudHM6IG5vcm1hbGl6ZWRBcmdzLFxuICAgIHR5cGU6IFwiZW50cnlfZnVuY3Rpb25fcGF5bG9hZFwiXG4gIH07XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgY29uc3QgZGVzZXJpYWxpemVkQXJncyA9IHBheWxvYWQuYXJndW1lbnRzLm1hcChkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25BcmcpO1xuICByZXR1cm4ge1xuICAgIC4uLnBheWxvYWQsXG4gICAgYXJndW1lbnRzOiBkZXNlcmlhbGl6ZWRBcmdzLFxuICAgIHR5cGU6IFwiZW50cnlfZnVuY3Rpb25fcGF5bG9hZFwiXG4gIH07XG59XG5mdW5jdGlvbiBzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgaWYgKHBheWxvYWQudHlwZSA9PT0gXCJlbnRyeV9mdW5jdGlvbl9wYXlsb2FkXCIgfHwgcGF5bG9hZC50eXBlID09PSB2b2lkIDApIHtcbiAgICByZXR1cm4gc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZCk7XG4gIH1cbiAgaWYgKHBheWxvYWQudHlwZSA9PT0gXCJtdWx0aXNpZ19wYXlsb2FkXCIpIHtcbiAgICBjb25zdCBpbm5lclBheWxvYWQgPSBwYXlsb2FkLnRyYW5zYWN0aW9uX3BheWxvYWQgIT09IHZvaWQgMCA/IHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQudHJhbnNhY3Rpb25fcGF5bG9hZCkgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHsgLi4ucGF5bG9hZCwgdHJhbnNhY3Rpb25fcGF5bG9hZDogaW5uZXJQYXlsb2FkIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQocGF5bG9hZCkge1xuICBpZiAocGF5bG9hZC50eXBlID09PSBcImVudHJ5X2Z1bmN0aW9uX3BheWxvYWRcIiB8fCBwYXlsb2FkLnR5cGUgPT09IHZvaWQgMCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpO1xuICB9XG4gIGlmIChwYXlsb2FkLnR5cGUgPT09IFwibXVsdGlzaWdfcGF5bG9hZFwiKSB7XG4gICAgY29uc3QgaW5uZXJQYXlsb2FkID0gcGF5bG9hZC50cmFuc2FjdGlvbl9wYXlsb2FkICE9PSB2b2lkIDAgPyBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQudHJhbnNhY3Rpb25fcGF5bG9hZCkgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHsgLi4ucGF5bG9hZCwgdHJhbnNhY3Rpb25fcGF5bG9hZDogaW5uZXJQYXlsb2FkIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL3Jhd1R4bi50c1xuaW1wb3J0IHtcbiAgUmF3VHJhbnNhY3Rpb24sXG4gIFJhd1RyYW5zYWN0aW9uV2l0aERhdGFcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24ocmF3VHhuKSB7XG4gIGNvbnN0IHZhbHVlID0gYmNzU2VyaWFsaXplKHJhd1R4bik7XG4gIGlmIChcImZlZV9wYXllcl9hZGRyZXNzXCIgaW4gcmF3VHhuKSB7XG4gICAgcmV0dXJuIHsgdHlwZTogXCJmZWVfcGF5ZXJfcmF3X3R4blwiLCB2YWx1ZSB9O1xuICB9XG4gIGlmIChcInNlY29uZGFyeV9zaWduZXJfYWRkcmVzc2VzXCIgaW4gcmF3VHhuKSB7XG4gICAgcmV0dXJuIHsgdHlwZTogXCJtdWx0aV9hZ2VudF9yYXdfdHhuXCIsIHZhbHVlIH07XG4gIH1cbiAgaWYgKFwiY2hhaW5faWRcIiBpbiByYXdUeG4pIHtcbiAgICByZXR1cm4geyB0eXBlOiBcInJhd190eG5cIiwgdmFsdWUgfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoXCJJbnZhbGlkIHJhdyB0cmFuc2FjdGlvbiB0eXBlXCIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihzZXJpYWxpemVkKSB7XG4gIHN3aXRjaCAoc2VyaWFsaXplZC50eXBlKSB7XG4gICAgY2FzZSBcInJhd190eG5cIjpcbiAgICAgIHJldHVybiBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbiwgc2VyaWFsaXplZC52YWx1ZSk7XG4gICAgY2FzZSBcImZlZV9wYXllcl9yYXdfdHhuXCI6XG4gICAgICByZXR1cm4gYmNzRGVzZXJpYWxpemUoUmF3VHJhbnNhY3Rpb25XaXRoRGF0YSwgc2VyaWFsaXplZC52YWx1ZSk7XG4gICAgY2FzZSBcIm11bHRpX2FnZW50X3Jhd190eG5cIjpcbiAgICAgIHJldHVybiBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbldpdGhEYXRhLCBzZXJpYWxpemVkLnZhbHVlKTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKFwiSW52YWxpZCByYXcgdHJhbnNhY3Rpb24gdHlwZVwiKTtcbiAgfVxufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9zaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncy50c1xuaW1wb3J0IHsgQWNjb3VudEF1dGhlbnRpY2F0b3IsIFRyYW5zYWN0aW9uUGF5bG9hZCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpIHtcbiAgaWYgKFwicGF5bG9hZFwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUGF5bG9hZCA9IGlzQmNzU2VyaWFsaXphYmxlKGFyZ3MucGF5bG9hZCkgPyBiY3NTZXJpYWxpemUoYXJncy5wYXlsb2FkKSA6IHNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQoYXJncy5wYXlsb2FkKTtcbiAgICByZXR1cm4geyBvcHRpb25zOiBhcmdzLm9wdGlvbnMsIHBheWxvYWQ6IHNlcmlhbGl6ZWRQYXlsb2FkIH07XG4gIH1cbiAgaWYgKFwiZmVlUGF5ZXJBdXRoZW50aWNhdG9yXCIgaW4gYXJncykge1xuICAgIHJldHVybiB7XG4gICAgICBmZWVQYXllckF1dGhlbnRpY2F0b3I6IGJjc1NlcmlhbGl6ZShhcmdzLmZlZVBheWVyQXV0aGVudGljYXRvciksXG4gICAgICByYXdUeG46IHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKVxuICAgIH07XG4gIH1cbiAgaWYgKFwicmF3VHhuXCIgaW4gYXJncykge1xuICAgIHJldHVybiB7IHJhd1R4bjogc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpIHtcbiAgaWYgKFwicGF5bG9hZFwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBwYXlsb2FkID0gdHlwZW9mIGFyZ3MucGF5bG9hZCA9PT0gXCJzdHJpbmdcIiA/IGJjc0Rlc2VyaWFsaXplKFRyYW5zYWN0aW9uUGF5bG9hZCwgYXJncy5wYXlsb2FkKSA6IGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZCB9O1xuICB9XG4gIGlmIChcImZlZVBheWVyQXV0aGVudGljYXRvclwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBkZXNlcmlhbGl6ZWRSYXdUeG4gPSBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICBjb25zdCBmZWVQYXllckF1dGhlbnRpY2F0b3IgPSBiY3NEZXNlcmlhbGl6ZShBY2NvdW50QXV0aGVudGljYXRvciwgYXJncy5mZWVQYXllckF1dGhlbnRpY2F0b3IpO1xuICAgIHJldHVybiB7IGZlZVBheWVyQXV0aGVudGljYXRvciwgcmF3VHhuOiBkZXNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICBpZiAoXCJyYXdUeG5cIiBpbiBhcmdzKSB7XG4gICAgY29uc3QgZGVzZXJpYWxpemVkUmF3VHhuID0gZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihhcmdzLnJhd1R4bik7XG4gICAgcmV0dXJuIHsgcmF3VHhuOiBkZXNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cblxuLy8gc3JjL3NlcmlhbGl6YXRpb24vc2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MudHNcbmltcG9ydCB7IFRyYW5zYWN0aW9uUGF5bG9hZCBhcyBUcmFuc2FjdGlvblBheWxvYWQyIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRQYXlsb2FkID0gaXNCY3NTZXJpYWxpemFibGUoYXJncy5wYXlsb2FkKSA/IGJjc1NlcmlhbGl6ZShhcmdzLnBheWxvYWQpIDogc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZDogc2VyaWFsaXplZFBheWxvYWQgfTtcbiAgfVxuICBpZiAoXCJyYXdUeG5cIiBpbiBhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJhd1R4biA9IHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyByYXdUeG46IHNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHBheWxvYWQgPSB0eXBlb2YgYXJncy5wYXlsb2FkID09PSBcInN0cmluZ1wiID8gYmNzRGVzZXJpYWxpemUoVHJhbnNhY3Rpb25QYXlsb2FkMiwgYXJncy5wYXlsb2FkKSA6IGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZCB9O1xuICB9XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBkZXNlcmlhbGl6ZWRSYXdUeG4gPSBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyByYXdUeG46IGRlc2VyaWFsaXplZFJhd1R4biB9O1xuICB9XG4gIHRocm93IG5ldyBVbmV4cGVjdGVkVmFsdWVFcnJvcigpO1xufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9zaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MudHNcbmltcG9ydCB7IEFjY291bnRBdXRoZW50aWNhdG9yIGFzIEFjY291bnRBdXRoZW50aWNhdG9yMiwgUmF3VHJhbnNhY3Rpb24gYXMgUmF3VHJhbnNhY3Rpb24yIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVzcG9uc2VBcmdzKGFyZ3MpIHtcbiAgY29uc3QgYWNjb3VudEF1dGhlbnRpY2F0b3IgPSBiY3NTZXJpYWxpemUoYXJncy5hY2NvdW50QXV0aGVudGljYXRvcik7XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCByYXdUeG4gPSBiY3NTZXJpYWxpemUoYXJncy5yYXdUeG4pO1xuICAgIHJldHVybiB7IGFjY291bnRBdXRoZW50aWNhdG9yLCByYXdUeG4gfTtcbiAgfVxuICByZXR1cm4geyBhY2NvdW50QXV0aGVudGljYXRvciB9O1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MoYXJncykge1xuICBjb25zdCBhY2NvdW50QXV0aGVudGljYXRvciA9IGJjc0Rlc2VyaWFsaXplKEFjY291bnRBdXRoZW50aWNhdG9yMiwgYXJncy5hY2NvdW50QXV0aGVudGljYXRvcik7XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCByYXdUeG4gPSBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbjIsIGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyBhY2NvdW50QXV0aGVudGljYXRvciwgcmF3VHhuIH07XG4gIH1cbiAgcmV0dXJuIHsgYWNjb3VudEF1dGhlbnRpY2F0b3IgfTtcbn1cblxuLy8gc3JjL3V0aWxzL21ha2VGdWxsTWVzc2FnZS50c1xudmFyIHByZWZpeCA9IFwiQVBUT1NcIjtcbmZ1bmN0aW9uIG1ha2VGdWxsTWVzc2FnZShwYXJhbXMsIGZsYWdzKSB7XG4gIGxldCBmdWxsTWVzc2FnZSA9IHByZWZpeDtcbiAgaWYgKGZsYWdzLmFkZHJlc3MpIHtcbiAgICBmdWxsTWVzc2FnZSArPSBgXG5hZGRyZXNzOiAke3BhcmFtcy5hZGRyZXNzfWA7XG4gIH1cbiAgaWYgKGZsYWdzLmFwcGxpY2F0aW9uKSB7XG4gICAgZnVsbE1lc3NhZ2UgKz0gYFxuYXBwbGljYXRpb246ICR7cGFyYW1zLmFwcGxpY2F0aW9ufWA7XG4gIH1cbiAgaWYgKGZsYWdzLmNoYWluSWQpIHtcbiAgICBmdWxsTWVzc2FnZSArPSBgXG5jaGFpbklkOiAke3BhcmFtcy5jaGFpbklkfWA7XG4gIH1cbiAgZnVsbE1lc3NhZ2UgKz0gYFxubWVzc2FnZTogJHtwYXJhbXMubWVzc2FnZX1gO1xuICBmdWxsTWVzc2FnZSArPSBgXG5ub25jZTogJHtwYXJhbXMubm9uY2V9YDtcbiAgcmV0dXJuIHtcbiAgICBmdWxsTWVzc2FnZSxcbiAgICBwcmVmaXhcbiAgfTtcbn1cbmV4cG9ydCB7XG4gIGJjc0Rlc2VyaWFsaXplLFxuICBiY3NTZXJpYWxpemUsXG4gIGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZCxcbiAgZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbixcbiAgZGVzZXJpYWxpemVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MsXG4gIGlzQmNzU2VyaWFsaXphYmxlLFxuICBtYWtlRnVsbE1lc3NhZ2UsXG4gIHNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQsXG4gIHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uLFxuICBzZXJpYWxpemVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MsXG4gIHNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlc3BvbnNlQXJnc1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@identity-connect/wallet-api/dist/index.mjs\n");

/***/ })

};
;